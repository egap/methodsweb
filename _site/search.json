[
  {
    "objectID": "guides/getting-started/adaptive_en.html",
    "href": "guides/getting-started/adaptive_en.html",
    "title": "10 Things to Know About Adaptive Experimental Design",
    "section": "",
    "text": "1. What is an “adaptive”1 design?\nA static design applies the same procedures for allocating treatments and measuring outcomes throughout the trial. In contrast, an adaptive design may, based on interim analysis of the trial’s result, change the allocation of subjects to treatment arms or may change the allocation of resources to different outcome measures.\nOrdinarily, mid-course changes in experimental design are viewed with skepticism since they open the door to researcher interference in ways that could favor certain results. In recent years, however, statisticians have developed methods to automate adaptation in ways that either lessen the risk of interference or facilitate bias correction at the analysis stage.\n\n\n2. What are the potential advantages of an adaptive design?\nAdaptive designs have the potential to detect the best-performing experimental arm(s) more quickly than a static design (i.e., with fewer data-collection sessions and fewer subjects). When these efficiencies are realized, resources may be reallocated to achieve other research objectives.\nAdaptive designs also have the potential to lessen the ethical concerns that arise when subjects are allocated to inferior treatment arms. For therapeutic interventions, adaptive designs may reduce subjects’ exposure to inferior treatments; for interventions designed to further broad societal objectives, adaptive designs may hasten the discovery of superior interventions.\nTo illustrate the potential advantages of adaptive design, we simulate an RCT involving a control group and eight treatment arms. We administer treatments and gather 100 outcomes during each “period.” The simulation assumes that each subject’s outcome is binary (e.g., good versus bad). The adaptive allocation of subjects is based on interim analyses conducted at the end of each period. We allocate next period’s subjects according to posterior probabilities that a given treatment arm is best (see below). The simulation assumes that the probability of success is 0.10 for all arms except one, which is 0.20. The stopping rule is that the RCT is halted when one arm is found to have a 95% posterior probability of being best.\nIn the adaptive trial depicted below, the best arm (the red line) is correctly identified, and the trial is halted after 23 periods (total N=2300).\n\n\n\n3. What are the potential disadvantages of adaptive designs?\nThere is no guarantee that adaptive design will be superior in terms of speed or accuracy. For example, adaptive designs may result in a lengthy trial in cases where all of the arms are approximately equally effective. Even when one arm is truly superior, adaptive searches have some probability of resulting in long, circuitous searches (and considerable expense) if by chance they get off to a bad start (i.e., one of the inferior arms appears to be better than the other based on an initial round of results).\nFor instance, consider the following scenario in which all but one of the arms have a 0.10 probability of success, and the superior arm has a 0.12 probability of success (with the same trial design as in the previous example). The design eventually settles on the truly superior arm but only after more than 200 periods (N = 23,810). Even after 50 periods, the results provide no clear sense that any of the arms is superior.\n\nA further disadvantage of adaptive designs is they may produce biased estimates of the average treatment effect of the apparent best arm vis-à-vis the control group. Bias arises because the trial stops when the best arm crosses a threshold suggesting optimality; this stopping rule tends to favor lucky draws that suggest the efficacy of the winning arm. Conversely, when adaptive algorithms associate sampling probability with observed history, under-estimation for inferior arms, including the control group, may persist until stopping time (Nie et al., 2017).\nFor example, in the first scenario described above in which all arms have a 0.10 probability of success except for the best arm, which is 0.20, the average estimated success probability for the truly best arm is 0.202 across 1000 simulated experiments, while the control group average is found to 0.083. The average estimated difference in success probabilities (i.e., the average treatment effect) is 0.119, as compared to the true value of 0.10.\nIn the second scenario, in which the best arm’s success probability is just 0.12, the average estimated success probability for the best arm is 0.121, and the average estimated ATE is 0.027, as compared to the true ATE of 0.02. Bias in this case is relatively small on a percentage point scale due to the very large size of the average experiment.\n\n\n4. What kinds of experiments lend themselves to adaptive design?\nAdaptive designs require multiple periods of treatment and outcome assessment.\nAdaptive designs are well suited to survey, on-line, and lab experiments, where participants are treated and outcomes measured in batches over time.\nSome field experiments are conducted in stages, although the logistics of changing treatment arms may be cumbersome, as discussed below. One possible opportunity for adaptive design in a field context occurs when a given experiment is to be deployed over time in a series of different regions. This allows for adaptation based on region-by-region interim analyses.\nAdaptive designs are ill-suited to one-shot interventions with outcomes measured at a single point in time. For example, experiments designed to increase voter turnout in a given election do not lend themselves to adaptive design because everyone’s outcome is measured at the same time, leaving no opportunity for adaptation.\n\n\n5. What is the connection between adaptive designs and “multi-arm bandit problems”?\nThe multi-arm bandit problem (Scott 2010) is a metaphor for the following optimization problem. Imagine that you could drop a coin in one of several slot machines that may pay off at different rates. (Slot machines are sometimes nicknamed “one-arm bandits,” hence the name.) You would like to make as much money as possible. The optimization problem may be characterized as a trade off between learning about the relative merits of the various slot machines – exploration – and reaping the benefits of employing the best arm – exploitation. A static design may be viewed as an extreme case of allocating subjects solely for exploration.\nAs applied to RCTs, the aim is to explore the merits of the various treatment arms while at the same time reaping the benefits of the best arm or arms. Although the MAB problem is not specifically about estimating treatment effects, one could adjust the optimization objective so that the aim is to find the treatment arm with the greatest apparent superiority over the control group.\n\n\n6. What are some widely used algorithms for automating “adaptation”?\nThe most commonly used methods employ some form of “Thompson sampling” (Thompson 1933). Interim results are assessed periodically, and in the next period subjects are assigned to treatment arms in proportion to the posterior probability that a given arm is best. The more likely an arm is to be “best,” the more subjects it receives.\nMany variations on this basic assignment routine have been proposed, and some are designed to make it less prone to bias. If an adaptive trial is rolled out during a period in which success rates tend to be growing, increasing allocation of subjects to the best arm will tend to exaggerate that arm’s efficacy relative to the other arms, which receive fewer subjects during the high-yield period. In order to assess bias and correct for it, it may be useful to allocate some subjects in every period according to a static design. In this case, inverse probability weights for each period may be used to obtain unbiased estimates of the average treatment effect. (See Gerber and Green 2012 on the use of inverse probability weights for estimation of average treatment effects when the probability of assignment varies from block to block.)\n\n\n7. What are the symptoms of futile search?\nAlthough it is impossible to know for sure whether a drawn out search reflects an unlucky start or an underlying reality in which no arm is superior, the longer an adaptive trial goes, the more cause for concern. The following graphs summarize the distribution of stopping times for three scenarios. Stopping was dictated by at 10% value remaining criterion. Specifically, the trial stopped when the top of the 95% confidence interval showed that no other arm was likely to offer at least a 10 percent (not percentage point) gain in success rate. The first two scenarios were described above; the third scenario considers a case in which there are two superior arms. The graph illustrates how adaptive trials tend to conclude faster when the superiority of the best arm(s) is more clear-cut.\n\n\n\n8. What implications do adaptive designs have for pre-analysis plans?\nThe use of adaptive designs introduces additional decisions, which ideally should be addressed ex ante so as to limit researcher bias. For example, the researcher should specify which algorithms will be used for allocation. It is especially important to specify the stopping rule. Depending on the researcher’s objectives, this rule may focus on achieving a desired posterior probability, or it may use a “value remaining” criterion that considers whether one or more arms have shown themselves to be good enough vis-à-vis the alternative arms. Other hybrid stopping criteria may also be specified. The pre-analysis plan should also describe the analytic steps that will be taken to correct for bias.\n\n\n9. Are multi-arm bandit trials frequently used in social science?\nMany of the applications to date have taken place in commercial settings, such as website design for high-volume e-commerce, or in settings such as on-line fundraising. Relatively few applications have been written up in detail for a scholarly audience. Surprisingly rare are applications in biomedical research. As Villar et al. (2015, p.200) note, “Despite this apparent near-perfect fit between a real-world problem and a mathematical theory, the MABP has yet to be applied to an actual clinical trial.”\nPutting aside the use of multi-arm bandit approaches, the use of adaptive trials is gradually winning acceptance in biomedical research. For details, see Chin (2016).\n\n\n10. What other considerations should inform the decision to use adaptive design?\nAs noted above, adaptive designs add to the complexity of the research design and analysis. They also may increase the challenges of implementation, particularly in field settings where the logistical or training costs associated with different arms vary markedly. Even when one arm is clearly superior (inferior), the lead-time necessary to staff or outfit this arm may make it difficult to scale it up (down). Adaptive designs are only practical if adaptation is feasible.\nOn the other hand, funders and implementation partners may welcome the idea of an experimental design that responds to on-the-ground conditions such that problematic arms are scaled back. A middle ground between static designs and designs that envision adaptation over many periods are adaptive designs involving only two or three interim analyses and adjustments. Such trials are winning increased acceptance in biomedical research (Chow and Chang 2008) and are likely to become more widely used in the social sciences too. The growing interest in replication and design-based extensions of existing experiments to aid generalization are likely to create opportunities for adaptive design.\n\n\nReferences\nChin, Richard. 2016. Adaptive and flexible clinical trials. New York: CRC Press.\nChow, Shein-Chung, and Mark Chang. 2008. “Adaptive design methods in clinical trials – a review.” Orphanet Journal of Rare Diseases 3:11.  Link to article \nNie, Xinkun, Xiaoying Tian, Jonathan Taylor, and James Zou. 2017. “Why Adaptively Collected Data Have Negative Bias and How to Correct for It.” arXiv:1708.01977\nScott, Steven L. 2010. “A modern Bayesian look at the multi-armed bandit.” Applied Stochastic Models in Business and Industry 26:639–658.\nThompson, William R. 1933. On the likelihood that one unknown probability exceeds another in view of the evidence of two samples. Biometrika 25:285–294.\nVillar, Sofía S., Jack Bowden, and James Wason. “Multi-Armed Bandit Models for the Optimal Design of Clinical Trials: Benefits and Challenges.” Statistical science: a review journal of the Institute of Mathematical Statistics 30.2 (2015): 199–215.\n\n\n\n\n\n\nFootnotes\n\n\nThis guide originally authored by Donald Green (Columbia University) and Molly Offer-Westort (Yale University) and published on February 23, 2018.↩︎"
  },
  {
    "objectID": "guides.html",
    "href": "guides.html",
    "title": "Methods guides",
    "section": "",
    "text": "Jake Bowers & Rebecca Wolfe\n\n\n\n\n\n\n\n\n\n\n \n\n\n\n\n\n\n\n\nMacartan Humphreys\n\n\n\n\n\n\n\n\n\n\n \n\n\n\n\n\n\n\n\nRenard Sexton\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nAlexander Coppock\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nAlexander Coppock\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nPeter van der Windt\n\n\n\n\n\n\n\n\n\n\n \n\n\n\n\n\n\n\n\nRekha Balu\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nDonald Green & Molly Offer-Westort\n\n\n\n\n\n\n\n\n\n\n \n\n\n\n\n\n\n\n\nDonald Green\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nLindsay Dolan\n\n\n\n\n\n\n\n\n\n\n \n\n\n\n\n\n\n\n\nAlbert Fang\n\n\n\n\n\n\n\n\n\n\n \n\n\n\n\n\n\n\n\nTara Slough\n\n\n\n\n\n\n\n\n\n\n \n\n\n\n\n\n\n\n\nLindsay Dolan\n\n\n\n\n\n\n\n\n\n\n \n\n\n\n\n\n\n\n\nTara Slough\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nKaylyn Jackson Schiff, Daniel S. Schiff, and Natália S. Bueno\n\n\n\n\n\n\n\n\n\n\n \n\n\n\n\n\n\n\n\nNuole (Lula) Chen and Christopher Grady\n\n\n\n\n\n\n\n\n\n\n \n\n\n\n\n\n\n\n\nGabriella Sacramone-Lutz\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nGabriella Sacramone-Lutz\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nPaul Testa\n\n\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "guides.html#planning-research-and-evaluations",
    "href": "guides.html#planning-research-and-evaluations",
    "title": "Methods guides",
    "section": "Planning research and evaluations",
    "text": "Planning research and evaluations\n\n\n\n\n\n\n\n\n\n\n10 Things You Need to Know About Statistical Power\n\n\n\n\n\n\nAlexander Coppock\n\n\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "guides/planning/power_en.html",
    "href": "guides/planning/power_en.html",
    "title": "10 Things You Need to Know About Statistical Power",
    "section": "",
    "text": "Abstract\nThis guide1 will help you assess and improve the power of your experiments. We focus on the big ideas and provide examples and tools that you can use in R and Google Spreadsheets.\n\n\n1 What Power Is\nPower is the ability to distinguish signal from noise.\nThe signal that we are interested in is the impact of a treatment on some outcome. Does education increase incomes? Do public health campaigns decrease the incidence of disease? Can international monitoring decrease government corruption?\nThe noise that we are concerned about comes from the complexity of the world. Outcomes vary across people and places for myriad reasons. In statistical terms, you can think of this variation as the standard deviation of the outcome variable. For example, suppose an experiment uses rates of a rare disease as an outcome. The total number of affected people isn’t likely to fluctuate wildly day to day, meaning that the background noise in this environment will be low. When noise is low, experiments can detect even small changes in average outcomes. A treatment that decreased the incidence of the disease by 1% percentage points would be easily detected, because the baseline rates are so constant.\nNow suppose an experiment instead used subjects’ income as an outcome variable. Incomes can vary pretty widely – in some places, it is not uncommon for people to have neighbors that earn two, ten, or one hundred times their daily wages. When noise is high, experiments have more trouble. A treatment that increased workers’ incomes by 1% would be difficult to detect, because incomes differ by so much in the first place.\nA major concern before embarking on an experiment is the danger of a false negative. Suppose the treatment really does have a causal impact on outcomes. It would be a shame to go to all the trouble and expense of randomizing the treatment, collecting data on both treatment and control groups, and analyzing the results, just to have the effect be overwhelmed by background noise.\nIf our experiments are highly-powered, we can be confident that if there truly is a treatment effect, we’ll be able to see it.\n\n\n2 Why You Need It\nExperimenters often guard against false positives with statistical significance tests. After an experiment has been run, we are concerned about falsely concluding that there is an effect when there really isn’t.\nPower analysis asks the opposite question: supposing there truly is a treatment effect and you were to run your experiment a huge number of times, how often will you get a statistically significant result?\nAnswering this question requires informed guesswork. You’ll have to supply guesses as to how big your treatment effect can reasonably be, how many subjects will answer your survey, how many subjects your organization can realistically afford to treat.\nWhere do these guesses come from? Before an experiment is run, there is often a wealth of baseline data that are available. How old/rich/educated are subjects like yours going to be? How big was the biggest treatment effect ever established for your dependent variable? With power analysis, you can see how sensitive the probability of getting significant results is to changes in your assumptions.\nMany disciplines have settled on a target power value of 0.80. Researchers will tweak their designs and assumptions until they can be confident that their experiments will return statistically significant results 80% of the time. While this convention is a useful benchmark, be sure that you are comfortable with the risks associated with an 80% expected success rate.\nA note of caution: power matters a lot. Negative results from underpowered studies can be hard to interpret: Is there really no effect? Or is the study just not able to figure it out? Positive results from an underpowered study can also be misleading: conditional upon being statistically significant, an estimate from an underpowered study probably overestimates treatment effects. Under powered studies are sometimes based on overly optimistic assumptions; a convincing power analysis makes these assumptions explicit and should protect you from implementing designs that realistically have no chance of answering the questions you want to answer.\n\n\n3 The Three Ingredients of Statistical Power\nThere are three big categories of things that determine how highly powered your experiment will be. The first two (the strength of the treatment and background noise) are things that you can’t really control – these are the realities of your experimental environment. The last, the experimental design, is the only thing that you have power over – use it!\n\nStrength of the treatment. As the strength of your treatment increases, the power of your experiment increases. This makes sense: if your treatment were giving every subject $1,000,000, there is little doubt that we could discern differences in behavior between the treatment and control groups. Many times, however, we are not in control of the strength of our treatments. For example, researchers involved in program evaluation don’t get to decide what the treatment should be, they are supposed to evaluate the program as it is.\nBackground noise. As the background noise of your outcome variables increases, the power of your experiment decreases. To the extent that it is possible, try to select outcome variables that have low variability. In practical terms, this means comparing the standard deviation of the outcome variable to the expected treatment effect size — there is no magic ratio that you should be shooting for, but the closer the two are, the better off your experiment will be. By and large, researchers are not in control of background noise, and picking lower-noise outcome variables is easier said than done. Furthermore, many outcomes we would like to study are inherently quite variable. From this perspective, background noise is something you just have to deal with as best you can.\nExperimental Design. Traditional power analysis focuses on one (albeit very important) element of experimental design: the number of subjects in each experimental group. Put simply, a larger number of subjects increases power. However, there are other elements of the experimental design that can increase power: how is the randomization conducted? Will other factors be statistically controlled for? How many treatment groups will there be, and can they be combined in some analyses?\n\n\n\n4 Key Formulas for Calculating Power\nStatisticians have derived formulas for calculating the power of many experimental designs. They can be useful as a back of the envelope calculation of how large a sample you’ll need. Be careful, though, because the assumptions behind the formulas can sometimes be obscure, and worse, they can be wrong.\nHere is a common formula used to calculate power2\n\\[\\beta = \\Phi \\left(\\frac{|\\mu_t-\\mu_c|\\sqrt{N}}{2\\sigma}-\\Phi^{-1} \\left(1-\\frac{\\alpha}{2}\\right) \\right)\\]\n\n\\(\\beta\\) is our measure of power. Because it’s the probability of getting a statistically significant result, β will be a number between 0 and 1.\n\\(\\Phi\\) is the CDF of the normal distribution, and \\(\\Phi^{-1}\\) is its inverse. Everything else in this formula, we have to plug in:\n\\(\\mu_t\\) is the average outcome in the treatment group. Suppose it’s 65.\n\\(\\mu_c\\) is the average outcome in the control group. Suppose it’s 60.\nTogether, assumptions about μt and μc define our assumption about the size of the treatment effect: 65-60= 5.\n\\(\\sigma\\) is the standard deviation of outcomes. This is how we make assumptions about how noisy our experiment will be — one of the assumptions we’re making is that sigma is the same for both the treatment and control groups. Suppose \\(\\sigma=20\\)\n\\(\\alpha\\) is our significance level – the convention in many disciplines is that α should be equal to 0.05. \\(N\\) is the total number of subjects. This is the only variable that is under the direct control of the researcher. This formula assumes that every subject had a 50/50 chance of being in control. Suppose that \\(N=500\\).\n\nWorking through the formula, we find that under this set of assumptions, \\(β = 0.80\\), meaning that we have an 80% chance of recovering a statistically significant result with this design. Click here for a google spreadsheet that includes this formula. You can copy these formulas directly into Excel. If you’re comfortable in R, here is code that will accomplish the same calculation.\n\npower_calculator <- function(mu_t, mu_c, sigma, alpha=0.05, N){ \n  lowertail <- (abs(mu_t - mu_c)*sqrt(N))/(2*sigma) \n  uppertail <- -1*lowertail \n  beta <- pnorm(lowertail- qnorm(1-alpha/2), lower.tail=TRUE) + 1- pnorm(uppertail- qnorm(1-alpha/2), lower.tail=FALSE) \n  return(beta) \n  } \n\n\n\n5 When to Believe Your Power Analysis\nFrom some perspectives the whole idea of power analysis makes no sense. You want to figure out the size of some treatment effect but first you need to do a power analysis which requires that you already know your treatment effect and a lot more besides.\nSo in most power analyses you are in fact seeing what happens with numbers that are to some extent made up. The good news is that it is easy to find out how much your conclusions depend on your assumptions: simply vary your assumptions and see how the conclusions on power vary.\nThis is most easily seen by thinking about how power varies with the number of subjects. A power analysis that looks at power for different study sizes simply plugs in a range of values in for N and seeing how β changes.\nUsing the formula in section 4, you can see how sensitive power is to all of the assumptions: Power will be higher if you assume the treatment effect will be larger, or if you’re willing to accept a higher alpha level, or if you have more or less confidence in the noisiness of your measures.3\n\n\n\n\n6 How to Use Simulation to Estimate Power\nPower is a measure of how often, given assumptions, we would obtain statistically significant results, if we were to conduct our experiment thousands of times. The power calculation formula takes assumptions and return an analytic solution. However, due to advances in modern computing, we don’t have to rely on analytic solutions for power analysis. We can tell our computers to literally run the experiment thousands of times and simply count how frequently our experiment comes up significant.\nThe code block below shows how to conduct this simulation in R.\n\npossible.ns <- seq(from=100, to=2000, by=40) # The sample sizes we'll be considering\nstopifnot(all( (possible.ns %% 2)==0 )) ## require even number of experimental pool\npowers <- rep(NA, length(possible.ns)) # Empty object to collect simulation estimates \nalpha <- 0.05 # Standard significance level \nsims <- 500 # Number of simulations to conduct for each N \n#### Outer loop to vary the number of subjects #### \nfor (j in 1:length(possible.ns)){ N <- possible.ns[j] # Pick the jth value for N \n  Y0 <- rnorm(n=N, mean=60, sd=20) # control potential outcome \n  tau <- 5 # Hypothesize treatment effect \n  Y1 <- Y0 + tau # treatment potential outcome                                   \n  significant.experiments <- rep(NA, sims) # Empty object to count significant experiments \n                                  \n  #### Inner loop to conduct experiments \"sims\" times over for each N #### \n        Y0 <- rnorm(n=N, mean=60, sd=20) # control potential outcome \n        tau <- 5 # Hypothesize treatment effect \n        Y1 <- Y0 + tau # treatment potential outcome \n  for (i in 1:sims){ \n        ## Z.sim <- rbinom(n=N, size=1, prob=.5) # Do a random assignment  by coin flip\n        Z.sim <- sample(rep(c(0,1),N/2)) ## Do a random assignment ensuring equal sized groups\n        Y.sim <- Y1*Z.sim + Y0*(1-Z.sim) # Reveal outcomes according to assignment \n        fit.sim <- lm(Y.sim ~ Z.sim) # Do analysis (Simple regression) \n        p.value <- summary(fit.sim)$coefficients[2,4] # Extract p-values \n        significant.experiments[i] <- (p.value <= alpha) # Determine significance according to p <= 0.05\n        }\n  powers[j] <- mean(significant.experiments) # store average success rate (power) for each N \n  } \npowers \n\n [1] 0.236 0.330 0.410 0.534 0.566 0.560 0.688 0.678 0.728 0.790 0.818 0.852\n[13] 0.864 0.886 0.918 0.888 0.900 0.896 0.944 0.976 0.944 0.964 0.980 0.974\n[25] 0.988 0.986 0.996 0.992 0.996 0.992 0.998 0.990 0.996 1.000 0.998 0.998\n[37] 1.000 1.000 0.998 0.996 1.000 1.000 1.000 1.000 1.000 1.000 1.000 1.000\n\n\nThe code for this simulation and others is available here. Simulation is a far more flexible, and far more intuitive way to think about power analysis. Even the smallest tweaks to an experimental design are difficult to capture in a formula (adding a second treatment group, for example), but are relatively straightforward to include in a simulation.\nIn addition to counting up how often your experiments come up statistically significant, you can directly observe the distribution of p-values you’re likely to get. The graph below shows that under these assumptions, you can get expect to get quite a few p-values in the 0.01 range, but that 80% will be below 0.05.\n\n\n\n7 How to Change your Design to Improve Your Power\nWhen it comes to statistical power, the only thing that that’s under your control is the design of the experiment. As we’ve seen above, an obvious design choice is the number of subjects to include in the experiment. The more subjects, the higher the power.\nHowever, the number of subjects is not the only design choice that has consequences for power. There are two broad classes of design choices that are especially important in this regard.\n\nChoice of estimator. Are you using difference-in-means? Will you be doing some transformation, such as a logit or a probit? Will you be controlling for covariates? Will you be using some kind of robust standard error estimator? All of these choices will make a difference for the statistical significance of your results, and therefore for the power of your experiment. One easy way to think about this is to imagine what command you’ll be running in R or Stata after the experiment has come back; that’s your estimator!\nRandomization Protocol. What kind of randomization will you be employing? Simple randomization gives all subjects an equal probability of being in the treatment group, and then performs a (possibly weighted) coin flip for each. Complete randomization is similar, but it ensures that exactly a certain number will be assigned to treatment. Block randomization is even more powerful — it ensures that a certain number within a subgroup will be assigned to treatment. A restricted random assignment rejects some random assignments based on some set of criteria — lack of balance perhaps. These various types of random assignment can dramatically increase the power of an experiment at no extra cost. Read up on randomization protocols here.\n\nThere are too many choices to cover in this short article, but check out the Simulation for Power Analysis code page for some ways to get started. But to give a flavor of the simulation approach, consider how you would conduct a power analysis if you wanted to include covariates in your analysis.\nIf the covariates you include as control variables are strongly related to the outcome, then you’ve dramatically increased the power of your experiment.Unfortunately, the extra power that comes with including control variables is very hard to capture in a compact formula. Almost none of the power formulas found in textbooks or floating around on the internet can provide guidance on what the inclusion of covariates will do for your power.\nThe answer is simulation.\n\nSuppose we’re studying the effect of an educational intervention on income\nSuppose we have good data on the relationship between two covariates and income: age and gender. In this economy, men earn more than women, and older people earn more than younger people.\nRun a regression of income on age and gender and record the coefficients, using pre-existing survey data (better yet: use baseline data from future participants in your experiment!) *Generate fake covariate data — N total subjects, but broken up by age and gender in a way that reflects your experimental subject pool.\nGenerate fake control data — where the outcome is a function of age and gender according to your regression estimates\nHypothesize a treatment effect to generate fake treatment data\nRun the experiment 10,000 times, and record how often, using a regression with controls, your experiment turns up significant.\n\nHere’s a graph that compares the power of an experiment that does control for background attributes to one that does not. The R-square of the regression relating income to age and gender is pretty high — around .66 — meaning that the covariates that we have gathered (generated) are highly predictive. For a rough comparison, sigma, the level of background noise that the unadjusted model is dealing with, is around 33. This graph shows that at any N, the covariate-adjusted model has more power — so much so that the unadjusted model would need 1500 subjects to achieve what the covariate-adjusted model can do with 500.\n\nThis approach doesn’t rely on a formula to come up with the probability of getting a statistically significant result: it relies on brute force! And because simulation lets you specify every step of the experimental design, you do a far more nuanced power analysis than simply considering the number of subjects.\n\n\n8 Power Analysis for Multiple Treatments\nMany experiments employ multiple treatments which are compared both to each other and to a control group. This added complication changes what we mean when we say the “power” of an experiment. In the single treatment group case, power is just the probability of getting a statistically significant result. In the multiple treatment case, it can mean a variety of things: A) the probability of at least one of the treatments turning up significant, B) the probability of all the treatments turning up significant (versus control) or C) the probability that the treatments will be ranked in the hypothesized order, and that those ranks will be statistically significant.\nThis question of multiple treatment arms is related to the problem of multiple comparisons. (See our guide on this topic for more details.) Standard significance testing is based on the premise that you’re conducting a single test for statistical significance, and the p-values derived from these tests reflect the probability under the null of seeing such a larger (or larger) treatment effect. If, however, you are conducting multiple tests, this probability is no longer correct. Within a suite of tests, the probability that at least one of the tests will turn up significant even when the true effect is zero is higher, essentially because you have more attempts. A commonly cited (if not commonly used) solution is to use the Bonferroni correction: specify the number of comparisons you will be making in advance, then divide your significance level (alpha) by that number.\nIf you are going to be using a Bonferroni correction, then standard power calculators will be more complicated to use: you’ll have to specify your Bonferroni-corrected alpha levels and calculate the power of each separate comparison. To calculate the probability that all the tests are significant, multiply all the separate powers together. To calculate the probability that at least one of the tests is significant, calculate the probability that none are, then subtract from one.\nOr you can use simulation. An example of a power calculation done in R is available on the simulations page.\n\n\n9 How to Think About Power for Clustered Designs\nWhen an experiment has to assign whole groups of people to treatment rather than individually, we say that the experiment is clustered. This is common in educational experiments, where whole classrooms of children are assigned to treatment or control, or in development economics, where whole villages of individuals are assigned to treatment or control. (See our guide on cluster randomization for more details.)\nAs a general rule, clustering decreases your power. If you can avoid clustering your treatments, that is preferable for power. Unless you face concerns related to spillover, logistics, or ethics, take the variation down to the lowest level that you can.\nThe best case scenario for a cluster-level design is when which cluster a subject is in provides very little information about their outcomes. Suppose subjects were randomly assigned to clusters — the cluster wouldn’t help to predict outcomes at all. If the cluster is not predictive of the outcome, then we haven’t lost too much power to clustering.\nWhere clustering really causes trouble is when there is a strong relationship between the cluster and the outcome. To take the villages example, suppose that some villages are, as a whole, much richer than others. Then the clusters might be quite predictive of educational attainment. Clustering can reduce your effective sample size from the total number of individuals to the total number of clusters.\nThere are formulas that can help you understand the consequences of clustering — see Gelman/Hill page 447-449 for an extended discussion. While these formulas can be useful, they can also be quite cumbersome to work with. The core insight however is a simple one: you generally get more power from increasing the number of clusters than you do from increasing the number of subjects within clusters. Better to have 100 clusters with 10 subjects in each than 10 clusters with 100 subjects in each.\nAgain, a more flexible approach to power analysis when dealing with clusters is simulation. See the (Declare Design library for block and cluster randomized experiments)[https://declaredesign.org/r/designlibrary/reference/block_cluster_two_arm_designer.html] for some starter code. The (DeclareDesign)[https://declaredesign.org] software aims to make simulations for power analysis (among many other tasks) easier. See also Gelman/Hill page 450-453 for another simulation approach.\n\n\n10 Good Power Analysis Makes Preregistration Easy\nWhen you deal with power you focus on what you cannot control (noise) and what you can control (design). If you use the simulation approach to power analysis then you will be forced to imagine how your data will look and how you will handle it when it comes in. You will get a chance to specify all of your hunches and best guesses in advance, so that you can launch your experiments with clear expectations of what they can and cannot show. That’s some work but the good news is that if you really do it you are most of the way to putting together a comprehensive and registerable pre-analysis plan.\n\n\n\n\n\nFootnotes\n\n\nOriginating author: Alex Coppock, 20 Nov 2013. The guide is a live document and subject to updating by EGAP members at any time. Coppock is not responsible for subsequent edits to this guide↩︎\nReproduced from Gerber and Green 2012, page 93↩︎\nFor an additional online power visualization tool, see Kristoffer Magnusson’s R Psychologist blog.↩︎"
  },
  {
    "objectID": "guides/getting-started/causal-inference_en.html",
    "href": "guides/getting-started/causal-inference_en.html",
    "title": "10 Things You Need to Know About Causal Inference",
    "section": "",
    "text": "Abstract\nThe philosopher David Lewis described causation as “something that makes a difference, and the difference it makes must be a difference from what would have happened without it.”[^1] This is the interpretation given to causality by most experimentalists. Even though the definition seems simple, it has many subtle implications. Here are ten ideas implied by this notion of causality that matter for research design.1\n\n\n1. A causal claim is a statement about what didn’t happen.\nFor most experimentalists, the statement “\\(X\\) caused \\(Y\\)” means that \\(Y\\) is present and \\(Y\\) would not have been present if \\(X\\) were not present. This definition requires a notion of what could have happened, but did not happen.2 Similarly, the “effect” of \\(X\\) on \\(Y\\) is thought of as the difference between the value that \\(Y\\) would have taken given one value of \\(X\\) and the value that \\(Y\\) would have taken given another value of \\(X\\). Because of the focus on differences in outcomes, this approach is sometimes called the “difference making” or “counterfactual” approach to causation.\nTechnical Note: Statisticians employ the “potential outcomes” framework to describe counterfactual relations. In this framework, we let \\(Y_i(1)\\) denote the outcome for unit \\(i\\) that would be observed under one condition (e.g., if unit \\(i\\) received a treatment) and \\(Y_i(0)\\) the outcome that would be observed in another condition (e.g., if unit \\(i\\) did not receive the treatment). One causal effect of the treatment for unit \\(i\\) might be a simple difference of the potential outcomes \\(τ_i=Y_i(1)−Y_i(0)\\). A treatment has a (positive or negative) causal effect on \\(Y\\) for unit \\(i\\) if \\(Y_i(1)≠Y_i(0)\\).\n\n\n2. There is no causation without manipulation.\nThe “counterfactual” definition of causality requires one to be able to think through what outcomes may result in different conditions. How would things look if one party as opposed to another was elected? Everyday causal statements often fall short of this requirement in one of two ways.\n\nFirst, some statements do not specify clear counterfactual conditions. For example the claim that “the recession was caused by Wall Street” does not point to an obvious counterfactual— are we to consider whether there would have been a recession if Wall Street did not exist? Or is the statement really a statement about particular actions that Wall Street could have taken but did not. If so, which actions? The validity of such statements is hard to assess, and can depend on which counterfactual conditions are implied by a statement.\nSecond, some statements involve counterfactual conditions that cannot be imagined. For example, the claim that Peter got the job because he is Peter implies a consideration of what would have happened if Peter was not Peter. Alternatively, the claim that Peter got the job because he is a man requires considering Peter as other than a man. The problem is that the counterfactuals in these cases imply a change not just in the condition facing an individual but in the individual themselves.\n\nTo avoid such problems, some statisticians urge a restriction of causal claims to treatments that can conceivably (not necessarily practically) be manipulated.3 For example, while we might have difficulties with the claim that Peter got the job because he was a man, we have no such difficulties with the claim that Peter got the job because the hiring agency thought he was a man.\n\n\n3. Causes are non-rival.\nEven though we may focus on the effect of a single cause \\(X\\) on an outcome \\(Y\\), we generally do not expect that there is ever only a single cause of \\(Y\\).4 Moreover, if you add up the causal effects of different causes, there is no reason to expect them to add up to 100%. Hence, there is not much point trying to “apportion” outcomes to different causal factors. In other words, causes are not rival. The National Rifle Association argues, for example, that guns don’t kill people, people kill people. That statement does not make much sense in the counterfactual framework. Take away guns and you have no deaths from gunshot wounds. So guns are a cause. Take away people and you also have no deaths from gunshot wounds, so people are also a cause. Put differently, these two factors are simultaneously causes of the same outcomes.\n\n\n4. \\(X\\) can cause \\(Y\\) even if \\(X\\) is not a necessary condition or a sufficient condition for \\(Y\\).\nWe often talk about causal relations in deterministic terms. Even the Lewis quote at the top of this page seems to suggest a deterministic relation between causes and effects. Sometimes causal relations are thought to entail necessary conditions (for \\(Y\\) to occur, \\(X\\) has to happen); sometimes such relations are thought to entail sufficient conditions (if \\(X\\) occurs, then \\(Y\\) occurs). But once we are talking about multiple units, there are at least two ways in which we can think of \\(X\\) causing \\(Y\\) even if \\(X\\) is neither a necessary nor a sufficient condition for \\(Y\\). The first is to reinterpret everything in probabilistic terms: by \\(X\\) causes \\(Y\\), we simply mean that the probability of \\(Y\\) is higher when \\(X\\) is present. Another is to allow for contingencies — for example, \\(X\\) may cause \\(Y\\) if condition \\(Z\\) is present, but not otherwise.5\n\n\n5. There is a fundamental problem of causal inference.\nIf causal effects are statements about the difference between what happened and what could have happened, then causal effects cannot be measured. That’s bad news. Prospectively, you can arrange things so that you can observe either what happens if someone gets a treatment or what happens if they do not get the treatment. Yet, for the same person, you will never be able to observe both of these outcomes and hence also not the difference between them. This inability to observe unit-level causal effects is often called the “fundamental problem of causal inference.”\n\n\n6. You can estimate average causal effects even though you cannot observe any individual causal effects.\nEven though you cannot observe whether \\(X\\) causes \\(Y\\) for any given unit, it can still be possible to figure out whether \\(X\\) causes \\(Y\\) on average. The key insight here is that the average causal effect equals the difference between the average outcome across all units if all units were in the control condition and the average outcome across all units if all units were in the treatment condition. Many strategies for causal identification (see 10 Strategies for Figuring Out If X Caused Y) focus on ways to learn about these average potential outcomes.6\n10 Things to Know About Hypothesis Testing describes how one can learn about individual causal effects rather than average causal effects given the fundamental problem of causal inference.\n\n\n7. Estimating average causal effects does not require that treatment and control groups are identical.\nOne strategy that people use to learn about average causal effects is to create treatment and control groups through randomization (see 10 Strategies for Figuring Out If X Caused Y). When doing so, researchers sometimes worry if they find that the resulting treatment and control groups do not look the same along relevant dimensions.\nThe good news is that the argument for why differences in average outcomes across randomly assigned treatment and control groups capture average treatment effects (in expectation across repeated randomizations within the same pool of units) does not rely on treatment and control groups being similar in their observed characteristics. It relies only on the idea that, on average, the outcomes in the treated and control groups will capture the average outcomes for all units in the experimental pool if they were, respectively, in treatment or in control. In practice actual treatment and control groups will not be identical.7\n\n\n8. Correlation is not causation.\nA correlation between \\(X\\) and \\(Y\\) is a statement about relations between actual outcomes in the world, not about the relation between actual outcomes and counterfactual outcomes. So statements about causes and correlations don’t have much to do with each other. Positive correlations can be consistent with positive causal effects, no causal effects, or even negative causal effects. For example taking cough medication is positively correlated with coughing but hopefully has a negative causal effect on coughing.8\n\n\n9. If you know that, on average, \\(A\\) causes \\(B\\) and \\(B\\) causes \\(C\\), this does not mean that, on average, \\(A\\) causes \\(C\\).\nYou might expect that if \\(A\\) causes \\(B\\) and \\(B\\) causes \\(C\\) that therefore \\(A\\) causes \\(C\\).9 But there is no reason to believe that average causal relations are transitive in this way. To see why, imagine \\(A\\) caused \\(B\\) for men but not women and \\(B\\) caused \\(C\\) for women but not men. Then on average \\(A\\) causes \\(B\\) and \\(B\\) causes \\(C\\) but there may still be no one for whom \\(A\\) causes \\(C\\) through \\(B\\).\n\n\n10. It’s easier to learn about the “effects of causes” than to learn about the “causes of effects.”\nThough it might sound like two ways of saying the same thing, there is a difference between understanding what the effect of \\(X\\) on \\(Y\\) is (the “effects of a cause”) and whether an outcome \\(Y\\) was due to cause \\(X\\) (the “cause of an effect”).10 Consider the following example. Suppose we run an experiment with a sample that contains an equal number of men and women. The experiment randomly assigns men and women to a binary treatment \\(X\\) and measures a binary outcome \\(Y\\). Further, suppose that \\(X\\) has a positive effect of 1 for all men, i.e. men’s control potential outcome is zero (\\(Y_i(0) = 0\\)) and their treated potential outcome is one (\\(Y_i(1) = 1\\)). For all women, \\(X\\) has a negative effect of \\(-1\\), i.e., women’s control potential outcome is one (\\(Y_i(0) = 1\\)) and their treated potential outcome is zero (\\(Y_i(1) = 0\\)). In this example, the average effect of \\(X\\) on \\(Y\\) is zero. But for all participants in the treatment group with \\(Y=1\\), it is the case that \\(Y=1\\) because \\(X=1\\). Similarly, for all participants in the treatment group with \\(Y=0\\), it is the case that \\(Y=0\\) because \\(X=1\\). Experimentation can get an exact answer to the question about the “effects of a cause”, but generally it is not possible to get an exact answer to the question about the “cause of an effect”.11\n\n\n\n\n\nFootnotes\n\n\nOriginating author: Macartan Humphreys. Minor revisions: Winston Lin and Donald P. Green, 24 Jun 2016. Revisions MH 6 Jan 2020. Revisions Anna Wilke May 2021. The guide is a live document and subject to updating by EGAP members at any time; contributors listed are not responsible for subsequent edits.↩︎\nHolland, Paul W. “Statistics and causal inference.” Journal of the American Statistical Association 81.396 (1986): 945-960.↩︎\nHolland, Paul W. “Statistics and causal inference.” Journal of the American Statistical Association 81.396 (1986): 945-960.↩︎\nIn some accounts this has been called the “Problem of Profligate Causes”.↩︎\nFollowing Mackie, sometimes the idea of “INUS” conditions is invoked to capture the dependency of causes on other causes. Under this account, a cause may be an Insufficient but Necessary part of a condition which is itself Unnecessary but Sufficient. For example dialing a phone number is a cause of contacting someone since having a connection and dialing a number is sufficient (S) for making a phone call, whereas dialing alone without a connection alone would not be enough (I), nor would having a connection (N). There are of course other ways to contact someone without making phone calls (U). Mackie, John L. “The cement of the universe.” London: Oxford Uni (1974).↩︎\nTechnical Note: The key technical insight is that the difference of averages is the same as the average of differences. That is, using the “expectations operator,” \\(𝔼(τ_i)=𝔼(Y_i(1)−Y_i(0))=𝔼(Y_i(1))−𝔼(Y_i(0))\\). The terms inside the expectations operator in the second quantity cannot be estimated, but the terms inside the expectations operators in the third quantity can be.6 See illustration here.↩︎\nFor this reason \\(t\\)-tests to check whether “randomization worked” do not make much sense, at least if you know that a randomized procedure was followed — just by chance 1 in 20 such tests will show statistically detectable differences between treated and control groups. If there are doubts about whether a randomized procedure was correctly implemented these tests can be used to test the hypothesis that the data was indeed generated by a randomized procedure. This later reason for randomization tests can be especially important in field experiments where chains of communication from the person creating random numbers and the person implementing treatment assignment may be long and complex.↩︎\nTechnical Note: Let \\(D_i\\) be an indicator for whether unit \\(i\\) has received a treatment or not. Then the difference in average outcomes between those that receive the treatment and those that do not can be written as \\(\\frac{∑_i D_i×Y_i(1)}{∑_iD_i}−\\frac{∑_i (1−D_i)×Y_i(0)}{∑_i (1−D_i)}\\). In the absence of information about how treatment was assigned, we can say little about whether this difference is a good estimator of the average treatment effect, i.e., of the difference in average treated and control potential outcomes across all units. What matters is whether \\(\\frac{∑_i D_i×Y_i(1)}{∑_iD_i}\\) is a good estimate of \\(\\frac{∑_i 1×Y_i(1)}{∑_i1}\\) and whether \\(\\frac{∑_i (1−D_i)×Y_i(0)}{∑_i (1−D_i)}\\) is a good estimate of \\(\\frac{∑_i 1×Y_i(0)}{∑_i1}\\). This might be the case if those who received treatment are a representative sample of all units, but otherwise there is no reason to expect that it would be.↩︎\nInterpret “\\(A\\) causes \\(B\\), on average” as “the average effect of \\(A\\) on \\(B\\) is positive.”↩︎\nSome reinterpret the “causes of effects” question to mean: what are the causes that have effects on outcomes. See Andrew Gelman and Guido Imbens, “Why ask why? Forward causal inference and reverse causal questions”, NBER Working Paper No. 19614 (Nov. 2013).↩︎\nSee, for example, Tian, J., Pearl, J. 2000. “Probabilities of Causation: Bounds and Identification.” Annals of Mathematics and Artificial Intelligence 28:287–313.↩︎"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "EGAP Learning",
    "section": "",
    "text": "This is a Quarto website.\nTo learn more about Quarto websites visit https://quarto.org/docs/websites.\n\n1 + 1\n\n[1] 2"
  },
  {
    "objectID": "guides/getting-started/causal-inference_esp.html",
    "href": "guides/getting-started/causal-inference_esp.html",
    "title": "10 cosas que debe saber sobre la inferencia causal",
    "section": "",
    "text": "Resumen\nEl filósofo David Lewis describió la causalidad como “algo que marca la diferencia, y esa diferencia que hace, debe ser la diferencia entre lo que fue y lo que hubiera sido sin ese algo”.1 Esta es la interpretación que dan a la causalidad la mayoría de los experimentalistas. Aunque la definición parece simple, tiene muchas implicaciones sutiles. Aquí les presentamos diez ideas implícitas en esta noción de causalidad que son importantes para el diseño de investigación.2\n\n\n1. Una afirmación causal es un enunciado sobre lo que no sucedió\nPara la mayoría de investigadores que realizan experimentos, el enunciado “\\(X\\) causó \\(Y\\)” significa que \\(Y\\) ocurrió y que no habría ocurrido si \\(X\\) no hubiera estado presente. Esta definición requiere que tengamos una noción de lo que podría haber sucedido, pero no sucedió.3 De manera similar, el “efecto” de \\(X\\) en \\(Y\\) se considera la diferencia entre el valor que \\(Y\\) habría tomado dado un valor de \\(X\\) y el valor que \\(Y\\) habría tomado dado otro valor de \\(X\\). Debido al enfoque en la diferencia de los resultados, este enfoque a veces se conoce como el enfoque de causalidad basado en “hacer diferencias” o en lo “contrafactual”.\nNota técnica: Los estadísticos emplean el marco de “resultados potenciales” para describir las relaciones contrafactuales. En este marco, dejamos que \\(Y_i(1)\\) denote el valor que la unidad \\(i\\) tomaría bajo la condición uno (por ejemplo, si la unidad \\(i\\) recibió un tratamiento) y \\(Y_i(0)\\) el valor que habría sido observado en otra condición (por ejemplo, si la unidad \\(i\\) no recibió el tratamiento). Un efecto causal del tratamiento para la unidad \\(i\\) puede ser una simple diferencia de los resultados potenciales \\(\\tau_i = Y_i(1)-Y_(0)\\). Un tratamiento tiene un efecto causal (positivo o negativo) en \\(Y\\) para la unidad \\(i\\) si \\(Y_i (1) \\neq Y_i (0)\\).\n\n\n2. No hay relación causal sin manipulación.\nLa definición “contrafactual” de causalidad requiere que uno sea capaz de pensar qué valores podemos observar en diferentes condiciones. ¿Cómo serían las cosas si se eligiera un partido en lugar de otro? Las declaraciones causales cotidianas a menudo no cumplen con este requisito en alguna de estas dos formas:\n\nPrimero, algunas declaraciones no especifican condiciones contrafactuales claras. Por ejemplo, la afirmación de que “la recesión fue causada por Wall Street” no apunta a un contrafactual obvio: ¿debemos considerar si habría habido una recesión si Wall Street no existiera? ¿O es la afirmación realmente una afirmación sobre acciones particulares que Wall Street podría haber tomado pero no lo hizo? Si es así, ¿qué acciones? Es difícil evaluar la validez de tales declaraciones. Además, puede depender de qué condiciones contrafactuales estén implícitas en una afirmación.\nEn segundo lugar, algunos enunciados implican condiciones contrafactuales que no son posibles de imaginar. Por ejemplo, la afirmación de que Peter consiguió el trabajo porque es Peter implica una consideración de lo que habría sucedido si Peter no fuera Peter. Alternativamente, la afirmación de que Peter consiguió el trabajo porque es un hombre requiere considerar a Peter como algo diferente de un hombre. El problema es que los contrafactuales en estos casos implican un cambio no solo en la condición que enfrenta un individuo sino en el propio individuo.\n\nPara evitar estos problemas, algunos estadísticos instan a restringir las afirmaciones causales a los tratamientos que pueden manipularse, al menos en la imaginación, y no necesariamente en la práctica.4 Por ejemplo, si bien podríamos tener dificultades con la afirmación de que Peter consiguió el trabajo porque es hombre, no tendríamos las mismas dificultades con la afirmación de que Peter consiguió el trabajo porque la agencia de contratación pensó que era hombre\n\n\n3. Las causas no tienen por qué ser rivales.\nAunque nos podemos centrar en el efecto de una sola causa \\(X\\) en un variable de resultado \\(Y\\), generalmente no esperamos que \\(Y\\) tenga solo una causa.5 Además, si sumamos los efectos causales de diferentes causas, no hay razón para esperar que sumen el 100%. Por lo tanto, no tiene mucho sentido tratar de “distribuir” los resultados entre diferentes factores causales. En otras palabras, las causas no tienen por qué ser rivales. La Asociación Nacional del Rifle de Estados Unidos sostiene, por ejemplo, que las armas no matan a la gente, la gente mata a la gente. Esa afirmación no tiene mucho sentido en el marco hipotético. Quita las armas y no tendrás muertes por heridas de bala. Entonces las armas son una causa. Quita a la gente y tampoco tendrás muertes por heridas de bala, por lo que las personas también son una causa. Dicho de otra manera, estos dos factores son simultáneamente causas de los mismos resultados.\n\n\n4. \\(X\\) puede causar \\(Y\\) incluso si \\(X\\) no es una condición necesaria o una condición suficiente para que \\(Y\\) ocurra.\nA menudo hablamos de relaciones causales en términos deterministas. Incluso la cita de Lewis en la parte superior de esta página parece sugerir una relación determinista entre causas y efectos. A veces se piensa que las relaciones causales implican condiciones necesarias (para \\(Y\\) que ocurra, \\(X\\) tiene que suceder ); a veces se piensa que tales relaciones implican condiciones suficientes (si ocurre \\(X\\), entonces ocurre \\(Y\\)). Pero una vez que hablamos de múltiples unidades, hay al menos dos formas en las que podemos pensar en que \\(X\\) causa \\(Y\\) incluso si \\(X\\) no es una condición necesaria ni suficiente para \\(Y.\\) La primera es reinterpretar todo en términos probabilísticos: que \\(X\\) cause \\(Y\\), simplemente quiere decir que la probabilidad de \\(Y\\) es mayor cuando \\(X\\) está presente. Otra forma es permitir contingencias. Por ejemplo, \\(X\\) puede causar \\(Y\\) si la condición \\(Z\\) está presente, pero no de otra manera.6\n\n\n5. Existe un problema fundamental de la inferencia causal\nSi los efectos causales son enunciados sobre la diferencia entre lo que sucedió y lo que podría haber sucedido, entonces no los podemos medir. Malas noticias. De manera prospectiva, puede organizar las cosas para que pueda observar lo que sucede si alguien recibe un tratamiento o lo que sucede si no recibe el tratamiento. Sin embargo, para la misma persona nunca podrá observar ambos resultados y, por lo tanto, tampoco la diferencia entre ellos. Esta incapacidad para observar efectos causales a nivel de la unidad de estudio a menudo se denomina “problema fundamental de la inferencia causal”.\n\n\n6. Usted puede estimar el efecto causal promedio aun cuando no pueda observar ningún efecto causal individual.\nAunque no pueda observar si \\(X\\) causa \\(Y\\) para una unidad determinada, sí es posible determinar si \\(X\\) causa \\(Y\\) en promedio. La idea clave aquí es que el efecto causal promedio es igual a la diferencia entre la variable de resultado promedio para todas las unidades, si todas están en la condición de control y la variable de resultado promedio para todas las unidades si todas están en la condición de tratamiento. Muchas estrategias para la identificación causal (ver 10 estrategias para determinar si X causó Y) se enfocan en formas de aprender acerca de estas resultados potenciales promedio.7\n10 cosas que debe saber sobre las pruebas de hipótesis nos muestra cómo podemos aprender acerca de efectos causales individuales en vez de efectos promediodato el problema fundamental de la inferencia causal.\n\n\n7. La estimación del efecto causal promedio no requiere que los grupos de tratamiento y control sean idénticos.\nUna estrategia que la gente usa para aprender acerca del efecto causal promedio es crear grupos de tratamiento y control a través de la aleatorización (ver 10 estrategias para determinar si X causó Y). Es común que algunos investigadores se preocupen por que los grupos de tratamiento y control resultantes no sean similares en dimensiones relevantes.\nLa buena noticia es que la razón por la cual las diferencias en los resultados promedio entre los grupos de control y tratamiento asignados aleatoriamente capturan los efectos promedio del tratamiento (en valor esperado a través de aleatorizaciones repetidas dentro del mismo grupo de unidades) no se basa en que los grupos de tratamiento y control sean similares en las características observadas. Sino que se basa únicamente en la idea de que, en promedio, los resultados en los grupos tratados y de control capturarán los resultados promedio para todas las unidades en el grupo experimental si estuvieran, respectivamente, en tratamiento o en control. En la práctica, los grupos de tratamiento y de control no serán idénticos.8\n\n\n8. Correlación no es igual a causalidad.\nUna correlación entre \\(X\\) y \\(Y\\) es un enunciado sobre las relaciones entre los valores reales de estas variables y no sobre la relación entre los valores reales y los valores contrafactuales. Entonces las afirmaciones sobre causas y correlaciones no tienen mucho que ver entre sí. Las correlaciones positivas pueden ser consistentes con efectos causales positivos, efectos causales nulos o incluso con efectos causales negativos. Por ejemplo, tomar medicamentos para la tos se correlaciona positivamente con la tos, pero es de esperar que tenga un efecto causal negativo sobre la tos.9\n\nSi usted sabe que, en promedio, \\(A\\) causa $ B $ y \\(B\\) causa \\(C\\), esto no significa que, en promedio, \\(A\\) cause \\(C\\).\n\n== Se podría esperar que si \\(A\\) causa \\(B\\) y \\(B\\) causa \\(C\\), entonces \\(A\\) causa \\(C\\).10 Pero no hay razón para creer que las relaciones causales promedio sean transitivas. Para entender por qué, imagine que \\(A\\) causó \\(B\\) en los hombres pero no en las mujeres y \\(B\\) causó \\(C\\) en las mujeres pero no en los hombres. Entonces, en promedio, \\(A\\) causa \\(B\\) y \\(B\\) causa \\(C\\), pero es posible que no haya nadie para quien \\(A\\) tenga un efecto en \\(C\\) mediado por \\(B\\).\n\n\n10. Es más fácil aprender sobre los “efectos de las causas” que aprender sobre las “causas de los efectos”.\nAunque puedan parecer dos formas de decir exactamente lo mismo, existe una diferencia entre comprender cuál es el efecto de \\(X\\) en \\(Y\\) (los “efectos de una causa”) y si el valor que tomó \\(Y\\) se debió a \\(X\\) (la “causa de un efecto”).11 Considere el siguiente ejemplo. Supongamos que realizamos un experimento con una muestra que contiene el mismo número de hombres y mujeres. El experimento asigna aleatoriamente a hombres y mujeres a un tratamiento binario \\(X\\) y mide una variable de resultado binaria \\(Y\\). Además suponga que \\(X\\) tiene un efecto positivo de 1 para todos los hombres, es decir, el resultado potencial del control de los hombres es cero (\\(Y_i(0) = 0\\)) y la salida potencial cuando son tratados es uno (\\(Y_i(1) = 1\\)). Para todas las mujeres, \\(X\\) tiene un efecto negativo de \\(-1\\), es decir, la salida potencial de las mujeres bajo el control es uno (\\(Y_i (0) = 1\\)) y su salida potencial cuando son tratadas es cero (\\(Y_i (1) = 0\\)) En este ejemplo, el efecto promedio de \\(X\\) en $ Y $ es cero. Pero la razón para que los participantes en el grupo de tratamiento tengan \\(Y= 1\\), es porque \\(X = 1\\). De manera similar, todos los participantes en el grupo de tratamiento con \\(Y = 0\\), tienen \\(Y = 0\\) porque \\(X = 1\\). Los experimentos nos permiten obtener una respuesta exacta a la pregunta sobre los “efectos de una causa”, pero en general no es posible obtener una respuesta exacta a la pregunta sobre la “causa de un efecto”.12\n\n\n\n\n\nFootnotes\n\n\nLewis, David. “Causation.” The journal of philosophy (1973): 556-567.↩︎\nAutor: Macartan Humphreys. Revisiones menores: Winston Lin y Donald P. Green, 24 de junio de 2016. Revisiones MH 6 de enero de 2020. Revisiones Anna Wilke de mayo de 2021. Esta guía es un documento dinámico y está sujeta a actualización por parte de los miembros de EGAP; los colaboradores enumerados no son responsables de las ediciones posteriores.↩︎\nHolland, Paul W. “Statistics and causal inference.” Journal of the American Statistical Association 81.396 (1986): 945-960.↩︎\nHolland, Paul W. “Statistics and causal inference.” Journal of the American Statistical Association 81.396 (1986): 945-960.↩︎\nEsto se conoce a veces como el “Problema de las causas excesivas”.↩︎\nDe acuerdo a Mackie, a veces se invoca la idea de condiciones “INUS” para capturar la dependencia de las causas de otras causas. Según esta explicación, una causa puede ser parte Insuficiente pero Necesaria de una condición que en sí misma es Innecesaria pero Suficiente. Por ejemplo, marcar un número de teléfono es una causa de contacto con alguien, ya que tener una conexión y marcar un número es suficiente (S) para hacer una llamada telefónica, mientras que marcar solo sin una conexión no sería suficiente (I), ni tener una conexión (N). Por supuesto, hay otras formas de contactar a alguien sin hacer llamadas telefónicas (U). Mackie, John L. “El cemento del universo”. Londres: Oxford Uni (1974).↩︎\nNota técnica: La idea técnica clave es que la diferencia de promedios es la misma que el promedio de diferencias. Es decir, usando el “operador de expectativas”, \\(\\text{E}(\\tau_i) = \\text{E}(Y_i (1) -Y_i (0)) = \\text{E}(Y_i (1)) - \\text{E}(Y_i (0))\\). Los términos dentro del operador de esperanzas en la segunda cantidad no se pueden estimar, pero los términos dentro de los operadores de expectativas en la tercera cantidad si se pueden ser estimados7 Vea la ilustración [aquí] (https://raw.githubusercontent.com/egap/ guías-métodos / maestro / inferencia-causal / PO.jpg).↩︎\nPor esta razón usar las pruebas \\(t\\) para verificar si “la asignación aleatoria funcionó bien” no tiene mucho sentido, al menos si se sabe que se siguió una procedimiento aleatorio: por simple chance, 1 de cada 20 de esas pruebas mostrará diferencias estadísticamente detectables entre los grupos tratados y de control. Si existen dudas sobre si la asignación aleatoria se realizó correctamente, estas pruebas se pueden utilizar para probar la hipótesis de que los datos se generaron efectivamente mediante un procedimiento aleatorio. Esta última razón para las pruebas de aleatorización puede ser especialmente importante en experimentos de campo donde las cadenas de comunicación entre la persona que crea los números aleatorios y la persona que implementa la asignación del tratamiento son largas y complejas.↩︎\nNota técnica: Sea \\(D_i\\) un indicador de si la unidad \\(i\\) ha recibido un tratamiento o no. Entonces la diferencia en los resultados promedio entre los que reciben el tratamiento y los que no lo reciben se puede escribir como \\(\\frac{\\sum_i D_i × Y_i (1)} {\\sum_iD_i} - \\frac {\\sum_i(1 - D_i) \\times Y_i (0)}{\\sum_i (1 - D_i)}\\). Sin información sobre cómo se asignó el tratamiento, no hay mucho por decir sobre si esta diferencia es un buen estimador del efecto promedio del tratamiento. Es decir, de la diferencia en los resultados potenciales promedio de las unidades en el grupo de tratamiento y control para todas las unidades. Lo que importa es si \\(\\frac{\\sum_i D_i × Y_i (1)} {\\sum_iD_i}\\) es una buena estimación de \\(\\frac{\\sum_i 1 × Y_i (1)} {\\sum_i1}\\) y si \\(\\frac{\\sum_i (1 - D_i) × Y_i (0)}{\\sum_i(1 - D_i)}\\) es una buena estimación de \\(\\frac{\\sum_i 1 × Y_i (0)} {\\sum_i1}\\). Este puede ser el caso si los que recibieron tratamiento son una muestra representativa de todas las unidades, pero de lo contrario no hay razón para esperar que así sea.↩︎\nEntiéndase la expresión “\\(A\\) causa \\(B\\), en promedio” como “el efecto promedio de \\(A\\) sobre \\(B\\) es positivo”.↩︎\nA veces se reinterpreta la pregunta “causas de los efectos” en el sentido de: ¿cuáles son las causas que tienen efectos sobre las variable de resultado? Véase Andrew Gelman and Guido Imbens, “Why ask why? Forward causal inference and reverse causal questions”, NBER Working Paper No. 19614 (Nov. 2013).↩︎\nVer, por ejemplo, Tian, J., Pearl, J. 2000. “Probabilities of Causation: Bounds and Identification.” Annals of Mathematics and Artificial Intelligence 28:287–313.↩︎"
  },
  {
    "objectID": "guides/getting-started/causal-inference_fr.html",
    "href": "guides/getting-started/causal-inference_fr.html",
    "title": "10 choses à savoir sur l’inférence causale",
    "section": "",
    "text": "Résumé\nLe philosophe David Lewis a décrit la causalité comme “quelque chose qui fait une différence, et cette différence doit être une différence par rapport à ce qui se serait passé sans elle”.1 Ceci est l’interprétation de la causalité pour la plupart des expérimentalistes. Même si la définition semble simple, elle a de nombreuses implications subtiles. Voici dix idées impliquées par cette notion de causalité qui importent pour la conception de recherche. 2\n\n\n1. Une assertion causale est une déclaration sur ce qui ne s’est pas produit.\nPour la plupart des expérimentalistes, la déclaration “\\(X\\) a causé \\(Y\\)” signifie que \\(Y\\) est présent et \\(Y\\) n’aurait pas été présent si \\(X\\) n’avait pas été présent. Cette définition requiert une notion de ce qui aurait pu arriver, mais ne s’est pas produit.3 De même, “l’effet” de \\(X\\) sur \\(Y\\) est la différence entre la valeur que \\(Y\\) aurait prise étant donné une valeur de \\(X\\) et la valeur que \\(Y\\) aurait prise étant donné une autre valeur de \\(X\\). En raison de l’accent mis sur les différences entre les résultats, cette approche est parfois appelée approche “des différences” ou “contrefactuelle” de la causalité.\nNote technique: Les statisticiens emploient le cadre des “résultats potentiels” pour décrire les relations contrefactuelles. Dans ce cadre, \\(Y_i(1)\\) désigne le résultat pour l’unité \\(i\\) qui serait observé sous une condition (par exemple, si l’unité \\(i\\) a reçu un traitement) et \\(Y_i(0)\\) désigne le résultat qui serait observé dans une autre condition (par exemple, si l’unité \\(i\\) n’a pas reçu le traitement). Un effet causal du traitement pour l’unité \\(i\\) pourrait être une simple différence des résultats potentiels \\(τ_i=Y_i(1)−Y_i(0)\\). Un traitement a un effet causal (positif ou négatif) sur \\(Y\\) pour l’unité \\(i\\) si \\(Y_i(1)≠Y_i(0)\\).\n\n\n2. Pas de causalité sans manipulation.\nLa définition “contrefactuelle” de la causalité exige que l’on soit capable de réfléchir aux résultats qui peuvent entraîner des conditions différentes. Quelle serait la situation si un parti plutôt qu’un autre était élu ? Les déclarations causales de tous les jours ne répondent souvent pas à cette exigence de l’une des deux manières suivantes.\n\nPremièrement, certaines déclarations ne précisent pas de conditions contrefactuelles claires. Par exemple, l’affirmation selon laquelle “la récession a été causée par Wall Street” n’indique pas de contrefactuel évident — devons-nous examiner s’il y aurait eu une récession si Wall Street n’avait pas existé ? Ou est-ce une déclaration sur des décisions particulières que Wall Street aurait pu prendre mais n’a pas prises ? Si oui, quelles décisions ? La validité de telles déclarations est difficile à évaluer et peut dépendre des conditions contrefactuelles impliquées par une déclaration.\nDeuxièmement, certaines déclarations impliquent des conditions contrefactuelles qui ne peuvent être imaginées. Par exemple, l’affirmation selon laquelle Peter a obtenu le poste parce qu’il est Peter implique une considération de ce qui se serait passé si Peter n’était pas Peter. Alternativement, l’affirmation selon laquelle Peter a obtenu le poste parce qu’il est un homme nécessite de considérer Peter comme autre qu’un homme. Le problème est que les contrefactuels dans ces cas impliquent un changement non seulement de la condition à laquelle fait face un individu, mais de l’individu lui-même.\n\nPour éviter de tels problèmes, certains statisticiens recommandent de restreindre les assertions causales aux traitements qui peuvent en théorie (pas nécessairement en pratique) être manipulés.4 Par exemple, alors que nous pourrions avoir des difficultés avec l’affirmation selon laquelle Peter a obtenu le poste parce qu’il était un homme, nous n’avons pas de telles difficultés avec l’affirmation selon laquelle Peter a obtenu le poste parce que l’agence de recrutement pensait qu’il était un homme.\n\n\n3. Les causes sont non rivales.\nMême si nous pouvons nous concentrer sur l’effet d’une seule cause \\(X\\) sur un résultat \\(Y\\), nous ne nous attendons généralement pas à ce qu’il n’y ait qu’une seule cause de \\(Y\\).5 De plus, si vous additionnez les effets causaux de différentes causes, il n’y a aucune raison de s’attendre à ce qu’ils totalisent 100 %. Par conséquent, il ne sert à rien d’essayer de “répartir” les résultats entre différents facteurs de causalité. En d’autres termes, les causes sont non rivales. La National Rifle Association soutient, par exemple, que les armes à feu ne tuent pas les gens, les gens tuent les gens. Cette déclaration n’a pas beaucoup de sens dans le cadre contrefactuel. Enlevez les armes à feu et vous n’aurez pas de morts par balles. Les armes à feu sont donc une cause. Enlevez les gens et vous n’aurez pas non plus de décès par balle, donc les gens sont aussi une cause. En d’autres termes, ces deux facteurs sont simultanément les causes des mêmes résultats.\n\n\n4. \\(X\\) peut causer \\(Y\\) même si \\(X\\) n’est pas une condition nécessaire ou une condition suffisante pour \\(Y\\).\nOn parle souvent des relations causales en termes déterministes. Même la citation de Lewis en haut de cette page semble suggérer une relation déterministe entre les causes et les effets. On pense parfois que les relations causales impliquent des conditions nécessaires (pour que \\(Y\\) se produise, \\(X\\) doit se produire); on pense parfois que de telles relations impliquent des conditions suffisantes (si \\(X\\) se produit, alors \\(Y\\) se produit). Mais une fois que nous parlons d’unités multiples, il y a au moins deux façons de penser que \\(X\\) cause \\(Y\\) même si \\(X\\) n’est ni une condition nécessaire ni une condition suffisante pour \\(Y\\). La première consiste à tout réinterpréter en termes probabilistes : par \\(X\\) cause \\(Y\\), on entend simplement que la probabilité de \\(Y\\) est plus élevée lorsque \\(X\\) est présent. Une autre consiste à tenir compte des contingences — par exemple, \\(X\\) peut causer \\(Y\\) si la condition \\(Z\\) est présente, mais pas dans le cas contraire.6\n\n\n5. Le problème fondamental de l’inférence causale.\nSi les effets causaux sont des déclarations sur la différence entre ce qui s’est produit et ce qui aurait pu se produire, alors les effets causaux ne peuvent pas être mesurés. Mauvaise nouvelle ! De manière prospective, vous pouvez organiser les choses de manière à observer ce qui se passe si une personne reçoit un traitement ou ce qui se passe si elle ne reçoit pas le traitement. Pourtant, pour la même personne, vous ne pourrez jamais observer ces deux résultats et leur différence. Cette incapacité à observer les effets causaux au niveau de l’unité est souvent appelée le “problème fondamental de l’inférence causale”.\n\n\n6. Vous pouvez estimer l’effet causal moyen même si vous ne pouvez observer aucun effet causal individuel.\nMême si vous ne pouvez pas observer si \\(X\\) cause \\(Y\\) pour une unité donnée, il est peut-être toujours possible de déterminer si \\(X\\) cause \\(Y\\) en moyenne. L’effet causal moyen est égal à la différence entre le résultat moyen pour toutes les unités si elles étaient toutes dans la condition de contrôle et le résultat moyen pour toutes les unités si elles étaient toutes dans la condition de traitement. De nombreuses stratégies d’identification causale (voir 10 stratégies pour déterminer si X a causé Y) se concentrent sur des façons d’en savoir plus sur ces résultats potentiels moyens.7\n10 choses à savoir sur les tests d’hypothèse décrit comment en savoir plus sur les effets causaux individuels plutôt que sur les effets causaux moyens étant donné le problème fondamental de l’inférence causale.\n\n\n7. L’estimation de l’effet causal moyen ne nécessite pas que les groupes de traitement et de contrôle soient identiques.\nUne stratégie que les gens utilisent pour en savoir plus sur l’effet causal moyen consiste à créer des groupes de traitement et de contrôle par randomisation (voir 10 Stratégies pour déterminer si X a causé Y). Ce faisant, les chercheurs s’inquiètent parfois s’ils constatent que les groupes de traitement et de contrôle qui en résultent ne sont pas comparables sur certaines dimensions importantes.\nLa bonne nouvelle est que l’argument expliquant pourquoi les différences dans les résultats moyens entre les groupes de traitement et de contrôle assignés de manière aléatoire capturent l’effet moyen du traitement (en espérance pour des randomisations répétées au sein du même groupe d’unités) ne repose pas sur le fait que les groupes de traitement et de contrôle ont des caractéristiques observées similaires. Il repose uniquement sur l’idée que, en moyenne, les résultats dans les groupes de traitement et de contrôle captureront les résultats moyens pour toutes les unités du groupe expérimental si elles étaient, respectivement, dans le traitement ou dans le contrôle. En pratique, les groupes de traitement et de contrôle réels ne seront pas identiques.8\n\n\n8. La corrélation n’est pas la causalité.\nUne corrélation entre \\(X\\) et \\(Y\\) est une déclaration sur les relations entre les résultats réels, et non sur la relation entre les résultats réels et les résultats contrefactuels. Ainsi, les déclarations sur les causes et les corrélations n’ont pas grand-chose à voir les unes avec les autres. Des corrélations positives peuvent être cohérentes avec des effets causaux positifs, aucun effet causal ou même des effets causaux négatifs. Par exemple, la prise de médicaments contre la toux est positivement corrélée à la toux mais a, espérons-le, un effet causal négatif sur la toux.9\n\n\n9. Si vous savez qu’en moyenne \\(A\\) cause \\(B\\) et \\(B\\) cause \\(C\\), cela ne veut pas dire qu’en moyenne \\(A\\) cause \\(C\\).\nVous pourriez vous attendre à ce que si \\(A\\) cause \\(B\\) et \\(B\\) cause \\(C\\), alors \\(A\\) cause \\(C\\).10 Mais il n’y a aucune raison que les relations causales moyennes soient transitives. Imaginez que \\(A\\) cause \\(B\\) pour les hommes mais pas les femmes et \\(B\\) cause \\(C\\) pour les femmes mais pas les hommes. Ensuite, en moyenne, \\(A\\) cause \\(B\\) et \\(B\\) cause \\(C\\), mais \\(A\\) ne cause pas \\(C\\) à travers \\(B\\).\n\n\n10. Il est plus facile d’en apprendre davantage sur les “effets des causes” que sur les “causes des effets”.\nBien que cela puisse sembler être deux façons de dire la même chose, il y a une différence entre comprendre quel est l’effet de \\(X\\) sur \\(Y\\) (les “effets d’une cause”) et si un résultat \\(Y\\) était dû à une cause \\(X\\) (la “cause d’un effet”).11 Considérez l’exemple suivant. Supposons que nous menions une expérience avec un échantillon qui contient un nombre égal d’hommes et de femmes. L’expérience assigne de manière aléatoire des hommes et des femmes à un traitement binaire \\(X\\) et mesure un résultat binaire \\(Y\\). De plus, supposons que \\(X\\) ait un effet positif de 1 pour tous les hommes, c’est-à-dire le résultat potentiel de contrôle des hommes est de zéro, \\(Y_i(0) = 0\\), et leur résultat potentiel traité est de un, \\(Y_i(1) = 1\\). Pour toutes les femmes, \\(X\\) a un effet négatif de \\(-1\\), c’est-à-dire que le résultat potentiel de contrôle des femmes est de un, \\(Y_i(0) = 1\\), et leur résultat potentiel traité est de zéro, \\(Y_i(1) = 0\\). Dans cet exemple, l’effet moyen de \\(X\\) sur \\(Y\\) est nul. Mais pour tous les participants du groupe de traitement avec \\(Y=1\\), il est vrai que \\(Y=1\\) car \\(X=1\\). De même, pour tous les participants du groupe de traitement avec \\(Y=0\\), il est vrai que \\(Y=0\\) car \\(X=1\\). L’expérimentation peut obtenir une réponse exacte à la question sur les “effets d’une cause”, mais il n’est généralement pas possible d’obtenir une réponse exacte à la question sur la “cause d’un effet”.12\n\n\n\n\n\nFootnotes\n\n\nLewis, David. “Causation.” The journal of philosophy (1973): 556-567.↩︎\nAuteur d’origine : Macartan Humphreys. Révisions mineures : Winston Lin et Donald P. Green, 24 juin 2016. Révisions MH 6 janvier 2020. Révisions Anna Wilke mai 2021. Le guide est un document vivant et peut être mis à jour par les membres de EGAP à tout moment ; les contributeurs répertoriés ne sont pas responsables des modifications ultérieures.↩︎\nHolland, Paul W. “Statistics and causal inference.” Journal of the American Statistical Association 81.396 (1986): 945-960.↩︎\nHolland, Paul W. “Statistics and causal inference.” Journal of the American Statistical Association 81.396 (1986): 945-960.↩︎\nCertains appellent cela le “problème des causes de prodigalité”.↩︎\nMackie a présenté l’idée de conditions dites “INSS” (“INUS” en anglais) pour capturer la dépendance des causes sur d’autres causes. Une cause peut être une partie Insuffisante mais Nécessaire d’une condition qui est elle-même Superflue mais Suffisante. Par exemple, composer un numéro de téléphone est une cause de “contacter quelqu’un” car avoir une connexion et composer un numéro est suffisant (S) pour passer un appel téléphonique, alors que composer seul sans connexion ne suffirait pas (I), ni avoir un connexion (N). Il existe bien sûr d’autres moyens de contacter quelqu’un sans passer d’appels téléphoniques (S). Mackie, John L. “The cement of the universe.” London: Oxford Uni (1974).↩︎\nNote technique : La principale idée technique est que la différence des moyennes est la même que la moyenne des différences. C’est-à-dire, en utilisant “l’opérateur d’espérance”, \\(𝔼(τ_i)=𝔼(Y_i(1)−Y_i(0))=𝔼(Y_i(1))−𝔼(Y_i(0))\\). Les termes à l’intérieur de l’opérateur d’espérance dans la deuxième quantité ne peuvent pas être estimés, mais les termes à l’intérieur de l’opérateur d’espérance dans la troisième quantité peuvent l’être.7Voir l’illustration ici.↩︎\nPour cette raison, les tests-\\(t\\) pour vérifier si “la randomisation a fonctionné” n’ont pas beaucoup de sens, du moins si vous savez qu’une procédure randomisée a été suivie — simplement par hasard, 1 test sur 20 montrera des différences statistiquement détectables entre les groupes de traitement et de contrôle. En cas de doute sur la mise en œuvre correcte d’une procédure randomisée, ces tests peuvent être utilisés pour tester l’hypothèse selon laquelle les données ont bien été générées par une procédure randomisée. Ces tests peuvent alors être particulièrement importants pour des expériences de terrain où les chaînes de communication entre la personne randomisant et la personne mettant en œuvre l’assignation du traitement peuvent être longues et complexes.↩︎\nNote technique: soit \\(D_i\\) un indicateur pour savoir si l’unité \\(i\\) a reçu un traitement ou non. Alors, la différence des résultats moyens entre ceux qui reçoivent le traitement et ceux qui ne le reçoivent pas peut s’écrire \\(\\frac{∑_i D_i×Y_i(1)}{∑_iD_i}−\\frac{∑_i (1−D_i)× Y_i(0)}{∑_i (1−D_i)}\\). En l’absence d’informations sur la manière dont le traitement a été assigné, nous ne pouvons pas dire si cette différence est un bon estimateur de l’effet moyen du traitement, c’est-à-dire de la différence entre les résultats potentiels moyens pour les groupes de traitement et de contrôle pour toutes les unités. Ce qui importe est de savoir si \\(\\frac{∑_i D_i×Y_i(1)}{∑_iD_i}\\) est une bonne estimation de \\(\\frac{∑_i 1×Y_i(1)}{∑_i1}\\) et si \\(\\frac {∑_i (1−D_i)×Y_i(0)}{∑_i (1−D_i)}\\) est une bonne estimation de \\(\\frac{∑_i 1×Y_i(0)}{∑_i1}\\). Cela pourrait être le cas si ceux qui ont reçu un traitement sont un échantillon représentatif de toutes les unités, mais sinon il n’y a aucune raison de s’attendre à ce qu’il le soit.↩︎\nInterprétez “\\(A\\) cause \\(B\\), en moyenne” comme “l’effet moyen de \\(A\\) sur \\(B\\) est positif”.↩︎\nCertains réinterprètent la question des “causes des effets” comme suit : quelles sont les causes qui ont des effets sur les résultats. Voir Andrew Gelman and Guido Imbens, “Why ask why? Forward causal inference and reverse causal questions”, NBER Working Paper No. 19614 (Nov. 2013).↩︎\nVoir, par exemple, Tian, J., Pearl, J. 2000. “Probabilities of Causation: Bounds and Identification.” Annals of Mathematics and Artificial Intelligence 28:287–313.↩︎"
  },
  {
    "objectID": "guides/getting-started/covariates_en.html",
    "href": "guides/getting-started/covariates_en.html",
    "title": "10 Things to Know About Covariate Adjustment",
    "section": "",
    "text": "Abstract\nThis guide1 will help you think through when it makes sense to try to “control for other things” when estimating treatment effects using experimental data. We focus on the big ideas and provide examples in R.\n\n\n1 What is covariate adjustment?\n“Covariates” are baseline characteristics of your experimental subjects. When you run an experiment, you are primarily interested in collecting data on outcome variables that your intervention may affect, e.g. expenditure decisions, attitudes toward democracy, or contributions for a public good in a lab experiment. But it’s also a good idea to collect data on baseline characteristics of subjects before treatment assignment occurs, e.g. gender, level of education, or ethnic group. If you do this you can explore how treatment effects vary with these characteristics (see 10 Things to Know About Heterogeneous Treatment Effects). But doing this also lets you perform covariate adjustment.\nCovariate adjustment is another name for controlling for baseline variables when estimating treatment effects. Often this is done to improve precision. Subjects’ outcomes are likely to have some correlation with variables that can be measured before random assignment. Accounting for variables like gender will allow you to set aside the variation in outcomes that is predicted by these baseline variables, so that you can isolate the effect of treatment on outcomes with greater precision and power.\nCovariate adjustment can be a cheaper route to improved precision than increasing the number of subjects in the experiment. Partly for that reason, researchers often collect extensive data on covariates before random assignment. Pre-tests (measures that are analogous to the outcome variable but are restricted to time periods before random assignment) may be especially valuable for predicting outcomes, and baseline surveys can ask subjects about other background characteristics.\n\n\n2 Controlling for covariates at the design stage (blocking)\nThe best way to control for covariates is to use block randomization to do it at the design stage even before you start your experiment. Block randomization enables you to create treatment and control groups that are balanced on certain covariates. For example, you might expect that gender and income help predict the outcome variable. Block randomization can ensure that the treatment and control groups have equal proportions of female/high-income, female/low-income, male/high-income, and male/low-income populations. When the blocking variables help predict outcomes, blocking improves precision by preventing chance correlations between treatment assignment and baseline covariates.\nFor more information on blocking and how to implement it in R, see 10 Things You Need to Know About Randomization. The precision gains from blocking (relative to covariate adjustment without blocking) tend to be greatest when sample sizes are small.2\nWhen blocking is done to improve precision, estimated standard errors should take the blocking into account. (Otherwise, the SEs will tend to be conservative because they won’t give you credit for the precision improvement that blocking achieved.) One simple and commonly used method is to regress the outcome on the treatment assignment dummy variable as well as block dummies. When the probability of assignment to treatment is constant across blocks, including the block dummies in the regression doesn’t change the estimated treatment effect, but tends to give a more accurate estimate of the SE.3\nIf the probability of assignment to treatment varies by block, then you need to control for these unequal probabilities in order to get unbiased estimates of average treatment effects. 10 Things You Need to Know About Randomization discusses ways to do this.\n\n\n3 How to do it in a regression\nSometimes you do not have the opportunity to implement a blocked experimental design (for example, if you join a project after random assignment occurs) or you would prefer to simplify your randomization scheme to reduce opportunities for administrative error. You can still adjust for covariates on the back end by using multiple regression. Remember that in a bivariate regression—when you regress your outcome on just your treatment indicator—the coefficient on treatment is just a difference-in-means. This simple method gives an unbiased estimate of the average treatment effect (ATE). When we add baseline covariates that are correlated with outcomes to the model, the coefficient on treatment is an approximately unbiased estimate of the ATE that tends to be more precise than bivariate regression.\nTo adjust for covariates through multiple regression, use the model:\n\\[Y_i = \\alpha + \\beta Z_i + \\gamma X_i + \\epsilon_i\\]\nwhere \\(Y_i\\) is the outcome variable, \\(Z_i\\) is the treatment indicator, and \\(X_i\\) is a vector of one or more covariates. The remainder \\(\\epsilon_i\\) is your disturbance term—the leftover unexplained noise.\nWhen the treatment and control groups are of unequal size, the precision gains from covariate adjustment may be greater if you include interactions between treatment and the covariates (see this blog post for more discussion). For ease of interpretation, recenter the covariates to have zero mean:\n\\[Y_i = \\alpha + \\beta Z_i + \\gamma W_i + \\delta Z_i*W_i + \\epsilon_i\\]\nwhere \\(W_i = X_i - \\overline{X}\\) and \\(\\overline{X}\\) is the mean value of \\(X_i\\) for the entire sample.\nIf subjects receive different probabilities of assignment to treatment based on their covariates, then our estimation method needs to account for this (again, see 10 Things You Need to Know About Randomization for details).\n\n\n4 Why to do it\nIt isn’t absolutely necessary to control for covariates when estimating the average treatment effect in an RCT that assigns every subject the same probability of receiving the treatment. The unadjusted treatment–control difference in mean outcomes is an unbiased estimator of the ATE. However, covariate adjustment tends to improve precision if the covariates are good predictors of the outcome.4\nIn large samples, random assignment tends to produce treatment and control groups with similar baseline characteristics. Still, by the “luck of the draw,” one group may be slightly more educated, or one group may have slightly higher voting rates in previous elections, or one group may be slightly older on average. For this reason, the estimated ATE is subject to “sampling variability,” meaning you’ll get estimates of the ATE that were produced by an unbiased method but happened to miss the mark.5 A high sampling variability contributes to noise (imprecision), not bias.\nControlling for these covariates tends to improve precision if the covariates are predictive of potential outcomes. Take a look at the following example, which is loosely based on the Giné and Mansuri experiment on female voting behavior in Pakistan.6 In this experiment, the authors randomized an information campaign to women in Pakistan to study its effects on their turnout behavior, the independence of their candidate choice, and their political knowledge. They carried out a baseline survey which provided them with several covariates.\nThe following code imitates this experiment by creating fake data for four of the covariates they collect: whether the woman owns an identification card, whether the woman has formal schooling, the woman’s age, and whether the woman has access to TV. It also creates two potential outcomes (the outcomes that would occur if she were assigned to treatment and if not) for a measure of the extent to which a woman’s choice of candidate was independent of the opinions of the men in her family. The potential outcomes are correlated with all four covariates, and the built-in “true” treatment effect on the independence measure here is 1. To figure out whether our estimator is biased or not, we simulate 10,000 replications of our experiment. On each replication, we randomly assign treatment and then regress the observed outcome \\(Y\\) on the treatment indicator \\(Z\\), with and without controlling for covariates. Thus, we are simulating two methods (unadjusted and covariate-adjusted) for estimating the ATE. To estimate the bias of each method, we take the difference between the average of the 10,000 simulated estimates and the “true” treatment effect.\n\nrm(list=ls())\nset.seed(20140714)\nN = 2000\nN.treated = 1000\nReplications = 10000\ntrue.treatment.effect = 1\n# Create pre-treatment covariates\nowns.id.card = rbinom(n = N, size = 1, prob = .18)\nhas.formal.schooling = rbinom(n = N, size = 1, prob = .6)\nage = round(rnorm(n = N, mean = 37, sd = 16))\nage[age<18] = 18\nage[age>65] = 65\nTV.access = rbinom(n = N, size = 1, prob = .7)\nepsilon = rnorm(n = N, mean = 0, sd = 2)\n# Create potential outcomes correlated with pre-treatment covariates\nY0 = round(owns.id.card + 2*has.formal.schooling + 3*TV.access + log(age) + epsilon)\nY1 = Y0 + true.treatment.effect\n# Assign treatment repeatedly\nZ.mat = replicate(Replications, ifelse(1:N %in% sample(1:N, N.treated), 1, 0))\n# Generate observed outcomes\nY.mat = Y1 * Z.mat + Y0 * (1 - Z.mat)\ndiff.in.means = function(Y, Z) {\n  coef(lm(Y ~ Z))[2]\n}\nols.adjust = function(Y, Z) {\n  coef(lm(Y ~ Z + owns.id.card + has.formal.schooling + age + TV.access))[2]\n}\nunadjusted.estimates = rep(NA, Replications)\nadjusted.estimates   = rep(NA, Replications)\nfor (i in 1:Replications) {\n  unadjusted.estimates[i]  =  diff.in.means(Y.mat[,i], Z.mat[,i])\n  adjusted.estimates[i]    =  ols.adjust(Y.mat[,i], Z.mat[,i])\n}\n# Estimated variability (standard deviation) of each estimator\nsd.of.unadj = sd(unadjusted.estimates)\nsd.of.unadj\nsd.of.adj   = sd(adjusted.estimates)\nsd.of.adj\n# Estimated bias of each estimator\nmean(unadjusted.estimates) - true.treatment.effect\nmean(adjusted.estimates) - true.treatment.effect\n# Margin of error (at 95% confidence level) for each estimated bias\n1.96 * sd.of.unadj / sqrt(Replications)\n1.96 * sd.of.adj   / sqrt(Replications)\n\nBoth methods—with and without covariates—yield the true treatment effect of 1 on average. When we ran the regression without covariates, our estimated ATE averaged 1.0008 across the 10,000 replications, and with covariates, it averaged 1.0003. Notice that the regression-adjusted estimate is essentially unbiased even though our regression model is misspecified—we control for age linearly when the true data generating process involves the log of age.7\nThe real gains come in the precision of our estimates. The standard error (the standard deviation of the sampling distribution) of our estimated ATE when we ignore covariates is 0.121. When we include covariates in the model, our estimate becomes a bit tighter: the standard error is 0.093. Because our covariates were prognostic of our outcome, including them in the regression explained some noise in our data so that we could tighten our estimate of ATE.\n\n\n5 When will it help?\nWhen is adjusting for covariates most likely to improve precision?\nCovariate adjustment will be most helpful when your covariates are strongly predictive (or “prognostic”) of your outcomes. Covariate adjustment essentially enables you to make use of information about relationships between baseline characteristics and your outcome so that you can better identify the relationship between treatment and the outcome. But if the baseline characteristics are only weakly correlated with the outcome, covariate adjustment won’t do you much good. The covariates you will want to adjust for are the ones that are strongly correlated with outcomes.\nThe following graph demonstrates the relationship between how prognostic your covariate is and the gains you get from adjusting for it. On the x-axis is the sample size, and on the y-axis is the root mean squared error (RMSE), the square root of the average squared difference between the estimator and the true ATE. We want our RMSE to be small, and covariate adjustment should help us reduce it.\n\nrm(list=ls())\nlibrary(MASS)  # for mvrnorm()\nset.seed(1234567)\nnum.reps = 10000\n# True treatment effect is 0 for every unit\nadj.est = function(n, cov.matrix, treated) {\n    Y.and.X  =  mvrnorm(n, mu = c(0, 0), Sigma = cov.matrix)\n    Y   =  Y.and.X[, 1]  \n    X   =  Y.and.X[, 2]\n    coef(lm(Y ~ treated + X))[2]\n}\nunadj.est = function(n, treated) {\n    Y = rnorm(n)\n    coef(lm(Y ~ treated))[2]\n}\nrmse = function(half.n, rho = 0, control = TRUE) {\n    treated  =  rep(c(0, 1), half.n)\n    n = 2 * half.n\n    if (control) {\n        cov.matrix  =  matrix(c(1, rho, rho, 1), nrow = 2, ncol = 2)\n        return( sqrt(mean(replicate(num.reps, adj.est(n, cov.matrix, treated)) ^ 2)) )\n    }\n    else {\n        return( sqrt(mean(replicate(num.reps, unadj.est(n, treated)) ^ 2)) )\n    }\n}\nhalf.n = c(5, 7, 11, 19, 35, 67, 131)\nn = 2 * half.n \nE  = sapply(half.n, rmse, control = FALSE)\nE0 = sapply(half.n, rmse, rho = 0)\nE1 = sapply(half.n, rmse, rho = 0.5)\nE2 = sapply(half.n, rmse, rho = 0.9)\nplot(n, E, type = \"l\", ylab = \"RMSE\", xlim = c(min(n),max(n)), ylim = c(0,.75))\nlines(n, E0, col = \"yellow\")\nlines(n, E1, col = \"orange\")\nlines(n, E2, col = \"red\")\nlegend(x = 'topright',\n       c(\"No controls\",\n         expression(paste(rho, \"=0\")), expression(paste(rho, \"=0.5\")),\n         expression(paste(rho, \"=0.9\"))),\n         col=c(\"black\", \"yellow\",\"orange\", \"red\"), lty = 1, lwd=2)\n\n\nThe black line shows the RMSE when we don’t adjust for a covariate. The red line shows the RMSE when we adjust for a highly prognostic covariate (the correlation between the covariate and the outcome is 0.9). You can see that the red line is always below the black line, which is to say that the RMSE is lower when you adjust for a prognostic covariate. The orange line represents the RMSE when we adjust for a moderately prognostic covariate (the correlation between the covariate and the outcome is 0.5). We still are getting gains in precision relative to the black line, but not nearly as much as we did with the red line. Finally, the yellow line shows what happens if you control for a covariate that is not at all predictive of the outcome. The yellow line is almost identical to the black line. You received no improvement in precision by controlling for a non-prognostic covariate; in fact, you paid a slight penalty because you wasted a degree of freedom, which is especially costly when the sample size is small. This exercise demonstrates that you’ll get the most gains in precision by controlling for covariates that strongly predict outcomes.\nHow can you know which covariates are likely to be prognostic before launching your experiment? Prior experiments or even observational studies can offer guidance about which baseline characteristics best predict outcomes.\n\n\n6 Control for prognostic covariates regardless of whether they show imbalances\nCovariates should generally be chosen on the basis of their expected ability to help predict outcomes, regardless of whether they show “imbalances” (i.e., regardless of whether there are any noteworthy differences between the treatment group and control group in average values or other aspects of covariate distributions). There are two reasons for this recommendation:\n\nFrequentist statistical inference (standard errors, confidence intervals, p-values, etc.) assumes that the analysis follows a pre-specified strategy. Choosing covariates on the basis of observed imbalances makes it more difficult to obtain inferences that reflect your actual strategy. For example, suppose you choose not to control for gender because the treatment and control groups have similar gender composition, but you would have controlled for gender if there’d been a noticeable imbalance. Typical methods for estimating standard errors will incorrectly assume that you’d never control for gender no matter how much imbalance you saw.\nAdjusting for a highly prognostic covariate tends to improve precision, as we explained above. To receive due credit for this precision improvement, you should adjust for the covariate even if there’s no imbalance. For example, suppose gender is highly correlated with your outcome, but it happens that the treatment group and control group have exactly the same gender composition. In this case, the unadjusted estimate of the ATE will be exactly the same as the adjusted estimate from a regression of the outcome on treatment and gender, but their standard errors will differ. The SE of the unadjusted estimate tends to be larger because it assumes that even if the treatment and control groups had very different gender compositions, you’d still use the unadjusted treatment–control difference in mean outcomes (which would likely be far from the true ATE in that case). If you pre-specify that you’ll adjust for gender regardless of how much or how little imbalance you see, you’ll tend to get smaller SEs, tighter confidence intervals, and more powerful significance tests.\n\nAssuming that random assignment was implemented correctly, should examination of imbalances play any role in choosing which covariates to adjust for? Here’s a sampling of views:\n\nMutz, Pemantle, and Pham (2016) argue that, unless there is differential attrition, the practice of selecting covariates on the basis of observed imbalances is “not only unnecessary” but “not even helpful … and may in fact be damaging,” because it invalidates confidence intervals, worsens precision (relative to pre-specified adjustment for prognostic covariates), and opens the door to fishing.8\nPermutt (1990), using theory and simulations to study specific scenarios, finds that when a balance test is used to decide whether to adjust for a covariate, the significance test for the treatment effect is conservative (i.e., it has a true Type I error probability below its nominal level). He writes, “Greater power can be achieved by always adjusting for a covariate that is highly correlated with the response regardless of its distribution between groups.” However, he doesn’t completely rule out considering observed imbalances: “Choosing covariates on the basis of the difference between the means in the treatment and control groups is not irrational. After all, some type I errors may be more serious than others. Reporting a significant difference in outcome which can be explained away as the effect of a covariate may be a more embarrassing error than reporting one that happens to go away on replication but without an easy explanation. Similar considerations may apply to type II errors. A positive result that depends on adjustment for a covariate may be seen as less convincing than a positive two-sample test anyway, so that the error of failing to draw such a positive conclusion may be less serious. These justifications, however, come from outside the formal theory of testing hypotheses.”9\nAltman (2005) writes, “It seems far preferable to choose which variables to adjust for without regard to the actual data set to hand.” He recommends controlling for highly prognostic covariates, as well as any that were used in blocking. However, he also discusses a dilemma: “In practice, imbalance may arise when the possible need for adjustment has not been anticipated. What should the researchers do? They might choose to ignore the imbalance; as noted, this would be entirely proper. The difficulty then is one of credibility. Readers of their paper (including reviewers and editors) may question whether the observed finding has been influenced by the unequal distribution of one or more baseline covariates. It is still possible, and arguably advisable, to carry out an adjusted analysis, but now with the explicit acknowledgment that this is an exploratory rather than definitive analysis, and that the unadjusted analysis should be taken as the primary one. Obviously, if the simple and adjusted analyses yield substantially the same result, then there is no difficulty of interpretation. This will usually be the case. However, if the results of the two analyses differ, then there is a real problem. The existence of such a discrepancy must cast some doubt on the veracity of the overall (unadjusted) result. The situation is similar to the difficulties of interpretation that arise with unplanned subgroup comparisons. One suggestion in such circumstances is to try to mimic what would have been done if the problem had been anticipated, namely to adjust not for variables that are observed to be unbalanced, but for all variables that would have been identified in advance as prognostic. An independent source could be used to identify such variables. Alternatively, the trial data could be used to determine which variables are prognostic. This strategy too could be prespecified in the study protocol. Because this analysis would be performed conditionally on the observed imbalance, it does not remove bias and thus cannot be considered fully satisfactory.”10\nTukey (1991) notes that observed imbalances may justify adjustment as a robustness check: Although “most statisticians” would accept an analysis of a randomized clinical trial that doesn’t adjust for covariates, “Some clinicians, and some statisticians it would seem, would like to be more sceptical, (perhaps as a supplemental analysis) asking for an analysis that takes account of observed imbalances in these recorded covariates. Feeling more secure about the results of such an analysis is indeed appropriate, since the degree of protection against either the consequences of inadequate randomization or the (random) occurrence of an unusual randomization is considerably increased by adjustment. Greater security, rather than increased precision … will often be the basic reason for covariance adjustment in a randomized trial. … The main purpose of allowing [adjusting] for covariates in a randomized trial is defensive: to make it clear that analysis has met its scientific obligations.”11\nSome statisticians argue that our inferences should be conditional on a measure of covariate imbalance—in other words, when assessing the bias, variance, and mean squared error of a point estimate or the coverage probability of a confidence interval, instead of considering all possible randomizations, it may be more relevant to consider only those randomizations that would yield a covariate imbalance similar to the one we observe. From this perspective, observed imbalances may be relevant to the choice of estimator.12\nLin, Green, and Coppock (2016) write: “Covariates should generally be chosen on the basis of their expected ability to help predict outcomes, regardless of whether they appear well-balanced or imbalanced across treatment arms. But there may be occasions when the covariate list specified in the PAP [pre-analysis plan] omitted a potentially important covariate (due to either an oversight or the need to keep the list short when N is small) with a nontrivial imbalance. Protection against ex post bias (conditional on the observed imbalance) is then a legitimate concern.” However, they recommend that if observed imbalances are allowed to influence the choice of covariates, “the balance checks and decisions about adjustment should be finalized before we see unblinded outcome data,” “the direction of the observed imbalance (e.g., whether the treatment group or the control group appears more advantaged at baseline) should not be allowed to influence decisions about adjustment,” and the originally pre-specified estimator should “always be reported and labeled as such, even if alternative estimates are also reported.”13\n\n\n\n7 When not to do it\nIt is a bad idea to adjust for covariates when you think those covariates could have been influenced by your treatment. This is one of the reasons that many covariates are collected from baseline surveys; sometimes covariates that are collected from surveys after intervention could reflect the effects of the treatment rather than underlying characteristics of the subject. Adjusting for covariates that are affected by the treatment—“post-treatment” covariates—can cause bias.\nSuppose, for example, that Giné and Mansuri had collected data on how many political rallies a woman attended after receiving the treatment. In estimating the treatment effect on independence of political choice, you may be tempted to include this variable as a covariate in your regression. But including this variable, even if it strongly predicts the outcome, may distort the estimated effect of the treatment.\nLet’s create this fake variable, which is correlated (like the outcome measure) with baseline covariates and also with treatment. Here, by construction, the treatment effect on number of political rallies attended is 2. When we included the rallies variable as a covariate, the estimated average treatment effect on independence of candidate choice averaged 0.54 across the 10,000 replications. Recall that the true treatment effect on this outcome is 1. This is severe bias, all because we controlled for a post-treatment covariate!14 This bias results from the fact that the covariate is correlated with treatment.\n\n# Create post-treatment covariate that's correlated with pre-treatment covariates\nrallies0 = round(.5*owns.id.card + has.formal.schooling + 1.5*TV.access + log(age))\nrallies1 = rallies0 + 2\nrallies.mat = rallies1 * Z.mat + rallies0 * (1-Z.mat)\n \n# Estimate ATE with new model that includes the post-treatment covariate\nadjust.for.post = function(Y, Z, X) {\n  coef(lm(Y ~ Z + X + owns.id.card + has.formal.schooling + age + TV.access))[2]\n}\npost.adjusted.estimates = rep(NA, Replications)\nfor (i in 1:Replications) {\n  post.adjusted.estimates[i]  =  adjust.for.post(Y.mat[,i], Z.mat[,i], rallies.mat[,i])\n}\n# Estimated bias of the new estimator\nmean(post.adjusted.estimates) - true.treatment.effect\n# Margin of error (at 95% confidence level) for the estimated bias\n1.96 * sd(post.adjusted.estimates) / sqrt(Replications)\n\nJust because you should not adjust for post-treatment covariates does not mean you cannot collect covariate data post-treatment, but you must exercise caution. Some measures could be collected post-treatment but are unlikely to be affected by treatment (e.g., age and gender). Be careful about measures that may be subject to evaluation-driven effects, though: for example, treated women may be more acutely aware of the expectation of political participation and may retrospectively report that they were more politically active than they actually were several years prior.\n\n\n8 Concerns about small-sample bias\nIn small samples, regression adjustment may produce a biased estimate of the average treatment effect.15 Some simulations have suggested that this bias tends to be negligible when the number of randomly assigned units is greater than twenty.16 If you’re working with a small sample, you may want to use an unbiased covariate adjustment method such as post-stratification (splitting the sample into subgroups based on the values of one or more baseline covariates, computing the treatment–control difference in mean outcomes for each subgroup, and taking a weighted average of these subgroup-specific treatment effect estimates, with weights proportional to sample size).17\n\n\n9 How to make your covariate adjustment decisions transparent\nIn the interests of transparency, if you adjust for covariates, pre-specify your models and report both unadjusted and covariate-adjusted estimates.\nThe simulations above have demonstrated that results may change slightly or not-so-slightly depending on which covariates you choose to include in your model. We’ve highlighted some rules of thumb here: include only pre-treatment covariates that are predictive of outcomes. Deciding which covariates to include, though, is often a subjective rather than an objective enterprise, so another rule of thumb is to be totally transparent about your covariate decisions. Always include the simplest model—the simple regression of outcome on treatment without controlling for covariates—in your paper or appendix to supplement the findings of your model including covariates.\nAnother way to minimize your readers’ concern that you went fishing for the particular combination of covariates that gave results favorable to your hypotheses is to pre-specify your models in a pre-analysis plan.18 This gives you the opportunity to explain before you see the findings which pre-treatment covariates you expect to be predictive of the outcome. You can even write these regressions out in R using fake data, as done here, so that when your results from the field arrive, all you need to do is run your code on the real data. These efforts are a useful way of binding your own hands as a researcher and improving your credibility.\n\n\n10 Covariates can help you investigate the integrity of the random assignment\nSometimes it is unclear whether random assignment actually occurred (or whether it occurred using the procedure that the researcher envisions). For example, when scholars analyze naturally occurring random assignments (e.g., those conducted by a government agency), it is useful to assess statistically whether the degree of imbalance between the treatment and control groups is within the expected margin of error. One statistical test is to regress treatment assignment on all of the covariates and calculate the F-statistic. The significance of this statistic can be assessed by simulating a large number of random assignments and for each one calculating the F-statistic; the resulting distribution can be used to calculate the p-value of the observed F-statistic. For example, if 10,000 simulations are conducted, and just 30 simulations generate an F-statistic larger than what one actually obtained from the data, the p-value is 0.003, which suggests that the observed level of imbalance is highly unusual. In such cases, one may wish to investigate the randomization procedure more closely.\n\n\nFor further reading\nAthey, Susan, and Guido W. Imbens (2017). “The Econometrics of Randomized Experiments.” In Handbook of Economic Field Experiments, vol. 1 (E. Duflo and A. Banerjee, eds.). arXiv DOI\nGerber, Alan S., and Donald P. Green (2012). Field Experiments: Design, Analysis, and Interpretation, chapter 4.\nHennessy, Jonathan, Tirthankar Dasgupta, Luke Miratrix, Cassandra Pattanayak, and Pradipta Sarkar (2016). “A Conditional Randomization Test to Account for Covariate Imbalance in Randomized Experiments.” Journal of Causal Inference 4: 61–80.\nJudkins, David R., and Kristin E. Porter (2016). “Robustness of Ordinary Least Squares in Randomized Clinical Trials.” Statistics in Medicine 35: 1763–1773.\nLin, Winston (2012). “Regression Adjustment in Randomized Experiments: Is the Cure Really Worse than the Disease?” Development Impact blog post, part I and part II.\nRaudenbush, Stephen W. (1997). “Statistical Analysis and Optimal Design for Cluster Randomized Trials.” Psychological Methods 2: 173–185.\nWager, Stefan, Wenfei Du, Jonathan Taylor, and Robert Tibshirani (2016). “High-Dimensional Regression Adjustments in Randomized Experiments.” Proceedings of the National Academy of Sciences 113: 12673–12678. arXiv DOI\n\n\n\n\n\nFootnotes\n\n\nOriginating author: Lindsay Dolan. Revisions: Don Green and Winston Lin, 1 Nov 2016. The guide is a live document and subject to updating by EGAP members at any time; contributors listed are not responsible for subsequent edits. Thanks to Macartan Humphreys and Diana Mutz for helpful discussions.↩︎\nMiratrix, Luke W., Jasjeet S. Sekhon, and Bin Yu (2013). “Adjusting Treatment Effect Estimates by Post-Stratification in Randomized Experiments.” Journal of the Royal Statistical Society, Series B 75: 369–396.↩︎\nSee, e.g., pages 217–219 of Miriam Bruhn and David McKenzie (2009), “In Pursuit of Balance: Randomization in Practice in Development Field Experiments,” American Economic Journal: Applied Economics 1 (4): 200–232.↩︎\nA brief review of bias and precision: Imagine replicating the experiment many times (without changing the experimental sample and conditions, but re-doing random assignment each time). An unbiased estimator may overestimate or underestimate the ATE on any given replication, but its expected value (the average over all possible replications) will equal the true ATE. We usually prefer unbiased or approximately unbiased estimators, but we also value precision (which is formally defined as the inverse of the variance). Imagine you’re throwing a dart at a dartboard. If you hit the center of the dartboard on average but your shots are often far from the mark, you have an unbiased but imprecise estimator. If you hit close to the center every time, your estimator is more precise. A researcher may choose to accept a small bias in return for a large improvement in precision. One possible criterion for evaluating estimators is the mean squared error, which equals the variance plus the square of the bias. See, e.g., Sharon Lohr (2010), Sampling: Design and Analysis, 2nd ed., pp. 31–32.↩︎\n“Sampling variability” refers to the spread of estimates that will be produced just because of the different random assignments that could have been drawn. When the luck of the draw of random assignment produces a treatment group with more As and a control group with more Bs, it is more difficult to separate background characteristics (A and B) from treatment assignment as the predictor of the observed outcomes.↩︎\nGiné, Xavier, and Ghazala Mansuri (2012). “Together We Will: Experimental Evidence on Female Voting Behavior in Pakistan.”↩︎\nThe estimated bias is 0.0003 with a margin of error (at the 95% confidence level) of 0.0018.↩︎\nDiana C. Mutz, Robin Pemantle, and Philip Pham (2016), “Model Choice in Experimental Design: Messy Analyses of Clean Data.”↩︎\nThomas Permutt (1990), “Testing for Imbalance of Covariates in Controlled Experiments,” Statistics in Medicine 9: 1455–1462.↩︎\nDouglas G. Altman (2005), “Covariate Imbalance, Adjustment for,” in Encyclopedia of Biostatistics.↩︎\nJohn W. Tukey (1991), “Use of Many Covariates in Clinical Trials,” International Statistical Review 59: 123–137. Italics in the original.↩︎\nSee, e.g.: D. R. Cox and N. Reid (2000), The Theory of the Design of Experiments, pp. 29–32; D. Holt and T. M. F. Smith (1979), “Post Stratification,” Journal of the Royal Statistical Society, Series A (General) 142: 33–46; Richard M. Royall (1976), “Current Advances in Sampling Theory: Implications for Human Observational Studies,” American Journal of Epidemiology 104: 463–474. For an introduction to philosophical disagreements about statistical inference, see Bradley Efron (1978), “Controversies in the Foundations of Statistics,” American Mathematical Monthly 85: 231–246.↩︎\nWinston Lin, Donald P. Green, and Alexander Coppock (2016), “Standard Operating Procedures for Don Green’s Lab at Columbia,” version 1.05, June 7. Italics in the original.↩︎\nThe estimated bias is \\(-\\) 0.459 with a margin of error (at the 95% confidence level) of 0.002.↩︎\nDavid A. Freedman (2008), “On Regression Adjustments in Experiments with Several Treatments,” Annals of Applied Statistics 2: 176–196. See also Winston Lin’s blog posts (part I and part II) discussing his response to Freedman.↩︎\nGreen, Donald P. and Aronow, Peter M., Analyzing Experimental Data Using Regression: When Is Bias a Practical Concern? (March 7, 2011). Working paper: http://ssrn.com/abstract=1466886↩︎\nMiratrix, Sekhon, and Yu (2013), cited above.↩︎\nFor more discussion of pre-analysis plans, see, e.g., Benjamin A. Olken (2015), “Promises and Perils of Pre-Analysis Plans,” Journal of Economic Perspectives 29 (3): 61–80.↩︎"
  },
  {
    "objectID": "guides/getting-started/design_en.html",
    "href": "guides/getting-started/design_en.html",
    "title": "10 Things to Know About Survey Design",
    "section": "",
    "text": "Surveys are the most frequently-used tool for collecting experimental data in social science research, and the design of these surveys can have a profound effect on the conclusions we draw about the treatments we study. Therefore, the stakes are high when designing surveys around your experimental projects.\nAt a minimum, all that is needed to estimate a treatment effect after an experiment has been conducted is a measure of the outcome, collected after the treatment has been delivered, with a sufficient number of observations across the treatment and control groups. If time and budget allow, baseline surveys, conducted before the implementation of an experiment, serve important functions as well and can improve analysis greatly.\n\n\nBaseline surveys should produce data that describe the experimental subject population as they were before the treatment is delivered. This is accomplished through the measurement of covariates, which are observed pre-treatment characteristics of experimental subjects. Using covariate data you can: 1) describe the subject population, 2) improve the precision with which you estimate treatment effects, 3) report balance, and 4) estimate heterogeneous treatment effects.\n\n\n\nCovariates improve the precision with which you can estimate treatment effects by reducing variance in three ways; covariates can be used to rescale your dependent variable, as controls when using regression to estimate treatment effects, and to construct blocks in order to conduct blocked random assignment.1 In order for covariate data to be used to reduce variance in our estimates of treatment effects, they need to be unaffected by treatment assignment, i.e. collected sometime before treatment is delivered. See the guide on covariate adjustment for more about how to use covariate data.\nThe greater the predictive power of included covariates, the greater increase in the power of your design and the precision with which you can estimate effects. If you believe covariates will likely predict outcomes in your experiment, then that is grounds to include them in your survey. For example, if the intervention involves providing a service at a cost to treated users, income will likely explain some variation in outcomes and is therefore a useful covariate to measure at the baseline stage.\nBecause pre-treatment covariates can improve precision, conducting a baseline becomes more important when the sample size is limited.\nCovariates also allow you to conduct sub-group analyses. Heterogeneous effects are not causal, and so interpretation is limited. Still, understanding how treatment effects vary by subejcts’ attributes can provide you with important clues about mechanisms. The implication for design is to include covariates for which you would like to report heterogeneous effects. Covariate data will also be used to show “balance”, or the extent to which the treatment and control populations resemble each other. Although random assignment alone ensures that outcomes across the treatment and control group are in expectation the same, it is standard practice to show that random assignment resulted in two groups that are “balanced” on covariates of interest. If, for example, the treatment group included 25% more men than the control group, we might worry that random assignment failed in some way. Collecting pre-treatment covariate data allows us to evaluate and report balance.\n\n\n\nThe baseline provides an opportunity to measure the outcome before the experiment was conducted, later allowing you to use change scores as your outcome and the difference-in-differences estimator. The difference-in-differences estimator will improve precision only when a covariate strongly predicts outcomes.2\n\n\n\nEndline surveys, conducted after the treatment is delivered, are primarily used to measure outcomes. Including questions about implementation can improve analysis and interpretation greatly.\nSurveys conducted after treatments are delivered are one way to understand if there were compliance issues or other implementation issues that may have consequences for analysis. Survey data can help to determine the scope of non-compliance with the assigned treatment, and the underlying causes. This is an opportunity to ask subjects directly about reasons for noncompliance. Subjects may have understood the treatment differently than the researchers, and survey data can be used to both show this and speculate why this may have happened.\nIn the endline, you can learn about spillover by asking subjects in the control condition about their knowledge and access to the treatment. Interviews with treated subjects are useful for understanding spillover as well, because survey data can be used to understand the networks through which the treatment could have “spilled-over” into the control group.\nDescribing the population is important here as well, but covariate data collected after implementation are less useful for improving precision. Ordinarily, covariates collected after treatment assignment are considered suspect, as they could conceivably be affected by treatment.\n\n\n\n\n\n\n\nBaseline checklist\nEndline checklist\n\n\n\n\nWill your data allow you to:\nWill your data allow you to:\n\n\n• Describe the population\n• Estimate effects\n\n\n• Adjust treatment effect estimates (are the covariates included likely to be prognostic of outcomes?)\n• Assess if spillover occurred, or if there was interference\n\n\n• Estimate heterogeneous treatment effects\n• Measure non-compliance (and the reasons for non-compliance if it occurred)\n\n\n• Design a blocked randomization procedure\n• Look for causal mechanisms (how are effects transmitted?)\n\n\n• Describe balance across treatment and control conditions"
  },
  {
    "objectID": "guides/getting-started/design_en.html#gathering-behavioral-data-doesnt-have-to-be-expensive.-here-is-how-to-develop-low-cost-measures",
    "href": "guides/getting-started/design_en.html#gathering-behavioral-data-doesnt-have-to-be-expensive.-here-is-how-to-develop-low-cost-measures",
    "title": "10 Things to Know About Survey Design",
    "section": "Gathering behavioral data doesn’t have to be expensive. Here is how to develop low-cost measures:",
    "text": "Gathering behavioral data doesn’t have to be expensive. Here is how to develop low-cost measures:\n\nBrainstorm a set of actions that subjects would do if the treatment had had an effect or would not do in the case that the treatment did not have an effect. It also works to think about behavior on a continuum—i.e., what would people be more likely to do if affected, and less likely to do if not? Local context matters a lot here; rely on your enumerators, local survey staff, or implementation partners to help you think through a set of possibilities. One nice way to think about this is to challenge yourself to think about “hints.” In the above example, we might think about a group of opposition activists wearing wristbands publicly as a “hint” that people are more likely to take risks. Keep in mind your eventual audience: what behaviors are frequently tracked in the literature you hope to speak to?\nIsolate the set of behaviors that are feasible to measure. This will most likely be the set of behaviors that can be immediately observed by the enumerator and involve minimal materials. What is the least expensive or costly action that would be associated with the behavioral change you want to detect?\nIdeally, pre-test the measures either with the rest of your survey, or in smaller focus groups. Learning why respondents did or did not behave a certain way will increase confidence in your results."
  },
  {
    "objectID": "guides/getting-started/design_en.html#how-do-you-construct-questions-that-accomplish-these-goals",
    "href": "guides/getting-started/design_en.html#how-do-you-construct-questions-that-accomplish-these-goals",
    "title": "10 Things to Know About Survey Design",
    "section": "How do you construct questions that accomplish these goals?",
    "text": "How do you construct questions that accomplish these goals?\n\nUse the simplest possible form of each question, using the most widely-understood words. Avoid jargon or technical terms, and be straightforward and brief.\nBe specific, such that if the question were to be lifted from the section and asked without context you would get the same response.\nIt helps to begin the question by providing a context. For example, you can prime a time period (“Thinking of the last year: has your income been better, the same, or worse?”), or a place (“Thinking of people in this village: have people earned more or less this year as compared to last year?”)\nAvoid measuring multiple things at once. For example, the following question measures attitudes about both the president and government concurrently, making it difficult to draw a clear conclusion from the data: “Do you think the president and the government are doing a good job in terms of protecting basic freedoms?”\nWhen constructing response categories, be as comprehensive as possible. Include all possible responses. You don’t want to record a lot of “don’t know” responses and miss important information. See below for a discussion of scales.\nKeep in mind the concerns with social desirability discussed above; the wording of the question shouldn’t lead the respondent towards a certain response."
  },
  {
    "objectID": "guides/getting-started/effect-types_en.html",
    "href": "guides/getting-started/effect-types_en.html",
    "title": "10 Types of Treatment Effect You Should Know About",
    "section": "",
    "text": "Abstract\nThis guide1 describes ten distinct types of causal effects that researchers may want to estimate. As discussed in our guide 10 Things to Know About Causal Inference, simple randomization allows one to produce estimates of the average of the unit level causal effects in a sample. This average causal effect or average treatment effect (ATE) is a powerful concept because it is one solution to the problem of not observing all relevant counterfactuals. Yet, it is not the only productive engagement with this problem. In fact, there are many different types of quantities of causal interest. The goal of this guide is to help you choose estimands (a parameter of interest) and estimators (procedures for calculating estimates of those parameters) that are appropriate and meaningful for your data.\n\n\n1 Average Treatment Effects\nWe begin by reviewing how, with randomization, a simple difference-of-means provides an unbiased estimate of the ATE. We take extra time to introduce some common statistical concepts and notation used throughout this guide.\nFirst we define a treatment effect for an individual observation (a person, household, city, etc.) as the difference between that unit’s behavior under treatment \\((Y_{i}(1))\\) and control \\((Y_{i}(0))\\):\n\\[τ_{i}=Y_{i}(1)−Y_{i}(0)\\]\nSince we can only observe either \\(Y_{i}(1)\\) or \\(Y_{i}(0)\\) the individual treatment effect is unknowable. A quantity that we can learn about, however, is the average treatment effect (ATE) across all observations in our experiment:\n\\[ATE≡\\frac{1}{N}∑^{N}_{i=1}τ_{i}=\\frac{∑^{N}_{1}Y_{i}(1)}{N}−\\frac{∑^{N}_{1}Y_{i}(0)}{N}\\]\nLet \\(D_{i}\\) be an indicator for whether we observe an observation under treatment or control. If treatment is randomly assigned, \\(D_{i}\\) is independent, not only of potential outcomes but also of any covariates (observed and unobserved) that might predict those outcomes \\(((Y_{i}(1),Y_{i}(0),X_{i}⊥⊥D_{i}))\\).2\nSuppose our design involves \\(m\\) units under treatment and \\(N−m\\) under control. Suppose we were to repeatedly reassign treatment at random many times and each time calculate the difference of means between treated and control groups and then to record this value in a list. In other words, for every repetition, we produce an estimate of the ATE using the the observed difference in means:3\n\\[\\widehat{ATE} =\\frac{∑^m_1Z_{i}Y_{i}}{m}−\\frac{∑^{N}_{m+1}(1−Z_{i})Y_{i}}{N−m}\\]\nThe average of the estimates in our list will be the same as the difference of the means of the true potential outcomes had we observed the full schedule of potential outcomes for all observations. That is \\(E(Y_i(1)|D=1)=E(Y_i(1)|D=0)=E(Y_i(1))\\) and \\(E(Y_i(0)|D=1)=E(Y_i(0)|D=0)=E(Y_i(0))\\). Another way to state this characteristic of the average treatment effect and its estimator is to say that the difference of observed means is an unbiased estimator of the average treatment effect.\nStatistical inference about the estimated ATE requires that we know how it will vary across randomizations. It turns out that we can write the variance of the ATE across randomizations as follows:\n\\[V(ATE) = \\frac{N}{N−1} [\\frac{V(Y_{i}(1))}{m}+\\frac{V(Y_{i}(0))}{N−m}]−\\frac{1}{N−1}[V(Y_{i}(1))+V(Y_{i}(0))−2∗Cov(Y_{i}(1),Y_{i}(0))]\\]\nand estimate this quantity from the sample estimates of the variance in each group.4\nA linear model regressing the observed outcome \\(Y_{i}\\) on a treatment indicator \\(D_{i}\\) provides a convenient estimator of the ATE (and with some additional adjustments, the variance of the ATE):\n\\[Y_{i}=Y_{i}(0)∗(1−D_{i})+Y_{i}(1)∗D_{i}=β_{0}+β_{1}D_{i}+u\\]\nsince we can rearrange terms so that \\(β_{0}\\) estimates the average among control observations \\((Y_{i}(0)∣D_{i}=0)\\) and \\(β_{1}\\) estimates the differences of means \\((Y_{i}(1)∣D_{i}=1)–(Y_{i}(1)∣D_{i}=0)\\). In the code below, we create a sample of 1,000 observations and randomly assign a treatment \\(D_i\\) with a constant unit effect to half of the units. We estimate the ATE using ordinary least squares (OLS) regression to calculate the observed mean difference. Calculating the means in each group and taking their difference would also produce an unbiased estimate of the ATE. Note that the estimated ATE from OLS is unbiased, but the errors in this linear model are assumed to be independent and identically distributed. When our treatment effects both the average value of the outcome and the distribution of responses, this assumption no longer holds and we need to adjust the standard errors from OLS using a Huber-White sandwich estimator to obtain the correct estimates (based on the variance of the ATE) for statistical inference.5 Finally, we also demonstrate the unbiasedness of these estimators through simulation.\n\nset.seed(1234) # For replication\nN = 1000 # Population size\nY0 = runif(N) # Potential outcome under control condition\nY1 = Y0 + 1 # Potential outcome under treatment condition\nD = sample((1:N)%%2) # Treatment: 1 if treated, 0 otherwise\nY = D*Y1 + (1-D)*Y0 # Outcome in population\nsamp = data.frame(D,Y)\nATE = coef(lm(Y~D,data=samp))[2] #same as with(samp,mean(Y[Z==1])-mean(Y[Z==0]))\n# SATE with Neyman/Randomization Justified Standard Errors\n# which are the same as OLS standard errors when no covariates or blocking\nlibrary(lmtest)\nlibrary(sandwich)\nfit<-lm(Y~D,data=samp)\ncoef(summary(fit))[\"D\",1:2]\n\n  Estimate Std. Error \n1.01820525 0.01841784 \n\nATE.se<-coeftest(fit,vcovHC(fit,type=\"HC2\"))[\"D\",2]\n# same as with(samp,sqrt(var(Y[D==1])/sum(D)+var(Y[D==0])/(n-sum(D)))\n# Assess unbiasedness and simulate standard errors\ngetATE<-function() {\n  D = sample((1:N)%%2) # Treatment: 1 if treated, 0 otherwise\n  Y = D*Y1 + (1-D)*Y0\n  coef(lm(Y~D))[[\"D\"]]\n}\nmanyATEs<-replicate(10000,getATE())\n## Unbiasedness:\nc(ATE=mean(Y1)-mean(Y0), ExpEstATE=mean(manyATEs))\n\n      ATE ExpEstATE \n1.0000000 0.9999077 \n\n## Standard Error\n### True SE formula\nV<-var(cbind(Y0,Y1))\nvarc<-V[1,1]\nvart<-V[2,2]\ncovtc<-V[1,2]\nn<-sum(D)\nm<-N-n\nvarestATE<-((N-n)/(N-1))*(vart/n) + ((N-m)/(N-1))* (varc/m) + (2/(N-1)) * covtc\n### Compare SEs\nc(SimulatedSE= sd(manyATEs), TrueSE=sqrt(varestATE), ConservativeSE=ATE.se)\n\n   SimulatedSE         TrueSE ConservativeSE \n    0.01835497     0.01842684     0.01841784 \n\n\n\n\n2 Conditional Average Treatment Effects\nThe problem with looking at average treatment effects only is that it takes attention away from the fact that treatment effects might be very different for different sorts of people. While the “fundamental problem of causal inference” suggests that measuring causal effects for individual units is impossible, making inferences on groups of units is not.\nRandom assignment ensures that treatment is independent of potential outcomes and any (observed and unobserved) covariates. Sometimes, however, we have additional information about the experimental units as they existed before the experiment was fielded, say \\(X_{i}\\), and this information can can help us understand how treatment effects vary across subgroups. For example, we may suspect that men and women respond differently to treatment, and we can test for this hetorogeneity by estimating conditional ATE for each subgroup separately \\((CATE=E(Y_{i}(1)−Y_{i}(0)∣D_{i},X_{i}))\\). If our covariate is continous, we can test its moderating effects by interacting the continous variable with the treatment. Note, however, that the treatment effect is now conditional on both treatment status and the value of the conditioning variable at which the effect is evaluated and so we must adjust our interpretation and standard errors accordingly.6\nA word of warning: looking at treatment effects across dimensions that are themselves affected by treatment is a dangerous business and can lead to incorrect inferences. For example if you wanted to see how administering a drug led to health improvements you could run separate analyses for men and women, but you could not run separate analyses for those who in fact took the drug and those who did not (this is an example of inference for compliers which requires separate techniques described in point 4 below).\n\n\n3 Intent-to-Treat Effects\nOutside of a controlled laboratory setting, the subjects we assign to treatment often are not the same as the subjects who actually receive the treatment. When some subjects assigned to treatment fail to receive it, we call this an experiment with one-sided non-compliance. When additionally, some subjects assigned to control also receive the treatment, we say there is two-sided non-compliance. For example, in a get-out-the-vote experiment, some people assigned to receive a mailer may not receive it. Perhaps they’ve changed addresses or never check their mail. Similarly, some observations assigned to control may receive the treatment. Perhaps they just moved in, and the previous tenant’s mail is still arriving.\nWhen non-compliance occurs, the receipt of treatment is no longer independent of potential outcomes and confounders. The people who actually read their mail probably differ in a number of ways from the people who throw their mail away (or read their neighbors’ mail) and these differences likely also affect their probability of voting. The difference-of-means between subjects assigned to treatment and control no longer estimates the ATE, but instead estimates what is called an intent-to-treat effect (ITT). We often interpret the ITT as the effect of giving someone the opportunity to receive treatment. The ITT is particularly relevant then for assessing programs and interventions with voluntary participation.\nIn the code below, we create some simple data with one-sided non-compliance. Although the true treatment effect for people who actually received the treatment is 2, our estimated ITT is smaller (about 1) because only some of the people assigned to treatment actually receive it.\n\nset.seed(1234) # For replication\nn = 1000 # Population size\nY0 = runif(n) # Potential outcome under control condition\nC = sample((1:n)%%2) # Whether someone is a complier or not\nY1 = Y0 + 1 +C # Potential outcome under treatment\nZ = sample((1:n)%%2) # Treatment assignment\nD = Z*C # Treatment Uptake\nY = D*Y1 + (1-D)*Y0 # Outcome in population\nsamp = data.frame(Z,Y)\nITT<-coef(lm(Y~Z,data=samp))[2]\n\n\n\n4 Complier Average Treatment Effects\nWhat if you are interested in figuring out the effects of a treatment on those people who actually took up the treatment and not just those people that were administered the treatment? For example what is the effect of radio ads on voting behavior for those people that actually hear the ads?\nThis turns out to be a hard problem (for more on this see our guide 10 Things to Know About the Local Average Treatment Effect). The reasons for non-compliance with treatment can be thought of as an omitted variable. While the receipt of treatment is no longer independent of potential outcomes, the assignment of treatment status is. As long as random assignment had some positive effect on the probability of receiving treatment, we can use it as an instrument to identify the effects of treatment on the sub-population of subjects who comply with treatment assignment.\nFollowing the notation of Angrist and Pischke,7 let \\(Z\\) be an indicator for whether an observation was assigned to treatment and \\(D_{i}\\) indicates whether that subject actually received the treatment. Experiments with non-compliance are composed of always-takers (\\(D_{i}=1\\), regardless of \\(Z_{i}\\)), never-takers (\\(D_{i}=0\\) regardless of \\(Z_{i}\\)), and compliers (\\(D_{i}=1\\) when \\(Z_{i}=1\\) and \\(0\\) when \\(Z_{i}=0\\)).8 We can estimate a complier average causal effect (CACE), sometimes also called a local average treatment effect (LATE), by weighting the ITT (the effect of \\(Z\\) on \\(Y\\)) by the effectiveness of random assignment on treatment uptake (the effect of \\(Z\\) on \\(D\\)).\n\\[CACE= \\frac{Effect of Z on Y}{Effect of Z on D}=\\frac{E(Y_i∣Z_i=1)-E(Y_i|Z_i=0)}{E(D_i|Z_i=1)-E(D_i|Z_i=0)}\\]\nThe estimator above highlights the fact that the ITT and CACE converge as we approach full compliance. Constructing standard errors for ratios is somewhat cumbersome and so we usually estimate a CACE using two-stage-least-squares regression with random assignment, \\(Z_i\\), serving as instrument for treatment receipt \\(D_i\\) in the first stage of the model. This approach simplifies the estimation of standard errors and allows for the inclusion of covariates as additional instruments. We demonstrate both strategies in the code below for data with two-sided non-compliance. Note, however, that when instruments are weak (e.g. random assignment had only a small effect on the receipt of treatment), instrumental variable estimators and their standard errors can be biased and inconsistent.9\n\nset.seed(1234) # For replication\nn = 1000 # Population size\nY0 = runif(n) # Potential outcome under control condition\nY1 = Y0 + 1 # Potential outcome under treatment\nZ = sample((1:n)%%2) # Treatment assignment\npD<-pnorm(-1+rnorm(n,mean=2*Z)) # Non-compliance\nD<-rbinom(n,1,pD) # Treatment receipt with non-compliance\nY = D*Y1 + (1-D)*Y0 # Outcome in population\nsamp = data.frame(Z,D,Y)\n# IV estimate library(AER) CACE = coef(ivreg(Y ~ D | Z, data = samp))[2]\n# Wald Estimator ITT<-coef(lm(Y~Z,data=samp))[2] ITT.D<-coef(lm(D~Z,data=samp))[2] CACE.wald<-ITT/ITT.D\n\n\n\n5 Population and Sample Average Treatment Effects\nOften we want to generalize from our sample to make statements about some broader population of interest.10 Let \\(S_i\\) be an indicator for whether an subject is in our sample. The sample average treatment effect (SATE) is defined simply as \\(E(Y_i(1)−Y_i(0)|S_i=1)\\) and the population \\(E(Y_i(1)−Y_i(0))\\). With a large random sample from a well-defined population with full compliance with treatment, our SATE and PATE are equal in expectation and so a good estimate for one (like a difference of sample means) will be a good estimate for the other.11\nIn practice, the experimental pool may consist of a group of units selected in an unknown manner from a vaguely defined population of such units and compliance with treatment assignment may be less than complete. In such cases our SATE may diverge from the PATE and recovering estimates of each becomes more complicated. Imai, King, and Stuart (2008) decompose the divergence between these estimates into error that arises from sample selection and treatment imbalance. Error from sample selection arises from different distributions of (observed and unobserved) covariates in our sample and population. For example people in a medical trial often differ from the population for whom the drug would be available. Error from treatment imbalance reflects differences in covariates between treatment and control groups in our sample, perhaps because of non-random assignment and/or non-compliance.\nWhile there are no simple solutions to the problems created by such error, there are steps you can take in both the design of your study and the analysis of your data to address these challenges to estimating the PATE or CACE/LATE. For example, including a placebo intervention provides additional information on the probability of receiving treatment, that can be used to re-weight the effect of actually receiving it (e.g Nickerson (2008)) in the presence of non-compliance. One could also use a model to re-weight observations to adjust for covariate imbalance and the unequal probability of receiving the treatment, both within the sample and between a sample and the population of interest.12\nIn the code below, we demonstrate several approaches to estimating these effects implemented in the CausalGAM package for R.13 Specifically, the package produces regression, inverse-propensity weighting (IPW), and augmented inverse-propensity weighting estimates of the ATE. Combining regression adjustment with IPW, the AIPW has the feature of being “doubly robust” in that the estimate is still consistent even if we have incorrectly specified either the regression model or the propensity score for the probability weighting.\n\n# Example adapted from ?estimate.ATE\nlibrary(CausalGAM)\nset.seed(1234) # For replication\nn = 1000 # Sample size\nX1 = rnorm(n) # Pre-treatment covariates\nX2 = rnorm(n)\np = pnorm(-0.5 + 0.75*X2) # Unequal probabilty of Treatment\nD = rbinom(n, 1, p) # Treatment\nY0 = rnorm(n) # Potential outcomes\nY1 = Y0 + 1 + X1 + X2\nY = D*Y1 + (1-D)*Y0 # Observed outcomes\nsamp = data.frame(X1,X2,D,Y)\n# Estimate ATE with AIPW, IPW, Regression weights\nATE.out <- estimate.ATE(pscore.formula = D ~ X1 +X2,\n                        pscore.family = binomial,\n                        outcome.formula.t = Y ~ X1\n                        +X2,\n                        outcome.formula.c = Y ~ X1\n                        +X2,\n                        outcome.family = gaussian,\n                        treatment.var = \"D\",\n                        data=samp,\n                        divby0.action=\"t\",\n                        divby0.tol=0.001,\n                        var.gam.plot=FALSE, nboot=50)\n\n\n\n6 Average Treatment Effects on the Treated and the Control\nTo evaluate the policy implications of a particular intervention, we often need to know the effects of the treatment not just on the whole population but specifically for those to whom the treatment is administered. We define the average effects of treatment among the treated (ATT) and the control (ATC) as simple counter-factual comparisons:\n\\[ATT=E(Y_i(1)-Y_i(0)|D_i=1)=E(Y_i(1)|D_i=1)-E(Y_i(0)|D_i=1)\\] \\[ATC=E(Y_i(1)-Y_i(0)|D_i=0)=E(Y_i(1)|D_i=0)-E(Y_i(0)|D_i=0)\\]\nInformally, the ATT is the effect for those that we treated; ATC is what the effect would be for those we did not treat.\nWhen treatment is randomly assigned and there is full compliance, \\(ATE=ATT=ATC\\), since \\(E(Y_i(0)∣D_i=1)=E(Y_i(0)∣D_i=0)\\) and \\(E(Y_i(1)∣D_i=0)=E(Y_i(1)∣D_i=1)\\) Often either because of the nature of the intervention or specific concerns about cost and ethnics, treatment compliance is incomplete and the ATE will not in general equal the ATT or ATC. In such instances, we saw in the previous section that we could re-weight observations by their probability of receiving the treatment to recover estimates of the ATE. The same logic can be extended to produce estimates of the ATT and ATC in both our sample and the population.14\nBelow, we create a case where the probability of receiving treatment varies but can be estimated using a propensity score model.15 The predicted probabilities from this model are then used as weights to recover the estimates of the ATE, ATT, and ATC. Inverse propensity score weighting attempts to balance the distribution of covariates between treatment and control groups when estimating the ATE. For the ATT, this weighting approach treats subjects in the treated group as a sample from the target population (people who received the treatment) and weights subjects in the control by their odds of receiving the treatment. In a similar fashion, the estimate of the ATC weights treated observations to look like controls. The quality (unbiasedness) of these estimates is inherently linked to the quality of our models for predicting the receipt of treatment. Inverse propensity score weighting and other procedures produce balance between treatment and control groups on observed covariates, but unless we have the “true model” (and we almost never know the true model) the potential for bias from unobserved covariates remains and should lead us to interpret our estimates of the ATT or ATC in light of the quality of the model that produced it.\n\nset.seed(1234) # For replication\nn = 1000 # Sample size\nX1 = rnorm(n) # Pre-treatment covariates\nX2 = rnorm(n)\np = pnorm(-0.5 + 0.75*X2) # Unequal probabilty of Treatment\nD = rbinom(n, 1, p) # Treatment\nY0 = rnorm(n) # Potential outcomes\nY1 = Y0 +1 +X1 +X2\nY = D*Y1 + (1-D)*Y0 # Observed outcomes\nsamp = data.frame(X1,X2,D,Y)\n# Propensity score model\nsamp$p.score<-\npredict(glm(D~X1+X2,samp,family=binomial),type=\"response\")\n# Inverse Propability Weights\nsamp$W.ipw<-with(samp, ifelse(D==1,1/p.score,1/(1-p.score)))\nsamp$W.att<-with(samp, ifelse(D==1,1,p.score/(1-p.score)))\nsamp$W.atc<-with(samp, ifelse(D==1,(1-p.score)/p.score,1))\n# IPW: ATE, ATT, ATC\nATE.ipw<-coef(lm(Y~D,data=samp,weights=W.ipw))[2]\nATT.ipw<-coef(lm(Y~D,data=samp,weights=W.att))[2]\nATC.ipw<-coef(lm(Y~D,data=samp,weights=W.atc))[2]\n\n\n\n7 Quantile Average Treatment Effects\nThe ATE focuses on the middle, in a way on the effect for a typical person, but we often also care about the distributional consequences of our treatment. We want to know not just whether our treatment raised average income, but also whether it made the distribution of income in the study more or less equal.\nClaims about distributions are difficult. Even though we can estimate the ATE from a difference of sample means, in general, we cannot make statements about the joint distribution of potential outcomes \\((F(Yi(1),Yi(0)))\\) without further assumptions. Typically, these assumptions either limit our analysis to a specific sub-population16 or require us to assume some form of rank invariance in the distribution of responses to treatment effects.17\nIf these assumptions are justified for our data, we can obtain consistent estimates of quantile treatment effects (QTE) using quantile regression.18 Just as linear regression estimates the ATE as a difference in means (or, when covariates are used in the model, from a conditional mean), quantile regression fits a linear model to a conditional quantile and this model can then be used to estimates the effects of treatment for that particular quantile of the outcome. The approach can be extended to include covariates and instruments for non-compliance. Note that the interpretation of the QTE is for a given quantile, not an individual at that quantile.\nBelow we show a case where the ATE is 0, but the treatment effect is negative for low quantiles of the response and positive for high quantiles. Estimating quantile treatment effects provides another tool for detecting heterogeneous effects and allows us to describe distributional consequences of our intervention. These added insights come at the cost of requiring more stringent statistical assumptions of our data and more nuanced interpretations of our results.\n\nset.seed(1234) # For replication\nn = 1000 # Population size\nY0 = runif(n) # Potential outcome under control condition\nY1= Y0\nY1[Y0 <.5] = Y0[Y0 <.5]-rnorm(length(Y0[Y0 <.5]))\nY1[Y0 >.5] = Y0[Y0 >.5]+rnorm(length(Y0[Y0 >.5]))\nD = sample((1:n)%%2) # Treatment: 1 if treated, 0 otherwise\nY = D*Y1 + (1-D)*Y0 # Outcome in population\nsamp = data.frame(D,Y)\nlibrary(quantreg)\nATE = coef(lm(Y~D,data=samp))[2]\nQTE = rq(Y~D,tau =\nseq(.05,.95,length.out=10),data=samp,method = \"fn\")\nplot(summary(QTE),parm=2,main=\"\",ylab=\"QTE\",xlab=\"Quantile\",mar = c(5.1, 4.1, 2.1, 2.1))\n\n\n\n\n\n\n8 Mediation Effects\nSometimes we want to describe not just the magnitude and significance of an observed causal effect, but also the mechanism (or mechanisms) that produced it. Did our intervention raise turnout in the treatment group, in part, by increasing these subjects’ sense of political efficacy? If so, how much of that total effect can be attributed to the mediated effects of our treatment on efficacy and efficacy on turnout?\nBaron and Kenny (1986) offer a general framework for thinking about mediation by decomposing the total effect of treatment into its indirect effect on a mediator that then effects the outcome, called an average causal mediation effect (ACME), and the remaining average direct effect (ADE) of the treatment. Unbiased estimation of these effects, however, requires a set of strong assumptions about the relationship between treatment, mediators, outcomes, and potential confounders, collectively called sequential ignorability (Imai, Keele, and Yamamoto (2010), Bullock, Green, and Ha (2010)).19\nMost causal effects likely operate through multiple channels, and so an assumption of sequential ignorability for your experiment can be hard to justify. For example, the top row in the figure below illustrates situations in which sequential ignorability holds, while the bottom row depicts two (of many possible) cases in which sequential ignorability is violated, and mediation analysis is biased. In essence, specifying the effects of a particular mediator requires strong assumptions about the role of all the other mediators in the causal chain. While some experimental designs can, in theory, provide additional leverage (such as running a second, parallel experiment in which the mediator is also manipulated), in practice these designs are hard to implement and still sensitive to unobserved bias. In some cases, the insights we hope to gain from mediation analysis may be more easily acquired from subgroup analysis and experiments designed to test for moderation.\nImai and colleagues propose an approach to mediation analysis that allows researchers to test the sensitivity of their estimates to violations of sequential ignorability.20 In the code we demonstrate some of the features of their approach, implemented in the mediation package in R (Tingley et al. 2014). We model the relationships with OLS, but the package is capable of handling other outcome processes, such as generalized linear models or general additive models, that may be more appropriate for your data. Most importantly, the package allows us to produce bounds that reflect the sensitivity of our point estimates to some violations of sequential ignorability. In our simulated data, just over 20 percent of the total effect is mediated by our proposed mediator, M and the bias from an unobserved pre-treatment confounder would have to be quite large (ρ=.7) before we would reject the finding of a positive ACME. These bounds are only valid, however, if we believe there are no unobserved post-treatment confounders (as in panel 4). Sensitivity analysis is still possible, but more complicated in such settings (Imai and Yamamoto 2013).\n\n\nset.seed(1234) # Replication\nn = 1000 # Sample size\nY0 = runif(n) # Potential outcome under control condition\nD = sample((1:n)%%2) # Treatment: 1 if treated, 0 otherwise\nX<-rnorm(n) # Covariate\nM<-rnorm(n=n,mean=D+rnorm(n)) # Mediator influenced by Treatment\nY1 = Y0 + 1 + M # Potential outcome under treatment\nY = D*Y1 + (1-D)*Y0 # Outcome in population\nsamp<-data.frame(D,M,Y)\nlibrary(mediation)\nmed.f<-lm(M~D+X,data=samp) # Model for mediator\nout.f<-lm(Y~M+D+X,data=samp) # Model for outcome\n#Estimate ACME and ADE\nlibrary(mediation)\nmed.out<-\nmediate(med.f,out.f,treat=\"D\",mediator=\"M\",robustSE=T,sims=1000)\n# Sensitivity of ACME to unobserved pre-treatment confounder\ns.out<-medsens(med.out)\nplot(s.out) # Plot sensistivity bounds\n\n\n\n\n\n# Structural equations estimates of ACME ADE\n# f1<-formula(Y~D+X)\n# f2<-formula(M~D+X)\n# f3<-formula(Y~D+M+X)\n#\n# med.sys<-systemfit(list(f1,f2,f3),data=samp)\n# ACME<-coef(med.sys)[\"eq1_D\"]-coef(med.sys)[\"eq3_D\"]\n# ADE<-coef(med.sys)[\"eq3_D\"]\n\n\n\n9 Log-Odds Treatment Effects\nAverage treatment effects seem a bit hard to interpret when outcomes are not continuous. For example, a very common binary outcome in the study of elections is coded as 1 when subjects voted, and 0 when they did not. The average effect might be 0.2, but what does it really mean to say that a treatment increased my voting by 0.2? Estimating causal effects for dichotomous outcomes requires some additional care, particularly when including covariates. A common quantity of causal interest for dichotomous outcomes is our treatment’s effect on the log-odds of success, defined for the experimental pool as:\n\\[\\Delta = log\\frac{E(Y_i(1))}{1-E(Y_i(1))} - log\\frac{E(Y_i(0))}{1-E(Y_i(0))}\\]\nFreedman (2008b) shows that logistic regression adjusting for covariates in a randomized experiments produces biased estimates of this causal effect. The basic intuition for Freedman’s argument comes from the fact that taking the log of averages is not the same as taking the average of logs and so the treatment coefficient estimated from a logistic regression conditioning on covariates will not provide a consistent estimator of log-odds of success. Instead, Freedman recommends taking the predicted probabilities varying subjects’ treatment status but maintaining their observed covariate profiles to produce a consistent estimator of the log-odds.\nThe basic procedure is outlined in the code below. The coefficients from the logistics regression controlling for covariate X, tend to overestimate the effect of treatment on the log odds, while the adjusted estimates from the predicted probabilities produce consistent results.\n\nset.seed(1234) # For replication\nn = 1000 # Sample size\nU = runif(n)\nX = runif(n) # Observed Covariate\nY0 = ifelse(U>.5,1,0) # Potential Outcomes\nY1 = ifelse(U+X>.75,1,0)\nD = rbinom(n,1,.75) # Randomly assign 3/4 to treatment\nY = D*Y1+Y0*(1-D)\nsamp = data.frame(X,D,Y)\naT<-with(samp, mean(Y[D==1]))\naC<-with(samp, mean(Y[D==0]))\n# Unconditional log odds\nlog.odds<-log(aT/(1-aT))-log(aC/(1-aC))\n# Logistic regression conditioning on X overestimates log odds\nfit<-glm(Y~D+X,data=samp,binomial(\"logit\"))\nlog.odds.logit<-\n  coef(glm(Y~D+X,data=samp,binomial(\"logit\")))[2]\n# Dataframes using original covariates for predicted probabilities\nD1<-data.frame(D=1,samp[,c(\"X\")])\nD0<-data.frame(D=0,samp[,c(\"X\")])\n#Adjusted log-odds produces consisted estimator of log-odds\naT.adj<-predict(fit,newdata=D1,type=\"response\")\naC.adj<-predict(fit,newdata=D0,type=\"response\")\nlog.odds.adj<-log(mean(aT.adj)/(1-mean(aT.adj)))-\n  log(mean(aC.adj)/(1-mean(aC.adj)))\n\n\n\n10 Attributable Effects\nWe conclude with a brief discussion of an alternative quantity of causal interest that may be particularly useful with binary outcomes: the attributable effect (Rosenbaum 2010). Consider a simple case with a dichotomous outcome and treatment. Let \\(A\\) be the number of outcomes attributable to treatment, that is, the number of cases in which \\(Y_i\\) equaled 1 among treated subjects which would not have occurred had these units been assigned to control. For a range of \\(A\\)’s, we adjust the observed contingency table of outcomes among the treated, and compare this resulting distribution to a known null distribution (the distribution of outcomes we would have observed had treatment had no effect). The resulting range of \\(A\\)’s for which our test continues to reject the null hypothesis of no effect provides a range of effects that are attributable to our treatment.\n\n\n\nTable 1\n\\(D=1\\)\n\\(D=0\\)\n\n\n\n\n\\(Y=1\\)\n\\(\\sum Y_iD_i-A\\)\n\\((1-Y_i)(D_i)\\)\n\n\n\\(Y=0\\)\n\\(\\sum Y_i(1-D_i)+A\\)\n\\(\\sum (1-Y_i)(1-D_i)\\)\n\n\n\nRosenbaum (2002) shows extensions of this concept to different types of outcomes (such as continuous variables). A similar logic can also be applied to detecting uncommon but dramatic responses to treatment (Rosenbaum and Silber 2008).\nHansen and Bowers (2009) use this approach to identify the number of additional votes attributable to different interventions in get-out-the-vote experiment with clustered treatment assignment and one-sided non-compliance. They show that, in large samples, one can approximate the confidence interval for attributable effects without assessing each attribution. Here is an example of that approach where covariates are used to increase precision.\nFirst, we define an attributable effect as \\(A=∑_iZ_iτ_i\\), where \\(τ_i=Y_i(1)−Y_i(0)\\) and \\(y∈0,1\\) following Rosenbaum (2002). That is, the attributable effect is the number of “yes” or “success” or other “1” responses among those treated that we would not have seen if they had been assigned control.\nSecond, notice that if we write the set \\(U\\) as the experimental pool, and the set of control units is a subset of the whole pool, \\(C⊆U\\), then we can write \\(∑_{i∈C}Y_i−Y_i(0)=0\\). This means that we can represent \\(A\\) using totals:\n\\[A = ∑_{i=1}^NZ_iτ_i=∑_{i=1}^NZ_i(Y_i(1)−Y_i(0))=∑_{i∉C}y_i(1)−∑_{i∉C}y_i(0)\\] \\[  = ∑_{i∉C}Y_i−∑_{i∉C}Y_i(0)=∑_{i=1}^NY_i−∑_{i=1}^NY_i(0)=t_U−t_C\\]\n\n= observed total overall (fixed and observed) - total outcome under control (unobserved, to estimate)\n\nThird, this representation allows us to produce a design-based confidence interval for A^ by drawing on the survey sampling literature about statistical inference for sample totals because the observed total outcomes, tU, is fixed across randomizations. We can use covariates to increase precision here because the survey regression estimator allows us to estimate the total that we would have seen in the control group: \\(\\hat{t}_c=\\sum_{i∈U}\\hat{Y}_i+\\sum_{i∈U}(Y_i-\\hat{Y}_i)\\) with \\(\\hat{Y}_i=f(X_i,\\beta)\\) (Lohr 1999). The survey sampling literature shows that as \\(N→∞\\), \\(CI(\\hat{t}_c) \\approx \\hat{t}_c \\pm z_{a/2}SE(\\hat{t}_c)\\). So, one can calculate \\(\\widehat{SE}(\\hat{t}_c)\\) from standard sampling theory and then the \\(CI(\\hat{A}) \\approx t_U-\\widehat{CI}(\\hat{t}_c)\\).\nIn the code below, we provide an illustration using simulated data for a binary response and treatment. In 85 percent of the treatment group, \\(Y=1\\) compared to 52 percent in the control. A difference of this size is consistent with our treatment having caused \\(Y=1\\) for between 92 and 138 of subjects, for whom \\(Y\\) would have otherwise equaled 0 had they not received the treatment. The regression estimator, which leverages precision gained from including covariates, produces tighter confidence intervals (98.8 to 135.1) for the attributable effects.\n\nset.seed(1234) # For replication \nn = 1000 # Sample size \nX1 = rnorm(n) # Covariates \nX2 = rnorm(n) \np = pnorm(-0.5 + 0.75*X2) # Unequal probability of treatment \nD = rbinom(n, 1, p) \np0 = pnorm(rnorm(n)) # Potential outcomes for binary response \np1 = pnorm(X1 + X2+1) \nY0 = rbinom(n, 1, p0) \nY1 = rbinom(n, 1, p1) \nY = D*Y1 + (1-D)*Y0 # Observed outcome \nsamp = data.frame(D,Y,X1,X2) # Data frame \nattribute<-function(treat,out,A,data){ \n  # Contingency Table of Treatment Status and Outcome \n  attr.tab<-with(data,table(treat,out)) # \n  # Matrix of p-values for Attributable effects, A \n  attr.ps<-\n    matrix(NA,nc=2,nr=A,dimnames=list(NULL,c(\"A\",\"p\"))) \n  for(i in 1:A){ \n    attr.ps[i,]<-\n      c(i,fisher.test(attr.tab+matrix(c(0,i,0,-i),2,2))$p) \n    }\n  # Find range of effects \n  get.bounds<-function(){ \n    diffs<-ifelse(.05-attr.ps[,\"p\"]>0,.05-\n                    attr.ps[,\"p\"],99) \n    index<-(diffs %in% \n              c(min(diffs),min(diffs[diffs>min(diffs)]))) \n    index \n    }\n  # Return range of effects \n  return (attr.ps[get.bounds(),])\n  } \nwith(samp,table(D,Y))\n\n   Y\nD     0   1\n  0 318 339\n  1  51 292\n\nwith(samp,apply(table(D,Y),1,prop.table)) \n\n   D\nY           0        1\n  0 0.4840183 0.148688\n  1 0.5159817 0.851312\n\nattribute(treat = D, out= Y, A=200,data=samp) \n\n       A          p\n[1,]  92 0.04519869\n[2,] 138 0.04587804\n\n# Regression estimator \nfit1<-lm(Y~X1+X2,data=samp,subset=D==0) \nhatYcU<-predict(fit1,newdata=samp) \nec<-Y[D==0]-hatYcU[D==0] ## same as residuals(fit1) \nhatTotYc<-sum(hatYcU)+sum(ec) \nN<-length(Y) \nnctrls<-sum(1-D) \nthefpc<- (1 - (nctrls/N)) \nvarhattC<-N*thefpc*var(Y[D==0]) \nalpha<-c(.05, 1/3) \nalpha<-sort(c(alpha/2, 1-alpha/2)) \nciTotYc<-hatTotYc+sqrt(varhattC)*qnorm(alpha) \nciAE<-sort(sum(Y) - ciTotYc ) \nnames(ciAE)<-c(\"lower 95%\",\"lower \n66%\",\"upper 66%\",\"upper 95%\") \nprint(ciAE) \n\n  lower 95% lower \\n66%   upper 66%   upper 95% \n   98.78637   107.97975   125.90114   135.09451 \n\n\n\n\nReferences\nAronow, Peter M, and Joel A Middleton. 2013. “A Class of Unbiased Estimators of the Average Treatment Effect in Randomized Experiments.” Journal of Causal Inference 1 (1): 135–54.\nAronow, Peter M, and Cyrus Samii. 2014. “Does Regression Produce Representative Estimates of Causal Effects?” In EPSA 2013 Annual General Conference Paper. Vol. 585.\nBaron, Reuben M, and David A Kenny. 1986. “The Moderator–Mediator Variable Distinction in Social Psychological Research: Conceptual, Strategic, and Statistical Considerations.” Journal of Personality and Social Psychology 51 (6). American Psychological Association: 1173.\nBound, John, David A Jaeger, and Regina M Baker. 1995. “Problems with Instrumental Variables Estimation When the Correlation Between the Instruments and the Endogenous Explanatory Variable Is Weak.” Journal of the American Statistical Association 90 (430). Taylor & Francis: 443–50.\nBrambor, Thomas, William R. Clark, and Matt Golder. 2006. “Understanding Interaction Models: Improving Empirical Analyses.” Political Analysis 14 (1): 63–82.\nBullock, John G, Donald P Green, and Shang E Ha. 2010. “Yes, but What’s the Mechanism?(don’t Expect an Easy Answer).” Journal of Personality and Social Psychology 98 (4). American Psychological Association: 550.\nChernozhukov, Victor, and Christian Hansen. 2005. “An IV Model of Quantile Treatment Effects.” Econometrica 73 (1). Wiley Online Library: 245–61.\nDunning, Thad. 2010. “Design-Based Inference: Beyond the Pitfalls of Regression Analysis?” Rethinking Social Inquiry: Diverse Tools, Shared Standards. 2nd Ed. Lanham, Md.: Rowman and Littlefield.\nFreedman, David A. 2008a. “On Regression Adjustments to Experimental Data.” Advances in Applied Mathematics 40 (2). Elsevier: 180–93. ———. 2008b. “Randomization Does Not Justify Logistic Regression.” Statistical Science 23 (2). Institute of Mathematical Statistics: 237–49.\nFrölich, Markus, and Blaise Melly. 2010. “Estimation of Quantile Treatment Effects with Stata.” Stata Journal 10 (3): 423.\nGerber, Alan S, and Donald P Green. 2012. Field Experiments: Design, Analysis, and Interpretation. WW Norton.\nGreen, Donald P. 2009. “Regression Adjustments to Experimental Data: Do David Freedman’s Concerns Apply to Political Science?” In 26th Annual Meeting of the Society for Political Methodology, Yale University, July, 23–25.\nHansen, Ben, and Jake Bowers. 2009. “Attributing Effects to a Cluster-Randomized Get-Out-the-Vote Campaign.” Journal of the American Statistical Association 104 (487). Taylor & Francis: 873–85.\nHartman, Erin, RD Grieve, R Ramsahai, and Jasjeet S Sekhon. forthcoming. “From SATE to PATT: Combining Experimental with Observational Studies.” Journal of the Royal Statistical Society.\nHirano, Keisuke, Guido W Imbens, and Geert Ridder. 2003. “Efficient Estimation of Average Treatment Effects Using the Estimated Propensity Score.” Econometrica 71 (4). Wiley Online Library: 1161–89.\nHolland, Paul W. 1986. “Statistics and Causal Inference.” Journal of the American Statistical Association 81 (396). Taylor & Francis: 945–60.\nImai, K., L. Keele, D. Tingley, and T. Yamamoto. 2011. “Unpacking the Black Box of Causality: Learning About Causal Mechanisms from Experimental and Observational Studies.” American Political Science Review 105 (4). Cambridge Univ Press: 765–89.\nImai, Kosuke, and Teppei Yamamoto. 2013. “Identification and Sensitivity Analysis for Multiple Causal Mechanisms: Revisiting Evidence from Framing Experiments.” Political Analysis 21 (2). SPM-PMSAPSA: 141–71.\nImai, Kosuke, Luke Keele, and Teppei Yamamoto. 2010. “Identification, Inference and Sensitivity Analysis for Causal Mediation Effects.” Statistical Science. JSTOR, 51–71.\nImai, Kosuke, Gary King, and Elizabeth A Stuart. 2008. “Misunderstandings Between Experimentalists and Observationalists About Causal Inference.” Journal of the Royal Statistical Society: series A (Statistics in Society) 171 (2). Wiley Online Library: 481–502.\nImai, Kosuke, Dustin Tingley, and Teppei Yamamoto. 2013. “Experimental Designs for Identifying Causal Mechanisms.” Journal of the Royal Statistical Society: Series A (Statistics in Society) 176 (1). Wiley Online Library: 5–51.\nLin, Winston. 2013. “Agnostic Notes on Regression Adjustments to Experimental Data: Reexamining Freedman’s Critique.” The Annals of Applied Statistics 7 (1). Institute of Mathematical Statistics: 295–318.\nLohr, Sharon L. 1999. “Sampling: DesignandAnalysis.” Pacific Grove, CA: Brooks/Cole.\nNeyman, Jerzy. 1990 [1923]. “On the Application of Probability Theory to Agricultural Experiments. Essay on Principles. Section 9.” Statistical Science 5 (4). Institute of Mathematical Statistics: 465–72 (Translated by D.M. Dabrowska and T.P. Speed from the original Polish).\nNickerson, D.W. 2008. “Is Voting Contagious? Evidence from Two Field Experiments.” American Political Science Review 102 (1). Cambridge Univ Press: 49.\nRosenbaum, Paul. 2002. “Attributing Effects to Treatment in Matched Observational Studies.” Journal of the American Statistical Association 97 (457). Taylor & Francis: 183–92.\nRosenbaum, Paul R. 2002. Observational Studies. Springer.\nRosenbaum, Paul, and Donald B. Rubin. 1983. “The Central Role of the Propensity Score in Observational Studies for Causal Effects.” Biometrika 70 (1). Biometrika Trust: 41–55.\nRosenbaum, Paul, and Jeffrey H Silber. 2008. “Aberrant Effects of Treatment.” Journal of the American Statistical Association 103 (481). Taylor & Francis: 240–47.\nRosenbaum, PR. 2010. “Design of Observational Studies.” Springer Series in Statistics. New York [etc.]: Springer. Tingley, Dustin, Teppei Yamamoto, Kentaro Hirose, Luke Keele, and Kosuke Imai. 2014. “mediation: R Package for Causal Mediation Analysis.” Journal of Statistical Software 59 (5): 1–38. http://www.jstatsoft.org/v59/i05/.\n\n\n\n\n\nFootnotes\n\n\nFor a more formal discussion of independence and the assumptions necessary to estimate causal effects, see Holland (1986) and Angrist, Joshua, and Jörn-Steffen Pischke. 2008. Mostly Harmless Econometrics: An Empiricist’s Companion. Princeton University Press.↩︎\nSee Holland and Angrist & Pischke again for more formal discussion of independence and the assumptions necessary to estimate causal effects.↩︎\nEstimates are often written with a hat ( \\(\\widehat{ATE}\\) ) to reflect the difference between the estimate from our particular sample and the estimand, target of our estimation that is unobserved. Unless otherwise stated, in this guide we focus on generating sample estimates and subsequently omit this explicit notation for brevity. See Gerber and Green (2012) for concise introduction to this distinction and Imbens and Wooldridge (2007) for a thorough treatment of these concepts.↩︎\nThe covariance of \\(Y_{i}(1),Y_{i}(0)\\) is impossible to observe but the “Neyman” estimator of the variance omitting the covariance term provides a conservative (too large) estimate of the true sample variance because we tend to assume that the covariance is positive. Since we are generally worried about minimizing type I error rate (incorrectly rejecting true null hypothesis), we prefer using conservative estimates of the variance. See also Dunning (2010) and Gerber and Green (2012) for justification of the conservative variance estimator.↩︎\nLin (2013)↩︎\nBrambor, Clark, and Golder (2006)↩︎\nAngrist, Joshua, and Jörn-Steffen Pischke. 2008. Mostly Harmless Econometrics: An Empiricist’s Companion. Princeton university press.↩︎\nWe typically assume monotonicity, meaning there are no defiers or people who only take the treatment when assigned to control (\\(D_{i}=1\\) when \\(Z_i=0\\)) and refuse the treatment when assigned to treatment (\\(D_{i}=0\\) when \\(Z_{i}=1\\)).↩︎\nAngrist, Joshua, and Jörn-Steffen Pischke. 2008. Mostly Harmless Econometrics: An Empiricist’s Companion. Princeton university press.; Bound, Jaeger, and Baker (1995)↩︎\nSee Imai, King, and Stuart (2008) for a more detailed review of the issues discussed in this section.↩︎\nImbens, Guido, and Jeffrey M Wooldridge. 2007. What’s New in Econometrics? NBER.↩︎\nAngrist and Pischke (2008) provide a brief introduction of topics covered in more detail by Hirano, Imbens, and Ridder (2003), Aronow and Middleton (2013), Glynn and Quinn (2010), and Hartman et al. (forthcoming)↩︎\nGlynn, Adam N, and Kevin M Quinn. 2010. “An Introduction to the Augmented Inverse Propensity Weighted Estimator.” Political Analysis 18 (1):36–56.↩︎\nSee Hartman et al. (forthcoming) for an example of efforts to combine experimental and observational data to move from a sample ATE to an estimate of a population ATT.↩︎\nRosenbaum and Rubin (1983)↩︎\nAbadie, Angrist, and Imbens (2002)↩︎\nChernozhukov and Hansen (2005). That is, treatment can have heterogeneous effects but the ordering of potential outcomes is preserved. See Angrist and Pischke Angrist, Joshua, and Jörn-Steffen Pischke. 2008. Mostly Harmless Econometrics: An Empiricist’s Companion. Princeton university press. See Frölich and Melly (2010) for fairly concise discussions of these issues and Abbring and Heckman (Abbring, Jaap H, and James J Heckman. 2007. “Econometric Evaluation of Social Programs, Part III: Distributional Treatment Effects, Dynamic Treatment Effects, Dynamic Discrete Choice, and General Equilibrium Policy Evaluation.” Handbook of Econometrics 6. Elsevier: 5145–5303.) (2007) for a thorough overview.↩︎\nSee Koenker, Roger, and Kevin Hallock. 2001. “Quantile Regression: An Introduction.” Journal of Economic Perspectives 15 (4): 43–56. for a concise overview of quantile regression↩︎\nFormally, Imai, Keele, and Yamamoto (2010) define the necessary conditions of sequential ignorability as: \\({Y_i(d',m),M_i(d)}⊥D_i|X_i=x, Y_i(d',m)⊥M_i(d)|D_i=d,X_i=x\\). That is, first, given pre-treatment covariates, the potential outcomes of Y and M are independent of treatment D, and, second, that conditional on pre-treatment covariates and treatment status, potential outcomes are also independent of the mediator.↩︎\nSee for example Imai, Keele, and Yamamoto (2010), Imai et al. (2011), Imai, Tingley, and Yamamoto (2013), Imai and Yamamoto (2013). Also see the discussion of Imai, Tingley, and Yamamoto (2013) for different perspectives on the desirability of addressing mediation-type claims with sensitivity or bounds-style analyses.↩︎"
  },
  {
    "objectID": "guides/getting-started/eval_conversations_en.html",
    "href": "guides/getting-started/eval_conversations_en.html",
    "title": "10 Conversations that Implementers and Evaluators Need to Have",
    "section": "",
    "text": "Abstract\nIf you are a practitioner or official from a governmental or non-governmental organization (an \"implementer\"), this guide is intended to help you to take advantage of opportunities to collaborate with external researchers (\"evaluators\") to evaluate your organization's policies or programs. Researchers working on evaluations can also benefit from this guide by understanding how to take implementers' needs into account.\nAs an implementer, what should you expect or request when collaborating with an external evaluator? How can that evaluation be designed to help your organization and the broader field to learn and innovate? What conversations should you have with an evaluator upfront so that the evaluation runs smoothly? How can you work with the evaluator to decide on and communicate actionable and convincing analyses about the impact of a program? How will you and the evaluator share what you learned to improve the practice of your organization and others? How can you ensure that what you learn helps the whole community of practice so that overall social welfare improves? This short guide offers questions to guide conversations with prospective evaluators, points to some practices that have worked well elsewhere, and explains why they might be important or useful in future evaluations.1\n\n\n1) What is the goal of the evaluation?\nThis may seem blatantly straightforward–the evaluation is to see if the program worked. Yet most policy evaluation efforts involve multiple goals. The program may be in a pilot stage, and you want to gather preliminary evidence before expanding the program. The program may have worked in one context (country, community), and you would like to know how generalizable it is. You may want to know who the program works for. Does it work differently for men or women? Marginalized communities or wealthy and powerful groups? You may want to know how part of your intervention affects other aspects of your existing interventions (e.g., cash vs. cash + training) or what combination of activities are most cost effective. You may want to know if you should try to scale the program. Or you may want to know not so much whether or not the program works, but why it works.\nAdditionally, many programs have multiple components. The program may not only be delivering a service (e.g., distributing information on how to access health services), but it may also be trying to build the capacity of a local agency; (e.g., help a public health agency to identify households for additional forms of support ). As a result, there are potentially both individual-level (i.e., micro) questions–the effect of school lunches on children–and more macro questions–how are local governments better able to identify vulnerable children?–that need answers. While both may be asked in one evaluation, the evaluators need to understand how the implementer prioritizes the two questions. This prioritization will affect the evaluation design (see the next Conversation).\nAs implementers, it's important to be clear on your goal of what you want to learn among yourselves and be clear about those goals with the evaluation team. The evaluation team or person, particularly if they are an academic or publish their work more widely, will also have goals about what they want to learn. Without being clear about what you and your organization need to learn, the evaluator may not design the most appropriate evaluation method. This takes us to the next question.\n\n\n2) What is the best method for the evaluation?\nSince evaluation efforts may serve multiple purposes for different audiences, no single research design is always best. We suggest that evaluation and implementation teams not take for granted any given approach: some evaluation teams specialize in human-centered design research which is very similar to ethnographic research in the social sciences; other teams specialize in randomized controlled trials (RCTs). The fact that any given team has expertise in one particular mode of research should not outweigh the need to connect purposes to evaluation design. We have seen such conversations yield realizations that, in fact, an \"evaluation\" ought to be a multi-step process with learning about the context and the intervention occurring along the way –- more akin to adding evidence to hone a learning agenda than to report on the estimated causal effect of a given intervention in a given place and time.\nOpenness about the evaluation approach can also prepare teams to adapt as new information arises. For example, at the end of an RCT one of the authors conducted in Nigeria, we learned that the program diffused from direct participants to some non- participants. However, we did not know why and could immediately think of competing explanations after the fact: Was it a result of non-participants witnessing cooperation among direct participants? Did the people who directly participated talk about their experience with non-participants? Did norms in these communities change? Pairing this work with interviews and observations earlier in the process would have helped us understand why we found the effect, and then we could have better tested these new ideas with follow-up studies.\nRCTs can be used to test insights that are derived from more unstructured observation. For example, the Los Angeles-based campaign specialist, David Fleischer, noticed from his own experience and those of others that certain interactions during door-to-door canvassing appeared to be particularly compelling for changing people's minds about sensitive topics. Communications between him and a pair of academics led to a series of RCTs to verify and unpack the mechanisms behind this phenomenon (called \"deep canvassing\").\nThis conversation about approach, method, and maybe iteration, between the evaluator and the implementer, can also help identify whether the intervention can be conducted in a way to better answer the questions of interest. For example, is there a way to phase in or layer parts of the program so you could test mechanisms? How might you recruit individuals into the program so that it is more representative of the populations you care about, or so that the results will be generalizable? Our general theme here (and elsewhere in this guide) is that the most useful evaluations often occur when both the evaluation and the program design are created collaboratively (see Conversation 6 below).\n\n\n3) Who are the stakeholders?\nOften there are multiple stakeholders both within the organization whose work is subject to the evaluation, but also externally (not to mention the evaluator themself, and the audiences they may want to influence by publicizing the results). Within an organization, some people work across contexts and want to understand how a program may vary in its results across those contexts. Some people implement in a specific context and want to know how to do it better in that place. Then there may be executives who are focused on external influence and raising the profile of the organization versus the program managers who are trying to use the information to adapt their programming. For example, when one of the authors was working on an evaluation related to host and refugee relationships, the HQ team cared most about the pooled results across Lebanon and Jordan. Such results allowed them to speak to the larger issue of host-refugee relations. In contrast, the field teams cared more about country-specific data so they could adapt their programming. The evaluation team worked with both the field and HQ teams to prioritize which results to produce first. In this case, the different needs within an organization did not change the evaluation design. But one could easily imagine a situation where an evaluation designed to be sensitive to the effects of a program in one place would be inappropriate in another context. If a multi-context analysis is of primary importance, then one will be glad to have had this conversation early in the design process rather than discovering that one cannot easily combine datasets.\nBoth implementers and evaluators who are committed to benefiting the larger social good will also want to influence external stakeholders, particularly policymakers. Discussing who these people are and what questions and information they will find most persuasive needs to happen not just after the data is analyzed, but at the design phase. Otherwise, the implementing organization may be disappointed that the results are not able to speak to certain debates and as a result may be less likely to invest in evidence generation in the future. We discuss more about publicizing results below.\n\n\n4) How can our evaluation enable learning within our organization?\nAn organization decides to evaluate the performance of a new (or old) policy because its members desire to learn how to improve. We state this point first and foremost because resistance to evaluation often arises from different stakeholders who think of the word \"evaluate\" and connect it with \"grade\" or \"rank\" or other attempts to measure that often distribute rewards or punishments. An organization that primarily evaluates as a form of ranking or grading will quickly run into resistance and all of the problems associated with replacing internal motivations with external carrots and sticks — carrots and sticks are blunt instruments that rarely lead to the best performance from anyone.\nIf, however, an organization uses evaluations to learn, then the structure of an evaluation should take the desire to learn into account. Some questions that might well orient any such evaluation include:\n\nWhat decisions will the organization make in the short term which would change depending on this evaluation?\nWhat hypothetical results from this evaluation could contribute to which pending and consequential decisions by the organization?\n\nEven when the purpose is to learn, not grade, some within an organization may still be fearful of the results, as they believe their careers are tied to achieving strong results. If they are not bought into the learning agenda, they may resist cooperation with the evaluators or refuse to use the results of the evaluation, limiting the evaluation's utility. Ensuring that the questions the team closest to the ground wants to learn about are incorporated into the evaluation helps ensure the success both in evaluating the program, and that people will use the results of the evaluation to learn and improve future programs.\n\n\n5) How might this evaluation connect to a broader and shared learning agenda?\nOne way to think about learning for an organization is to think about its high level goals: What is the mission of your organization and what part of that mission do you want your programs to contribute to? For example, say a county government has an overall goal of reducing racial inequality. Next imagine that you are implementing a program which provides reduced bus fares with the assumption that reduced bus fares increase employment opportunities with higher wages. You want to test this assumption, and evaluate whether the subsidies contributed to the larger goal of reducing racial inequality. In that case, one might imagine a figure or diagram illustrating this theory of change that by reducing bus fares, People of Color are better able to commute to jobs with higher wages, thus reducing racial inequality. The implementer can then work with the evaluator to design the evaluation to learn about (a) the effects of reducing bus fares on employment options and (b) about how reducing bus fares affects our overall goal of reducing racial inequality in our county.\"\nBy having this type of conversation–about how a specific program or policy may contribute to larger change–there is a recognition that one evaluation or one program is part of a larger learning agenda. This conversation then can shape a deeper collaboration between the implementer and evaluator (see the next Conversation). Evaluators are often based in academia and bring a passion to engage pressing questions of theory to their work with the hope that they uncover some underlying and generalizable truths. They also have read extensively in the field, and may be able to bring additional evidence to bear on your policy or program. If the high level learning goals of a community of evaluators and implementers can connect, then one hopes the results of individual evaluations more easily connect and cumulate into even more effective policy creation and implementation.\n\n\n6) On what parts of the project should we collaborate?\nIn our experience, when a new policy design arises from a creative collaboration between evaluators (who are often academics) and implementers, everyone wins. Often, for example, a better evaluation design can be incorporated into the implementation if discussed early, in a way that creates fewer burdens on the implementer and/or those benefiting from the new policy (e.g., aligning data collection or phasing in of intervention sites). Another benefit arising from such creative co-creation is that different people will bring different perspectives and evidence-bases to the table for the design of both the program and the evaluation. For example, the U.S. government's Office of Evaluation Sciences (OES) has institutionalized this process. They write:\nOur collaborators, who are civil servants with years of experience working to deliver programs across the government, are experts on how their programs work and often have the best ideas for how to improve them. OES team members support their efforts by bringing diverse academic and applied expertise to more deeply understand program bottlenecks and offer recommendations drawn from peer-reviewed evidence in the social and behavioral sciences.\nThe Immigration Policy Lab at Stanford uses this co-creation process as a basis for their collaboration with implementers. They work with organizations not only to research policies and programs but work with the implementer from the start. Through this process, evaluators bring the latest evidence related to a specific policy issue (e.g., refugee resettlement) and co-design the intervention with the implementer utilizing the best evidence with on-the-ground experience. Together, they then evaluate the intervention, adding to the knowledge on immigration policies.\nOther evaluations involve an evaluator brought on after the fact — perhaps the funders and/or the implementer desire a fresh perspective on the data and design, or the original implementation was rushed. Either way, \"how and on which parts should we collaborate\" is still a crucial conversation to have.\n\n\n7) How will we communicate within and across teams?\nCollaboration requires communication. This means that the parties to an evaluation agreement must agree to speedy feedback in mutually agreed upon forms and processes for how to do so. For example, some complex evaluations might create a quick web dashboard so that sample sizes and implementation can be easily seen by the whole team. Other, simpler projects may agree to use existing tools for project management and communication. Not everyone checks email all the time. And many people silence their phones as they try to focus. Having this conversation about communication allows new partners to avoid misunderstanding email or Slack silence.\nCalendars and deadlines are also an important part of this conversation. During certain periods, evaluators may be less available (e.g, when grades or a grant application is due); the implementer may need at least preliminary results for an important donor meeting. Knowing these time windows can help understand availability, know when responses may be slow, and allow both sides to plan accordingly.\nThe communication discussion is also an opportunity to envision the final products: the one-pager, the anticipated three challenges and hoped for three successes for the external-facing report, the number of drafts of the different final projects the team expects to go through, and who is expected to take the lead on which ones. This might be a time where evaluators and implementers share draft reports or report templates that they have liked in the past.\n\n\n8) How and where shall we make the results of this study public? (i.e., communicate externally)\nA well-done public evaluation report is a gift to humanity.\nConsider who will benefit from a public report of positive, negative, or null results:\n\nFuture members of your organization will be able to use the information to craft better policies.\nMembers of other organizations like yours and funders can also learn. If they share their results publically then policy learning can occur more quickly than if each organization or funder has to pay for and field its own evaluation.\nScientists and others who focus on theoretical explanations will move more quickly and will generate more ideas if they can see whether certain ideas work or not (or how they work). Published results and analysis plans help spur learning by the originating organization, by other organizations, and by science.\n\nPublishing results of evaluations also helps your organization in two important and related ways. 1) It enhances your organization's influence with donors and other policymakers, as you can inform key debates with evidence. 2) It enhances your organization's reputation as trustworthy and willing to provide a public good to improve the field. When one of the authors of this guide was working inside an implementing organization, donors often complimented the organization's commitment to sharing results that contradicted conventional wisdom.\nMoreover, publishing all results helps quell other criticisms that can be aimed at organizations that are contributing to knowledge generation. For example, some criticize evidence-based policy by calling it \"policy-based evidence.\" The criticism suggests that evaluations serve only to add a veneer of respectability to the pre-conceived notions of organizational leaders. This idea — that careful research and analyses are merely rhetoric — can diminish trust in individual organizations and in government and science as institutions. Instead, if an organization says, \"We publish all of our evaluations and invite others to scrutinize our results and join us in learning how to better serve the public,\" then it is hard for detractors to claim that the organization is hiding the truth and hard for others to pressure the organization to hide the truth in turn.\nThe timelines that implementers and evaluators, especially ones who come from academia, have for publishing results are likely different. Your organization may want to use or share the results as soon as possible, so that you can improve your programming or influence policy. However, cleaning and analyzing data takes time. And a review of the results before publishing can improve the quality of the presentation and analysis. Some academic publications prefer that the results not be shared publicly before publication in other formats. Given these benefits and constraints, it's important to talk with the evaluator about how to share the results and when and how.\n\n\n9) What if things do not go as expected or hoped?\nIn conducting an evaluation, numerous things may not go according to plan. There are many operational issues, and since an evaluation can be a multi-month or multi-year process, complications always arise. There may be staffing changes, and their commitment to the evaluation may vary. Or new staff members are interested in different questions. The context may change and the teams have to adapt. The Covid pandemic is a good example of this, as programming and how data was collected had to change practically overnight. Good communication within the team (see above) is essential for navigating these unexpected issues that will arise in some form, and ensuring the integrity of the program and evaluation.\nIn addition to these operational issues, we may find unexpected results from the evaluation. The evaluation may find that the program or policy had little effect. While null results can be disappointing, in of themselves, they can provide important learning. If the results show null effects, then the organization can re-evaluate and generate more ideas for how to implement the program. Null results can encourage more learning than one might think when they are combined with prior beliefs. Also, null results can arise for reasons that have more to do with sample size or other artifacts of the evaluation (e.g., how the outcomes were operationalized) than with the impact of the intervention. A null result arising from an intervention that, in theory, really should have had a big effect, can be particularly fruitful for science — it sends scientists back to the drawing board and forces re-evaluation of well-established theories. Perhaps those theories had only been tested in the context of university laboratories rather than in the real world. Or perhaps the real world in which the theories had been assessed in the past has now changed. See for example the handout on How to Use Unexpected and Null Results by the OES and our 10 Things Your Null Result Might Mean methods guide.\nWhile nulls or other unintended impacts provide important learning for an organization, they can create uncomfortable conversations with the evaluator and internally within an organization. As a result, thinking through these possibilities ahead of time can be very useful so that people are not surprised. There are a couple of tools that help the implementer and evaluator think through these together.\nOne approach arising from project management in business involves the creation of pre-mortems in which the implementer and evaluator begin by imagining that the evaluation has returned a null or negative result. What might have led to this result? The teams list the possibilities that they can imagine and thereby become prepared for those and similar problems.\nAnother related approach from public health uses the name 'Dark Logic' to evoke the idea that one uses imagination and logic together to create negative scenarios, which in turn may (1) help an organization and evaluator avoid worst-case scenarios and (2) prepare an organization to react to such scenarios should they occur.\nA third approach that is becoming the norm for experimental research in political science, economics, and social psychology is to use a pre-analysis plan. People can sometimes disregard an evaluation if the results do not confirm their beliefs. A pre-analysis plan helps prevent criticism of the results of the evaluation based on methods or analysis choices. See 10 Things to Know about Pre-Analysis Plans for more on why and how. See also Preregistration as a Tool for Strengthening Federal Evaluation from OES.\nA pre-analysis plan also can help stakeholders within an organization, perhaps stakeholders with conflicting prior beliefs, think through what analyses they would find convincing before the study has been fielded/data have been analyzed. For example, an evaluator could generate hypothetical tables and figures and show them to stakeholder meetings asking: \"What would your reaction be to a figure like this?\" This process helps stakeholders begin to assess the evaluation questions in more detail, ensure that measures are operationalized appropriately, and consider the level of implementation that is needed for the desired results. It also helps stakeholders become aware of the possibility that we may learn something unexpected.\n\n\n10) How can our evaluation contribute to the social good?\nA premise of this guide is that the evaluation will contribute to the social good. Yet we think that a conversation about this more generally can help implementers and evaluators collaborate more effectively by providing a superordinate goal to unite the whole team. Further, we encourage this conversation to ensure that all of the evaluation effort adds to the overall efforts to improve the world.\nAlthough we exhort such conversations in general terms, we also think that an evaluation can add to the social good fairly directly via transparency of methods and, to the extent possible, by sharing data. That is, in addition to the evaluation itself, the data you collect as part of the evaluation, the plans you make, the code the evaluators write, is also a social good. In the social sciences, there is a movement towards more openness of data–sharing the data and how it is analyzed – as an effort to speed scientific learning. This, in addition to a pre-analysis plan or pre-registration, is becoming required of many journals. We see this kind of transparency as adding to the impact of an evaluation outside of a given organization and providing a net benefit for your organization and the field for several reasons.2\n\nEfficiency of time and money: Collecting data is time consuming and expensive. The data you collect may be analyzed by others in additional ways to answer different questions, and help explore potential innovations.\nEnhances data quality: In some places, participants in programs may suffer from being over-surveyed. By sharing data, it reduces the need to ask people the same questions repeatedly. This helps reduce survey fatigue and enhances data quality.\nIncreases confidence in results: Others can replicate your findings with the same or different analysis choices. Real world data analysis involves many choices, and data flows from the world of administrative data, surveys, and interviews into the hands of the analyst via a twisting and turning path. Some of the reasonable choices made by one analyst may not be the reasonable choices made by another. Since both choices may be reasonable, and even correct, it is worth having a second team, blind to the results of the first analysis, follow the analysis plan following their own interpretation. The OES have institutionalized this practice: See \"Step 5: Ensure our work meets evaluation best practice\" of the OES Project Process for their re-analysis report document and explanation.\nIncreases the trust in your organization: That your organization is willing to share data demonstrates that you have nothing to hide and that you are willing to contribute to the public good.\n\nFor more on Open Science, see 10 Things to Know About Project Workflow which is based on the more fun titled paper \"How to Improve Your Relationship With Your Future Self.\"\n\n\n\n\n\nFootnotes\n\n\nMuch of this document is inspired by the Project Process of the OES as well as discussions hosted by the Causal Inference for Social Impact project at CASBS and the Evidence in Governance and Politics network. See the MIT Gov Lab Guide to Difficult Conversations for more guidance about academic-practitioner collaborations as well as the Research4Impact findings about cross-sector collaborations. We anticipate that this document will be open source and revised over time based on your comments and suggestions. Thanks much to Carrie Cihak, Matt Lisiecki, Ruth Ann Moss, Betsy Rajala, Cyrus Samii, Rebecca Thornton,, and folks at the organizations listed above for helpful comments.↩︎\nWe do recognize that some donors may not allow this (though many are becoming proponents of it), and the competitive nature of fundraising may make sharing data seem risky, especially as a first mover.↩︎"
  },
  {
    "objectID": "guides/getting-started/external-validity_en.html",
    "href": "guides/getting-started/external-validity_en.html",
    "title": "10 Things You Need to Know About External Validity",
    "section": "",
    "text": "Abstract\nAfter months or years under development and implementation, navigating the practical, theoretical and inferential pitfalls of experimental social science research, your experiment has finally been completed. Comparing the treatment and control groups, you find a substantively and statistically significant result on an outcome of theoretical interest. Before you can pop the champagne in celebration of an intervention well evaluated, a friendly colleague asks: “But what does this tell us about the world?”\n\n\n1. What is external validity?\nExternal validity is another name for the generalizability of results, asking “whether a causal relationship holds over variation in persons, settings, treatments and outcomes.”1 A classic example of an external validity concern is whether traditional economics or psychology lab experiments carried out on college students produce results that are generalizable to the broader public. In the political economy of development, we might consider how a community-driven development program in India might apply (or not) in West Africa, or Central America.\nExternal validity becomes particularly important when making policy recommendations that come from research. Extrapolating causal effects from one or more studies to a given policy context requires careful consideration of both theory and empirical evidence. This methods guide discusses some key concepts, pitfalls to avoid, and useful references to consider when going from a Local Average Treatment Effect to the larger world.\n\n\n2. How is this different than internal validity?\nInternal validity refers to the quality of causal inferences being made for a given subject pool. As originally posited by Campbell,2 internal validity asks, “did in fact the experimental stimulus make some significant difference in this specific instance.” This concept dovetails with the counterfactual approach to causality that experimentalists typically use, which asks whether outcomes change depending on the presence or absence of a treatment.3\nBefore you can extrapolate a causal effect to a distinct population, it is vital that the original Average Treatment Effect be based on a well-identified result. For most experimentalists, random assignment provides the requisite identifying variation, provided no attrition, interference, spillovers, or other threats to inference. For observational studies, additional identifying assumptions are needed, such as conditional independence of the treatment from potential outcomes.\n\n\n3. Navigating the trade-offs between internal and external validity\nThere has been an ongoing debate within the social sciences regarding the relative importance of identifying internally valid results, which by definition apply to a local sample, and generating results that can be extrapolated to broader populations of interest. It is helpful to be familiar with this discussion when considering design trade-offs that inevitably crop up in resource-limited interventions. That both sides of the argument include luminaries of econometrics attests to the importance of the topic.\nOn one side of the argument fall advocates of “identification first,” who argue that without internally valid results, a study simply does not contribute useful information, regardless of whether it is a local or general population or context. As put by Imbens,4 “without strong internal validity studies have little to contribute to policy debates, whereas [internally valid] studies with very limited external validity often are, and in my view should be, taken seriously in such discussions.”\nOthers argue that even without full identification of an internally valid result, useful information can be salvaged, especially if it is relevant for important questions that affect a broad context. Manski5 writes that “what matters is the informativeness of a study for policy making, which depends jointly on internal and external validity.” With data from a broad but a poorly identified study, Manski argues, bounds on the estimand of interest can be generated that, while not as useful as a precise point estimate, still moves science forward.\n\n\n4. Theory and generalization\nExtrapolating a result to a distinct context, outcome, population or treatment is not a mechanical process. As discussed by Samii6 and Rosenbaum,7 relevant theory should be used to guide generalization, taking the relevant existing evidence and making predictions for other contexts in a principled fashion. Theories boil down complex problems into more parsimonious representations, and help to elucidate what factors matter. Just as theory guides the content of interventions and research designs, theoretical propositions can tell you which scope conditions are relevant for extrapolating a result. What covariates matter? What contextual information matters?\n\n\n5. How can I determine where my results apply?\nThere are two primary means of generalizing results, one based on the covariates of units in the study and the other based on actual experimental manipulation of moderating variables. Observing how a treatment effect varies over a non-randomized pre-treatment variable can describe treatment effect heterogeneity, which can be highly suggestive about where or for whom the intervention is likely to be most effective, beyond the original sample. Note, however, that this type of analysis cannot pin down whether the treatment-effect heterogeneity is caused by that pre-treatment variable. The concern—endemic to observational research—is that the non-randomized covariate may be correlated with an unobserved variable, and it is this “unseen” factor that in fact is responsible for the heterogeneous impacts of the treatment.8 Ideally, therefore, we want to leverage exogenous variation in the moderator of interest, thereby ruling out the possibility of such confounding. A factorial experimental design in which the researcher assigns the moderator independently of the main treatment of interest can generate especially compelling evidence about a moderator’s role. Though, of course, considerations of cost and statistical power may preclude this approach in practice.\nBecause generalization is primarily a prediction exercise, asking where we can expect a causal relationship similar to one observed locally, extrapolating heterogeneous effects based on similar covariates is often reasonable, provided theory does not indicate sources of confounding.9 Nonetheless, the strongest evidence for the generalizability of a result comes from a well-identified interaction between an exogenous moderator and the treatment, then projected across the covariate profile of a target population. Indeed, with some strong assumptions extrapolation can provide as good or better results than carrying out a second experiment in situ.10 The calculation of an extrapolated estimate can often be best performed using machine learning, although linear regression also performs reasonably well.11\n\n\n6. Strategic behavior can scuttle your extrapolations\nExtrapolating a local result to a different context can prove challenging even with a compelling covariate profile to which you want to generalize effects. A randomized experimental manipulation in a local area generates a “partial equilibrium effect.” Strategic dynamics, including compensatory behavior or backlashes, outside the local context of an experimental intervention can complicate efforts to generalize a result. Suppose, for example, that an unconditional cash transfer intervention is shown to increase welfare, entrepreneurship, and employment in a sample of 200 villages. What would happen if the intervention were extended to encompass 1000 villages? At this point, one could imagine that regions excluded from the program are more likely to learn about it. Untreated units may start to demand other types of transfers from the government, giving rise to effects similar to those produced by the direct cash transfer. In a similar vein, sometimes causal relationships only work when they are applied to some people. For example, imagine a job skills program that functions very well (as compared to those who did not receive it), what would happen if it were extended to all workers? Even if there are positive effects across all participants, there could be reduced or no average effects as higher skilled jobs are already filled by the first batch and the second batch is forced to remain in their previous jobs, now overqualified. In short, under general equilibrium conditions we might expect different results even where the covariate profile matches.\n\n\n7. Don’t confuse external validity with construct validity or ecological validity\nInternal and external validity are not the only ‘validity’ concerns that can be leveled at experimental work, and though relevant, they are also distinct. Ecological validity, as defined by Shadish, Cook and Campbell12 concerns whether an intervention appears artificial or out of place when deployed in a new context. For example, does an information workshop in a rural town carried out by experimenters resemble the kinds of information sharing that the population may experience in regular life? Similarly, if the same workshop were held in a large city, would it appear out of place?\nConstruct validity considers whether a theoretical concept being tested in a study is appropriately operationalized by the treatment(s). If your experiment is testing the effect of anger on political reciprocity and you are in fact manipulating fear or trust in your treatment, construct validity may be violated. Both construct and ecological validity are relevant for generalizations, and thus useful for making claims about external validity.\n\n\n8. Extrapolation across treatments and outcomes\nWhile much of this guide has implicitly focused on porting a given treatment to a new place or time, external validity also considers variations in treatments and outcomes. That is, imagine we did the same experiment on the same sample, but with a variation on the treatment, would we predict the local causal effect to be similar? Similarly, can we predict if a given treatment will produce the same or different causal effects on a different outcome? Sometimes we can address these concerns by conducting experiments that assess alternative treatments and outcomes. When follow-up experiments are in short supply, such issues have to be settled analytically. Rather than considering the features of subjects, extrapolation in this case requires thinking through, aided by theory, the characteristics of the treatments or outcomes and making reasonable predictions.\n\n\n9. Replication is important\nNo single study represents the final word on a scholarly question. Following the logic of Bayesian updating, additional evidence in favor of or against a given theory allows the scientific and policy community to update their beliefs about the strength and validity of a causal relationship.\nReplication of studies is an important part of this: scholars should replicate studies in contexts that look very different, but also in some contexts that look very similar. The former allows us to identify local causal relationships that can be triangulated with existing evidence and generalized as appropriate. At the same time, it is important to directly replicate existing studies under conditions that are as close as possible to the original in order to verify that local effects one may be interested in extrapolating are indeed reliable. The Open Science Collaboration13 found, for example, that when reproducing 100 major psychology experiments, just 47% of the original reported effect sizes fell within the 95% confidence interval of the effect size shown in the replication.\n\n\n10. Don’t forget time\nWhen thinking about causal relationships of interest, it is important also to consider time: do things we learn about the past extend to the future? How do an individual’s potential outcomes change over time? Immutable laws govern the physical and chemical worlds; hence what we learn about these laws today will always remain true. By contrast, we understand far less about the underlying drivers of social behavior and whether they hold constant in the same way. The answer may well be no. When making decisions about the policy relevance and generalizability of results, these considerations can help scholars determine a reasonable level of uncertainty and help policy makers adjust accordingly.\n\n\n\n\n\nFootnotes\n\n\nShadish, W. R., Cook, T. D., & Campbell, D. T. (2002). Experimental and quasi-experimental designs for generalized causal inference. Houghton, Mifflin and Company.↩︎\nCampbell, D. T. (1957). Factors relevant to the validity of experiments in social settings. Psychological bulletin, 54(4), 297.↩︎\nMore details can be found in the causal inference methods guide: https://egap.org/resource/10-things-to-know-about-causal-inference↩︎\nImbens, G. (2013). Book Review Feature: Public Policy in an Uncertain World: By Charles F. Manski. The Economic Journal,123(570), F401-F411.↩︎\nManski, C. F. (2013). Response to the review of ‘public policy in an uncertain world’. The Economic Journal 123: F412–F415.↩︎\nSamii, Cyrus. (2016). “Causal Empiricism in Quantitative Research.” Journal of Politics 78(3):941–955.↩︎\nRosenbaum, Paul R. (1999). “Choice as an Alternative to Control in Observational Studies” (with discussion). Statistical Science 14(3): 259–304.↩︎\nGerber, A. S., & Green, D. P. (2012). Field experiments: Design, analysis, and interpretation. WW Norton.↩︎\nBisbee, James; Rajeev Dehejia; Cristian Pop-Eleches & Cyrus Samii. (2016). “Local Instruments, Global Extrapolation: External Validity of the Labor Supply-Fertility Local Average Treatment Effect.” Journal of Labor Economics↩︎\nBisbee, James; Rajeev Dehejia; Cristian Pop-Eleches & Cyrus Samii. (2016). “Local Instruments, Global Extrapolation: External Validity of the Labor Supply-Fertility Local Average Treatment Effect.” Journal of Labor Economics↩︎\nKern, H. L., Stuart, E. A., Hill, J., & Green, D. P. (2016). Assessing methods for generalizing experimental impact estimates to target populations. Journal of Research on Educational Effectiveness, 9(1), 103-127.↩︎\nShadish, W. R., Cook, T. D., & Campbell, D. T. (2002). Experimental and quasi-experimental designs for generalized causal inference. Houghton, Mifflin and Company.↩︎\nOpen Science Collaboration. (2015). Estimating the reproducibility of psychological science. Science, 349(6251), aac4716.↩︎"
  },
  {
    "objectID": "guides/getting-started/het-effects_en.html",
    "href": "guides/getting-started/het-effects_en.html",
    "title": "10 Things to Know About Heterogeneous Treatment Effects",
    "section": "",
    "text": "Abstract\nThis guide1 discusses methods for analyzing heterogeneous treatment effects: testing for heterogeneity, estimating subgroup treatment effects and their differences, and addressing the pitfalls of multiple comparisons and ad hoc specification search.2\n\n\n1 What Is Treatment Effect Heterogeneity?\nAny given treatment might affect different experimental subjects in different ways. The study of treatment effect heterogeneity is the study of these differences across subjects: For whom are there big effects? For whom are there small effects? For whom does treatment generate beneficial or adverse effects? Research on such questions can help inform theories about the conditions under which treatments are especially effective or ineffective; it can also help inform ways of designing and deploying policies so as to maximize their effectiveness.\n\n\n2 Testing for Heterogeneity\nAs a first step, one might be interested in whether the variance of the treatment effect \\(\\tau_i\\) across subjects is statistically distinguishable from zero and seek to test the null hypothesis that \\(Var(\\tau_i) = 0\\) (which is equivalent to the hypothesis of a constant treatment effect, i.e., \\(\\tau_i = \\tau, \\forall i\\)). However, it is not possible to estimate \\(Var(\\tau_i)\\) in an experimental setting because you never get to see the treatment effect for any particular individual. Instead, you only get to see the outcome for each person either in the treatment or in the control condition.3\nTo illustrate this, we can rewrite \\(Var(\\tau_i)\\) as \\[\n\\begin{aligned}\nVar(\\tau_i) &= Var(Y_i(1) - Y_i(0)) \\\\\n&= Var(Y_i(1)) + Var(Y_i(0)) - 2Cov(Y_i(1),Y_i(0))\n\\end{aligned}\n\\] The term \\(Cov(Y_i(1),Y_i(0))\\) on the right-hand side cannot be estimated in an experiment because we only observe a subject’s treated potential outcome or untreated potential outcome, not both.\nAlthough we cannot estimate \\(Var(\\tau_i)\\), the hypothesis that \\(Var(\\tau_i) = 0\\) does have the testable implication that the distributions of the treated and untreated potential outcomes are identical except for a constant shift \\(\\tau\\). Randomization inference (Fisher 1935) allows us to test this implication without additional modeling assumptions, asymptotics, or regularity conditions.4\n1. Compare treatment and control outcome variances. Under the null hypothesis of a constant treatment effect, the variances of the treated and untreated potential outcomes are equal: \\(Var(Y_i(1)) = Var(Y_i(0))\\). This is because \\[\n\\begin{aligned}\nVar(Y_i(1)) &= Var(Y_i(0) + \\tau_i) \\\\\n&= Var(Y_i(0)) + Var(\\tau_i) + 2 \\cdot Cov(Y_i(0),\\tau_i)\n\\end{aligned}\n\\] and under the null hypothesis, \\(Var(\\tau_i) = 0\\) and \\(Cov(Y_i(0),\\tau_i) = 0\\). Thus, we can test the null by testing the implication that \\(Var(Y_i(1)) = Var(Y_i(0))\\).\nTo implement the test, first use the experimental data to estimate the average treatment effect (ATE) and the difference in variances \\(Var(Y_i(1)) - Var(Y_i(0))\\). Next, create a full hypothetical schedule of potential outcomes assuming that the true treatment effect is constant and equal to the estimated ATE. Finally, to obtain a \\(p\\)-value, simulate random assignment a large number of times and calculate how often the simulated estimate of the difference in variances is at least as large (in absolute value) as the actual estimate.\n\nrm(list = ls(all = TRUE))\nset.seed(1234567)\n# Sample data generating process\nn = 100\nY0 = rnorm(n)\nY1 = Y0 + 2*(1:n)/n  # Treatment effect ranging from 0.02 to 2\nt = sample( rep(c(TRUE, FALSE), each = n/2) )  # Randomly assign treatment\nY = t * Y1 + (1 - t) * Y0  # Observed outcome\n# Estimate ATE\ndiff.mean = function(treated, Y) {\n  mean(Y[treated]) - mean(Y[!treated])\n}\nest.ate = diff.mean(t, Y)\nest.ate\n\n[1] 1.282838\n\n# Estimate absolute value of the difference in variances\nabs.diff.var = function(treated, Y) {\n  abs( var(Y[treated]) - var(Y[!treated]) )\n}\nobserved.stat = abs.diff.var(t, Y)\nobserved.stat\n\n[1] 0.3654271\n\n# Create hypothetical schedule of potential outcomes assuming that\n# the true treatment effect is constant and equal to est.ate\nY0.hyp  =  Y - est.ate * t\nY1.hyp  =  Y + est.ate * (1 - t)\n# Calculate p-value\np.value = function(observed.stat, treated, Y1, Y0, sims = 1000) {\n  sim.stats = numeric(sims)\n  for (i in 1:sims) {\n    t.sim  =  sample(treated)  # Simulate random assignment\n    Y.sim  =  t.sim * Y1  +  (1 - t.sim) * Y0\n    sim.stats[i]  =  abs.diff.var(t.sim, Y.sim)\n  }\n  mean(sim.stats >= observed.stat)\n}\np.value(observed.stat = observed.stat, treated = t, Y1 = Y1.hyp, Y0 = Y0.hyp)\n\n[1] 0.203\n\n# Additional code to calculate power\nreps = 1000\nsim.p.values = numeric(reps)\nfor (i in 1:reps) {\n  t.sim  =  sample(t)\n  Y.sim  =  t.sim * Y1  +  (1 - t.sim) * Y0\n  est.ate.sim = diff.mean(t.sim, Y.sim)\n  Y0.hyp.sim  =  Y.sim - est.ate.sim * t.sim\n  Y1.hyp.sim  =  Y.sim + est.ate.sim * (1 - t.sim)    \n  sim.p.values[i] = p.value(observed.stat = abs.diff.var(t.sim, Y.sim), treated = t.sim,\n                            Y1 = Y1.hyp.sim, Y0 = Y0.hyp.sim)\n}\nmean(sim.p.values < 0.05)  # Estimated power\n\n[1] 0.181\n\n\nThis approach is limited because power for tests of differences in variances is weaker than power for tests of differences in means; thus you might often fail to reject the null hypothesis of a constant treatment effect even when there is real heterogeneity in effects. Another limitation of this method is that it is uninformative when heterogeneous treatment effects exist but the variances of \\(Y_i(0)\\) and \\(Y_i(1)\\) are equal. A third limitation, discussed by Ding, Feller, and Miratrix (2016), is that because the hypothetical schedule of potential outcomes is based on the estimated ATE instead of the unknown true ATE, the approach is not guaranteed to yield a valid test of the constant treatment effect hypothesis. To address this problem, they suggest a “Fisher randomization test confidence interval” (FRT CI) method, described below.\n2. Compare treatment and control marginal cumulative distribution functions. As an alternative to comparing variances, one can compare the marginal cumulative distribution functions (CDFs) of the outcome between treatment and control. Under the null hypothesis of a constant treatment effect, the two CDFs differ only by a constant shift.\nThe first key change to the randomization inference procedure detailed above is the use of a different test statistic. Ding, Feller, and Miratrix (2016) suggest using a Kolmogorov-Smirnov (KS) statistic to measure the maximum pointwise distance between the treatment and control CDFs after shifting the treatment CDF by a constant treatment effect \\(\\tau\\). The test statistic is \\[ t_{KS}(\\tau) = \\max_y | \\hat{F}_0(y) - \\hat{F}_1(y + \\tau) | \\] where \\(\\hat{F}_0(\\cdot)\\) and \\(\\hat{F}_1(\\cdot)\\) denotes the empirical CDFs of the outcome in the control group and treatment group, respectively.\nDing, Feller, and Miratrix suggest plugging in the estimated average treatment effect \\(\\hat{\\tau}\\) for \\(\\tau\\). Their “shifted” KS statistic \\[ t_{SKS} = \\max_y | \\hat{F}_0(y) - \\hat{F}_1(y + \\hat{\\tau}) | \\] is appropriate for testing the hypothesis that the true treatment effect is constant and equal to the estimated ATE.\nThe second key change that Ding, Feller, and Miratrix suggest is the FRT CI method, which addresses the problem that the true ATE may differ from the estimated ATE. The basic idea is that instead of using just one value for the hypothesized constant treatment effect to create the full schedule of potential outcomes for a randomization test, we can try a range of hypothesized constant treatment effects and find the maximum \\(p\\)-value over all the resulting randomization tests. They first construct a 99.9% confidence interval for the ATE (using the Neyman variance estimator), which becomes the range of hypothesized constant treatment effects. They then find the maximum \\(p\\)-value over all the resulting randomization tests and add an increment of 100% - 99.9% = 0.001. This method is guaranteed to yield a valid test of the constant treatment effect hypothesis if the confidence interval used is exactly valid. In practice, the CI is only approximately valid, but the FRT CI method with the shifted KS statistic still yields an exact or conservative test in their simulations.\n\n\n3 Conditional Average Treatment Effects (CATEs)\nA more structured, theory-driven inquiry of treatment effect heterogeneity involves pre-specifying and investigating conditional average treatment effects (CATEs). A CATE is an average treatment effect specific to a subgroup of subjects, where the subgroup is defined by subjects’ attributes (e.g., the ATE among female subjects) or attributes of the context in which the experiment occurs (e.g., the ATE among subjects at a specific site in a multi-site field experiment).\n\n\n4 Interaction Effects: Treatment-by-Covariate versus Treatment-by-Treatment\nIn addition to CATEs, researchers are also interested in treatment-by-covariate interaction effects, or the difference between two CATEs when the covariate partitioning subjects into subgroups is not experimentally manipulated. For example, one might estimate an ATE for female subjects and an ATE for male subjects but actually care about whether the difference in ATEs between the female and male subgroups is statistically distinguishable from zero. To ensure unbiased estimation of CATEs and of interaction effects, the covariate used to partition subjects into subgroups must be a pre-treatment covariate and must be measured using the same procedure for all subjects across experimental groups. A treatment-by-covariate interaction can be interpreted as a descriptive measure of association between the covariate and the treatment effect, but does not necessarily represent the causal effect of a change in the covariate value on the ATE if the covariate is not randomly assigned.\nIn contrast to treatment-by-covariate interactions, treatment-by-treatment interactions are differences in CATEs where the personal or contextual attribute partitioning subjects into subgroups is experimentally manipulated. Because the covariate is randomly assigned, treatment-by-treatment interactions may be interpreted causally. Factorial and partial factorial designs allow researchers to randomly assign subjects to different combinations of “cross-cutting” treatment conditions and to estimate treatment-by-treatment interactions as allowed by the design.\n\n\n5 Estimating CATEs and Interaction Effects\nEstimating CATEs and interaction effects is straightforward. Nonparametrically, the CATE may be estimated by calculating the ATE among subjects in the specific subgroup of interest. Interaction effects may be estimated by differencing relevant CATEs.\nCATEs and interaction effects may also be estimated in a regression framework. Here is an example for a hypothetical experiment evaluating the effect of a job training program on future earnings. Let \\(Y\\) be the outcome (future earnings), \\(Z\\) be the treatment variable (1=job training program, 0=control), and \\(X\\) be a pre-treatment covariate (1=scholarship receipt, 0=no scholarship). The model \\[\n\\begin{aligned}\nY_i &= \\alpha + \\beta Z_i + \\gamma X_i + \\varepsilon_i \\label{null}\n\\end{aligned}\n\\] allows us to estimate the ATE (\\(\\beta\\)) only. We can add an additional term interacting \\(Z\\) and \\(X\\), which yields \\[\n\\begin{aligned}\nY_i &= \\alpha + \\beta Z_i + \\gamma X_i + \\delta Z_iX_i + \\varepsilon_i \\label{alt}\n\\end{aligned}\n\\] where the coefficient \\(\\delta\\) is the interaction effect and is interpreted as the difference between the ATE of the job training program among subjects receiving a scholarship and the ATE of the job training program among subjects not receiving a scholarship. This has a causal interpretation (i.e., \\(\\delta\\) is a treatment-by-treatment interaction) when scholarship receipt is randomly assigned and a descriptive interpretation (i.e., \\(\\delta\\) is a treatment-by-covariate interaction) when scholarship receipt is not randomly assigned.\nThe model with the interaction also allows us to back out the values of the CATEs. The ATE of the job training program among subjects who do not receive a scholarship is \\(\\beta\\). The ATE of the job training program among subjects who receive a scholarship is \\((\\beta + \\delta)\\).\n\n\n6 Hypothesis Testing for Interaction Effects\nTo test whether the estimated interaction effect could have occurred by chance, one can use randomization inference: First generate a full schedule of potential outcomes under the null hypothesis that the true treatment effect is constant and equal to the estimated ATE. Then simulate random assignment a large number of times and calculate how often the simulated estimate of the interaction effect is at least as large (in absolute value) as the actual estimate.\nOne can also conduct randomization inference in a regression framework. One method suitable for two-sided tests involves using the \\(F\\)-statistic as the test statistic, where the null model is \\[\n\\begin{aligned}\nY_i &= \\alpha + \\beta Z_i + \\gamma X_i + \\varepsilon_i\n\\end{aligned}\n\\] and the alternative model is \\[\n\\begin{aligned}\nY_i &= \\alpha + \\beta Z_i + \\gamma X_i + \\delta Z_iX_i + \\varepsilon_i .\n\\end{aligned}\n\\]\n\n# Sample code for RI using F-stat as test statistic\n# Code adapted from: http://isps.its.yale.edu/isps/public/Gerber_Green_FEDAI_2012/\n#                    Chapter-9/GerberGreenBook_Chapter9_PlotandFtest_Figure_9_1.R\nrm(list = ls(all = TRUE))\nset.seed(1234567)\n# Let:\n# Y = observed outcome\n# Z = treatment assignment (complete randomization)\n# X = covariate\nn <- 1000\nZ <- sample( rep(c(1, 0), each = n/2) )\nX <- sample( rep(c(1, 0), each = n/2) )\nY <- rnorm(n)\nnumiter <- 1000 # No. of RI iterations (use more for greater precision, fewer for greater speed)\n# estimate ATE\nestate <- mean(Y[Z==1]) - mean(Y[Z==0])\n# construct hypothetical schedule of potential outcomes\n# using constant effects assumption where tau_i == estate\nY0 <- Y - estate*Z\nY1 <- Y + estate*(1-Z)\n# estimate CATEs\nestcate0 <- mean(Y[X==0 & Z==1]) - mean(Y[X==0 & Z==0])\nestcate1 <- mean(Y[X==1 & Z==1]) - mean(Y[X==1 & Z==0])\nlm1  <- lm(Y~Z*X)  # alternative model\nlm2  <- lm(Y~Z+X)  # null model\nFtest <- (sum(lm2$residuals^2) - sum(lm1$residuals^2)) / (sum(lm1$residuals^2) / (n - 4))\n# or alternatively\n# library(lmtest)\n# Ftest <- waldtest(lm1,lm2)$F[2]\nFdist <- rep(NA,numiter)\nfor (i in 1:numiter) {\n    Zri <- sample(Z)\n    Yri <- Y0*(1-Zri) + Y1*Zri\n    estcate0ri <- mean(Yri[X==0 & Zri==1]) - mean(Yri[X==0 & Zri==0]) \n    estcate1ri <- mean(Yri[X==1 & Zri==1]) - mean(Yri[X==1 & Zri==0])\n    \n    lm1ri  <- lm(Yri~Zri*X)\n    lm2ri  <- lm(Yri~Zri+X)\n    Fdist[i] <- (sum(lm2ri$residuals^2) - sum(lm1ri$residuals^2)) / (sum(lm1ri$residuals^2) / (n - 4))\n    # or alternatively\n    # Fdist[i] <- waldtest(lm1ri, lm2ri)$F[2]   \n    }\n#p-value\nmean(Fdist >= Ftest)\n\n[1] 0.525\n\n\nFor one-sided tests, the coefficient on the interaction term may be used as the test statistic, given the appropriate model.\n\n\n7 Multiple Comparisons\nResearchers interested in heterogeneous treatment effects are likely to encounter the problem of multiple comparisons: for example, when numerous subgroup analyses are conducted, the probability that at least one result looks statistically significant at the 5 percent level may be considerably greater than 5 percent even when the treatment has no effect on anyone.5\nOne way to mitigate the multiple comparisons problem is to reduce the number of tests conducted (e.g., by analyzing a small number of pre-specified subgroups). Another approach is to adjust the \\(p\\)-values to account for the fact that multiple hypotheses are being tested simultaneously.\n7.1 Familywise error rate (FWER) control methods\nFamilywise error rate (FWER) control methods limit the probability of making at least one type I error given the number of tests conducted. Suppose one is testing \\(K\\) hypotheses, \\(H_1, H_2, \\ldots, H_K\\), and \\(K_0\\) of the \\(K\\) hypotheses are true, where \\(K_0 \\le K\\). The familywise error rate is the probability that at least one of the \\(K_0\\) true hypotheses is falsely rejected. The FWER increases in the number of hypotheses tested. FWER control methods adjust the \\(p\\)-values so that, for example, if we reject a hypothesis only when the adjusted \\(p\\)-value is less than 0.05, the FWER will not exceed 5 percent.\nThe most conservative FWER control method is the Bonferroni correction, which multiplies the \\(p\\)-values by the number of tests conducted. (If the result exceeds 1, the adjusted \\(p\\)-value is set to 1.) For example, suppose we tested the significance of four interaction effects and found unadjusted \\(p\\)-values of 0.02, 0.04, 0.2, and 0.3. The adjusted \\(p\\)-values would then be 0.08, 0.16, 0.8, and 1. This approach has limitations because one quickly loses statistical power with just a few tests.\nThe Westfall–Young step-down procedure is an alternative FWER control method that can be more powerful than the Bonferroni correction because it takes into account correlations between the tests.6 The procedure involves the following steps:7\n\nGiven a family of \\(K\\) null hypotheses (where each hypothesis corresponds to a subgroup or interaction of interest), sort the hypotheses in order of decreasing statistical significance (increasing \\(p\\)-value): \\(p_1 \\leq p_2 \\leq \\ldots \\leq p_K\\).\nSimulate the sharp null hypothesis of no treatment effect by performing a large number \\(L\\) of replications of random assignment of treatment, leaving the outcome and covariate data unchanged.\nFor each replication, compute a set of simulated \\(p\\)-values, \\(p_1^*, \\ldots, p_K^*\\). (Do not sort the simulated \\(p\\)-values. Keep the ordering of hypotheses from step 1, so that, e.g., \\(p_1^*\\) corresponds to the same hypothesis as \\(p_1\\).)\nCompute the adjusted \\(p\\)-values as follows:\n\n\\[ p_1^{adj} = \\frac{\\mbox{No. of replications where } \\min (p_1^*, \\ldots, p_K^*) \\leq p_1}{L}\\]\n\\[ p_2^{adj} = \\max \\left(p_1^{adj}, \\ \\frac{\\mbox{No. of replications where } \\min (p_2^*, \\ldots, p_K^*) \\leq p_2}{L} \\right)\\]\n\\[ p_3^{adj} = \\max \\left(p_2^{adj}, \\ \\frac{\\mbox{No. of replications where } \\min (p_3^*, \\ldots, p_K^*) \\leq p_3}{L} \\right)\\]\n\\[ \\ldots \\]\n\\[ p_K^{adj} = \\max \\left(p_{K-1}^{adj} \\, , \\ \\frac{\\mbox{No. of replications where } p_K^* \\leq p_K}{L} \\right)\\]\nR functions to implement the Westfall–Young step-down procedure are available in Porter (2016)8 and the package multtest9.\n7.2 False discovery rate (FDR) control methods\nFalse discovery rate (FDR) control methods control the expected proportion of rejected null hypotheses that are type I errors. Formally, \\(FDR = E[V \\, / \\, R]\\) where \\(V\\) is the number of rejected nulls that are actually true, \\(R\\) is the total number of rejected nulls, and \\(V \\, / \\, R\\) is defined as \\(0\\) if \\(R = 0\\). An equivalent definition is \\(FDR = Pr[R > 0] \\times E[V \\, / \\, R \\mid R > 0]\\).\nThe basic procedure developed by Benjamini and Hochberg (1995)10 involves the following steps to control the FDR. As in the setup to control the FWER, specify \\(K\\) hypotheses \\(H_1, \\ldots, H_K\\) and index the hypotheses in order of decreasing statistical significance so that \\(p_1 \\leq p_2 \\leq \\ldots \\leq p_K\\). Let \\(q \\in (0,1)\\) be the desired upper limit on the FDR. Let \\(c\\) be the largest index for which \\(p_c \\leq (cq \\, / \\, K)\\). Reject \\(H_1, \\ldots, H_c\\) but do not reject any other hypotheses in the family. This procedure controls the FDR at level \\(q\\, (K_0 \\, / \\, K) \\leq q\\) where \\(K_0\\) is the number of true null hypotheses.11\nFDR control tends to be less conservative than FWER control and is popular in fields such as genomics, where, as Westfall et al. (2011, p. 14) write, “the number of hypotheses can easily be in the thousands or millions, [and] you usually do not expect that every significant result is real and replicable. Rather, you just want to ensure that a controlled high proportion (e.g., 0.95 or more) of the significant results is real and replicable.” FDR control methods have also been used in the social sciences—for example, Anderson (2008) uses FDR control for exploratory analyses and FWER control for confirmatory analyses. However, the concept of the FDR can be difficult to interpret, for several reasons:\n\nAs noted above, the FDR is equivalent to \\(Pr[R > 0] \\times E[V \\, / \\, R \\mid R > 0]\\). Thus, Westfall et al. (2011, p. 496) note that interpreting the FDR as “the expected proportion of false rejections” is reasonable when thousands or millions of null hypotheses are tested and \\(Pr[R > 0]\\) (the probability that at least one null is rejected) is close to 1, but “in cases where \\(R\\) can be \\(0\\) with reasonably high probability, the interpretation of FDR is unclear” (because then \\(E[V \\, / \\, R \\mid R > 0]\\) can be much higher than the FDR) and “it is better to use FWE-controlling methods in these cases” because they “have more straightforward interpretation.”\nThe FDR is defined as an expectation: the average value of \\(V \\, / \\, R\\) across an infinite number of hypothetical replications of the study. “Controlling the FDR” means keeping this expectation less than or equal to some threshold \\(q\\). But this says nothing about the variability of \\(V \\, / \\, R\\) across replications and thus does not by itself control the probability that \\(V \\, / \\, R\\) substantially exceeds \\(q\\) (Efron 2010, pp. 51, 55–57).12\nAs Gelman, Hill, and Yajima (2012) write: “Methods that control for the FDR may make particular sense in fields like genetics where one would expect to see a number of real effects amidst a vast quantity of zero effects such as when examining the effect of a treatment on differential gene expression. … They may be less useful in social science applications when we are less likely to be testing thousands of hypotheses at a time and when there are less likely to be effects that are truly zero (or at least the distinction between zero and not-zero may be more blurry).”\n\n\n\n8 Use a Pre-Analysis Plan To Reduce the Number of Hypothesis Tests\nYou can also reduce the numbers of CATEs and interactions under consideration for hypothesis testing by pre-specifying the tests of primary interest in a registered pre-analysis plan (PAP). Additional subgroup analyses can be conceptualized and specified as exploratory or descriptive analyses in the PAP. Another bonus is that if you prefer a one-sided test, you can commit to that choice in the PAP before seeing the outcome data, so that you “cannot be justly accused of cherry-picking the test after the fact” (Olken 2015).13 See our guide 10 Things to Know About Pre-Analysis Plans for more on pre-registration.\n\n\n9 Automate the Search for Interactions\nMachine learning methods are useful to automate the search for systematic variation in treatment effects. These automated approaches are attractive because they minimize researchers’ use of ad hoc discretion in selecting and testing interactions, and are useful for conducting exploratory analyses.\nPopular machine learning methods include support vector machines (R package FindIt),14 Bayesian additive regression trees (R package BayesTree),15 classification and regression trees (R package causalTree),16 random forests,17 and kernel regularized least squares (R package KRLS).18\nIn addition to single machine learning methods, ensemble methods may be used. Ensemble methods estimate a weighted average of multiple machine learning estimates of heterogeneous effects where the weights are a function of out-of-sample prediction performance.19\n\n\n10 A Note on Interactions between Treatment and Post-Treatment Covariates\nThe discussion thus far has assumed that the treatment effect heterogeneity of interest involves pre-treatment covariates, to ensure unbiased estimation of CATEs and treatment-by-covariate interaction effects.\nSome researchers may be interested in post-treatment effect modification, or the interaction between a treatment and a post-treatment covariate. For example, how do the effects of a job search assistance program vary with participants’ levels of depression during the followup period? Conditioning on a post-treatment covariate may lead to bias, because biased estimation of both the main effect and the interaction effects is possible when a post-treatment covariate is included as a regressor. This is especially likely when the covariate is affected by the treatment.\nThere is a burgeoning body of methodological research on the conditions under which CATEs involving post-treatment covariates are identified. These methods rely on model-based identification.20\n\n\n\n\n\nFootnotes\n\n\nOriginating author: Albert Fang, 3 Jun 2016. Revisions: Winston Lin and Don Green, 16 Jan 2017. The guide is a live document and subject to updating by EGAP members at any time; contributors listed are not responsible for subsequent edits.↩︎\nThis guide draws heavily from Alan S. Gerber and Donald P. Green (2012), Field Experiments: Design, Analysis, and Interpretation (New York: WW Norton), and from Don Green’s course notes for Experimental Methods at Columbia University.↩︎\nThis is known as the Fundamental Problem of Causal Inference. For more background, see 10 Things You Need to Know About Causal Inference.↩︎\nFor further reading, see Gerber and Green (2012) and Peng Ding, Avi Feller, and Luke Miratrix (2016), “Randomization Inference for Treatment Effect Variation,” Journal of the Royal Statistical Society, Series B 78: 655–671.↩︎\nFor more background and a range of views on the multiple comparisons problem, see, e.g.: 10 Things You Need to Know About Multiple Comparisons; Richard J. Cook and Vern T. Farewell (1996), “Multiplicity Considerations in the Design and Analysis of Clinical Trials,” Journal of the Royal Statistical Society, Series A 159: 93–110; Kenneth F. Schulz and David A. Grimes (2005), “Multiplicity in Randomised Trials I: Endpoints and Treatments,” Lancet 365: 1591–1595; Schulz and Grimes (2005), “Multiplicity in Randomised Trials II: Subgroups and Interim Analyses,” Lancet 365: 1657–1661; Michael L. Anderson (2008), “Multiple Inference and Gender Differences in the Effects of Early Intervention: A Reevaluation of the Abecedarian, Perry Preschool, and Early Training Projects,” Journal of the American Statistical Association 103: 1481–1495; Peter H. Westfall, Randall D. Tobias, and Russell D. Wolfinger (2011), Multiple Comparisons and Multiple Tests Using SAS, 2nd ed.; Andrew Gelman, Jennifer Hill, and Masanao Yajima (2012), “Why We (Usually) Don’t Have to Worry About Multiple Comparisons,” Journal of Research on Educational Effectiveness 5: 189–211.↩︎\nThe Westfall–Young method’s ability to control the FWER depends on a “subset pivotality” assumption that may be violated when outcomes are heteroskedastic or when there are multiple treatment arms. Westfall et al. (2011, p. 421) write: “However, this theoretical shortcoming is only rarely a practical one for continuously distributed data. Experience shows that this issue is most likely to arise in cases with extreme heteroscedasticity and unbalanced sample sizes. … These issues can become even more problematic when testing binary data.” See also Frank Bretz, Torsten Hothorn, and Peter Westfall (2011), Multiple Comparisons Using R, pp. 133–137. Bootstrap methods that relax the subset pivotality assumption are discussed in: Joseph P. Romano and Michael Wolf (2005), “Exact and Approximate Stepdown Methods for Multiple Hypothesis Testing,” Journal of the American Statistical Association 100: 94–108; Romano and Wolf (2005), “Stepwise Multiple Testing as Formalized Data Snooping,” Econometrica 73: 1237–1282; Romano and Wolf (2016), “Efficient Computation of Adjusted \\(p\\)-Values for Resampling-Based Stepdown Multiple Testing,” Statistics and Probability Letters 113: 38–40; John A. List, Azeem M. Shaikh, and Yang Xu (2016), “Multiple Hypothesis Testing in Experimental Economics,” NBER Working Paper 21875.↩︎\nThis description of the algorithm is adapted from Anderson (2008) and Daniel Gubits, Winston Lin, Stephen Bell, and David Judkins (2014), “BOND Implementation and Evaluation: First- and Second-Year Snapshot of Earnings and Benefit Impacts for Stage 2,” Abt Associates report submitted to the Social Security Administration.↩︎\nKristin E. Porter (2016), “Statistical Power in Evaluations That Investigate Effects on Multiple Outcomes: A Guide for Researchers,” MDRC working paper.↩︎\nKatherine S. Pollard, Sandrine Dudoit, and Mark J. van der Laan (2004), “Multiple Testing Procedures: R multtest Package and Applications to Genomics,” working paper; Sandrine Dudoit and Mark J. van der Laan (2008), Multiple Testing Procedures with Applications to Genomics.↩︎\nYoav Benjamini and Yosef Hochberg (1995), “Controlling the False Discovery Rate: A Practical and Powerful Approach to Multiple Testing,” Journal of the Royal Statistical Society, Series B 57: 289–300.↩︎\nStrictly speaking, to guarantee that the Benjamini–Hochberg procedure controls the FDR, we need to assume either that the \\(p\\)-values corresponding to the true null hypotheses are independent or that they obey a positive dependence condition. For a brief overview of work addressing dependence, see section 3.2 of Yoav Benjamini (2010), “Discovering the False Discovery Rate,” Journal of the Royal Statistical Society, Series B 72: 405–416.↩︎\nBradley Efron (2010), Large-Scale Inference: Empirical Bayes Methods for Estimation, Testing, and Prediction.↩︎\nBenjamin A. Olken (2015), “Promises and Perils of Pre-Analysis Plans,” Journal of Economic Perspectives 29(3): 61–80.↩︎\nSee, for example, Kosuke Imai and Marc Ratkovic (2013), “Estimating Treatment Effect Heterogeneity in Randomized Program Evaluation,” Annals of Applied Statistics 7(1): 443–470.↩︎\nH. A. Chipman, E. I. George, and R.E. McCulloch (2010), “BART: Bayesian Additive Regression Trees,” Annals of Applied Statistics 4: 266–298; Jennifer L. Hill (2011), “Bayesian Nonparametric Modeling for Causal Inference,” Journal of Computational and Graphical Statistics 20(1): 217–240; Donald P. Green and Holger L. Kern (2012), “Modeling Heterogeneous Treatment Effects in Survey Experiments with Bayesian Additive Regression Trees,” Public Opinion Quarterly 76(3): 491–511.↩︎\nSusan Athey and Guido W. Imbens (2016), “Recursive Partitioning for Heterogeneous Causal Effects,” Proceedings of the National Academy of Sciences 113: 7353–7360.↩︎\nStefan Wager and Susan Athey (2016), “Estimation and Inference of Heterogeneous Treatment Effects using Random Forests,” arXiv.↩︎\nJens Hainmueller and Chad Hazlett (2013), “Kernel Regularized Least Squares: Reducing Misspecification Bias with a Flexible and Interpretable Machine Learning Approach,” Political Analysis.↩︎\nMark van der Laan, Eric Polley, and Alan Hubbard (2007), “Super Learner,” Statistical Applications in Genetics and Molecular Biology 6(1); Justin Grimmer, Solomon Messing, and Sean J. Westwood (2014), “Estimating Heterogeneous Treatment Effects and the Effects of Heterogeneous Treatments with Ensemble Methods,” working paper.↩︎\nFor further reading (at an advanced technical level), see S. Vansteelandt and E. Goetghebeur (2003), “Causal Inference with Generalized Structural Mean Models,” Journal of the Royal Statistical Society, Series B 65: 817–835; Vansteelandt and Goetghebeur (2004), “Using Potential Outcomes as Predictors of Treatment Activity via Strong Structural Mean Models,” Statistica Sinica 14: 907–925; S. Vansteelandt (2010), “Estimation of Controlled Direct Effects on a Dichotomous Outcome using Logistic Structural Direct Effect Models,” Biometrika 97: 921–934; Alisa Stephens, Luke Keele, and Marshall Joffe (2016), “Generalized Structural Mean Models for Evaluating Depression as a Post-Treatment Effect Modifier of a Jobs Training Intervention,” working paper. Footer↩︎"
  },
  {
    "objectID": "guides/getting-started/implementation_en.html",
    "href": "guides/getting-started/implementation_en.html",
    "title": "10 Things to Know About Survey Implementation",
    "section": "",
    "text": "1 Decide whether or not to work with a local firm\nThere are two discrete skill sets needed on the ground when implementing a survey. The first skill set is focused on administration/logistics, and the second skill set is focused on research design. The first set of skills is needed for administration: budgeting, creating route plans, recruitment, and management of staff. Administration requires a level of familiarity with local conditions; for example, the ability to quickly estimate costs and troubleshoot logistical issues are important here. The second skill set requires knowledge of research methods to ensure that survey implementation is consistent with the research design. Researchers must be able to recognize any deviations from the protocol and address them in a way that leads to as little bias as possible. Important here is a deep understanding of the survey protocols and possible alternatives, in the case that changes need to be made on the ground.\nIf you will not be present during survey administration, you will need to either hire a firm or individuals who can work together to cover both sets of needs. There are clear advantages to hiring a firm if you have the budget, the biggest being that firms coordinate internally and balance both sets of needs, ensuring that logistics accommodate the design and vice versa. A possible drawback is that firms frequently have their own protocols, and these default procedures are usually at a lower standard than the latest protocol being used in academia. Upgrading protocols is a costly process and firms may push back against the use of stricter, or simply different, practices.\nIf you will be present during enumeration but you have a small budget, or do not feel you could manage the entire implementation (administration and design) yourself, a good alternative is to hire a field coordinator from a survey or research firm on a consultant basis. This person can help with administration while you take on the design-related work. Additionally, hiring someone for administration locally can do a lot to help with cross-cultural management. The types of management procedures that might work to motivate or sanction employees in the US may not work in another context, so someone who knows what is acceptable and effective can add a lot of value.\n##Contracts with local firms When setting up contracts with local firms it is important to get the incentives right—thorough and good work should also be the most profitable for the firm. You can do a lot to set expectations and incentives in the contract. For example, pay on delivery where possible (although it is customary to pay some costs upfront to cover fixed expenses like transport and early salaries). You can also choose to impose financial penalties for late or low-quality data, but be sure to make these requirements clear up front and provide specific rules for what constitutes low-quality work and how late penalties will be assigned.\nIn addition to direct costs, it is reasonable for a local firm to charge overhead. This can vary from context to context, and it is best to check against the budgets of other similar projects to make sure the rate is reasonable.\n\n\n2 Budgeting\nAs you prepare to begin survey implementation, the first and most important part of the survey is budgeting expected costs. It’s important to be thorough and detailed in putting together your budget; it will be critical throughout implementation and will be closely considered by potential funders.\nThe total cost of a survey is the sum of fixed costs, like transportation and equipment costs, and variable expenses like salaries, per diems, and administration costs. See the attached budget template for an overview of typical costs and notes on how to estimate them.\n##Salaries Estimating total salary costs before drawing the sample (needed in order to determine the teams and route plans) requires a bit of guesswork. One approach is to estimate the work-hours needed to conduct the survey (survey length x sample size) and divide by some estimated number of enumerators to come up with the number of enumerator days you will need to pay. The per diem may need to cover food and lodging, and make this clear to enumerators so they can plan accordingly. For surveys that will require long fieldwork, it is good practice to pay salary on a rest day each week although some enumerators prefer to work continuously in order to finish sooner and return home. This choice is context-specific.\n##Per Diems Per diems cover enumerator’s expenses associated with doing fieldwork. This means lodging for overnight stays, all meals, and sometimes also transportation. Per diems should also be paid on rest days that fall in between work days. In the case that the variation in lodging and food costs is low, it is not important to change the per diem rate according to location. Teams will know when to save and when to spend.\n####Quick calculator: ((survey time to complete * sample size)/workable hours in a day)/# of enumerators = number of days\nnumber of days * (daily rate + per diem) + supervisors = approx. total salary cost\n##Transportation It’s important to, ex ante, be as accurate as possible in estimating the full cost of transportation as this is frequently both least flexible and most variable cost. Typically, it is good practice to build in contingency on the cost of fuel, as the price can change over the several months it takes to go from the grant application stage to the implementation stage. If you are budgeting before drawing your sample, pay particular attention to hard-to-reach areas in your population (islands, places without road access) and pad your transport line for the possibility you randomly sample enumeration areas that carry these higher costs.\n##Equipment Later on in this guide we present the benefits of using personal digital assistants (PDAs) or tablets for data collection (see section 3). PDAs/tablets can be either purchased using survey funds or leased from a research firm, university, or other researchers.\n\n\n3 Should you use PDAs or tablets instead of paper?1\n##Why Personal Digital Assistants [PDAs] or Tablets are better (if you have the budget) Use of a PDA/tablet allows the collection of more accurate and detailed data (Goldstein, 2012) because of:\n\nAutomated skip patterns\nMore detail, e.g. the ability to program a multi-stage code list\nThe ability to program some randomization algorithms (permuted block randomization, for example)\nSensitive questions can be recorded by the respondent themselves on the tablet (instead of the enumerator). There are even ways, using sound and video playback, to do this with illiterate respondents\nThe ability to audio record responses for later transcription\n\nPDAs/tablets have lower error rates than paper-based surveys (Caeyers, 2010) and have superior quality control options including:\n\nReal-time data upload\nReal-time survey modification in the case of error or oversight in terms of questions included\nAudio recording of portions of surveys to verify enumerator delivery\nTimers that measure how long respondents spend on the entire survey and each individual question\nReal-time validation checks to make sure numerical questions don’t have answers that are nonsensical\nThe ability to generate several orthogonal treatments within a single survey (either for multiple experiments or for conjoint experiments)\n\n##Tips for PDA or tablet use * Always buy extra equipment – chargers, battery packs, power strips, and tablets can go missing, be stolen, or get broken. In many countries you can’t buy extra equipment, even in capital cities, and it’s often more expensive and lower quality than what you can get at your home base. Buying 10-20% more equipment than you need can be expensive, but it is usually far cheaper than the salaries that you will have to pay for enumerators with equipment problems who do not have backups. * Pay close attention to battery life when you buy your equipment. If you want full days of enumeration, some of the cheaper tablets will not work. * Budget for extra battery packs for your enumerators to carry in the field, particularly if they will travel to rural areas where they may not always be able to charge the tablets every night. * Forecast how frequently teams will be able to upload recorded data. The PDAs/tablets need to be able to store data from completed interviews until uploading is possible. In rural environments this can mean quite a lot of memory is needed, particularly if the survey is long and/or complex. * Budget extra costs for charging of the PDAs or tablets in the field (i.e. paying for extra generator time from hotels) and for potential delays because of lack of power. * Budget extra time for exhaustive testing of the PDA/tablet once the survey is fully coded. Code failures can be disastrous the more complex the code/randomization becomes. Run through as many different responses to the survey as you can yourself, and do a “fake” pre-test during training in which you collect data and inspect it to make sure there are no errors. * Have someone available to make on-the-spot changes to the code in case problems are discovered in the field that stall enumeration until the change is implemented. In addition, give your enumerators enough paper versions of the survey to last for one or more days to serve as a holdover until the code is remedied. * If possible, name your variables in the survey software to avoid a really laborious process of manually re-naming later. This also makes it easier to inspect the data in real-time. * Code answer values (i.e. the values that will be outputted into the dataset) in advance so that you can standardize scales and easily clean the data (for example, use different negative numbers for “don’t know” and “refuse” options so a 10-character command in R can clean the whole dataset). * Take advantage of having more space for text by giving enumerators directions for complicated items in the displayed question text itself.\n\n\n4 Establish a Management Structure\n\nParallel reporting chains can greatly improve the reliability of data by providing incentives to declare errors and mistakes. Under a parallel structure, oversight staff reports directly to survey manager, while surveying staff reports to field coordinator. The aim is to use the auditing and back checking reports in order to cleanly identify problems, and field supervision to then correct any issues.\n##Surveying Field teams are made up of enumerators and a team leader. Team leaders report to a field manager, or in a case of a large survey, a regional supervisor.\n\nThe enumerator’s role is sampling and selecting households and respondents within enumeration areas, gain consent, and conduct the interview. The enumerator’s tasks include:\n\nSelecting the household. For an enumerator this is the first stage in the random selection process and is done according to a clearly specified procedure, which should be easily referenced in both the manual and the survey instrument itself.\nSelecting respondents. Once the household has been selected, the enumerator should follow a similarly-specified random (or systematic) selection process in order to select the subject.\nConsent. Enumerators need to know the definition of informed consent and how to make sure the respondent understands his/her rights during the interview.\nConducting the interview. This will involve asking questions and closely following the instructions communicated in training and on the questionnaires. A hard copy of question-by-question instructions should be provided to enumerators for use as a reference.\nControlling the interview situation. The enumerator must work towards reducing or eliminating suspicion and prejudice within the interview environment. This may involve asking bystanders not to congregate or dealing with sensitive situations with respect to other family members within the home.\nAvoiding bias. The enumerator’s personal views must not be reflected in the data collected. This means, among other things, that the enumerator must remain neutral and respectful during the data collection by not expressing his or her opinion and ensuring that the respondent trusts that the enumerator will respect his or her privacy. Emphasize during training that there really is no right answer and that the goal of the survey is to find out what people really think – because without knowing that, we can’t find solutions to problems.\nPresentation. Interpersonal skills such as manners, dressing, body language and ability to persuade are all important for data quality and will help in obtaining the target respondents for each day.\n\nThe team leader manages a group of enumerators and can conduct interviews him/herself. The team leader is responsible for:\n\nLogistics. The team leader is responsible for organizing the transport of teams, gathering materials, transporting paper instruments, and managing the technology.\nPermissions. Team leaders make contact with local authorities to introduce and explain the survey and get permission to work.\nSupervising. Team Leaders ensure the team arrives on time to the enumeration area and proceeds to oversee within-enumeration area selection of households.\nCorrecting. Once interviewing has begun, team leaders should move between enumerators and check they are following protocols. Supervision should not, however, make subjects feel uncomfortable.\nData Quality. Team Leaders check all questionnaires in the field and at the end of the day. If PDAs/tablets are used either the team leader or an RA will check data. The team leader ensures that data errors are fixed by revisiting respondents.\n\n\n\n##Oversight Enumeration teams and field management can quite easily deviate from important protocols—these deviations can range from replacing sampled households based on the ease of getting respondents to creating fake data. In many cases, cutting corners is not easy to detect and can save money and time for the enumerators, field managers, and even the survey research firm. PDAs/tablets can reduce the number of total possible types of fraud, but some level of field supervision is always necessary. A parallel reporting structure, with independent oversight, can help guard against these deviations.\nOn the oversight side, there are two types of checks that should be conducted– audits and backchecks:\n\nAuditors arrive at randomly selected villages on the days they are slated for enumeration, without advance warning to the team. When an auditor visits a team, they make sure the team is in the correct enumeration area, that they have sought consent from local leaders, complied with the household selection procedure, and that all team members are working. The auditor then tracks the performance of the team throughout the day— as they seek consent, build rapport, conduct within-enumeration area sampling, and survey respondents.\nA backcheck consists of a revisit to a respondent who completed a survey not more than a few days prior. Using the data collected, they locate respondents and verify responses on a few key questions, for which the response was not likely to have changed (for example, age or household size) in the period since they were initially contacted. Backchecking can both help to identify enumerators who are not performing and establish an error rate. If phone numbers are being collected in the survey, this can be done more cheaply by telephone.\n\nConducting both audits and backchecks means that for each individual survey there is some non-zero probability that the work will be checked in some way. In the case that there are only backchecks, teams will never be monitored in terms of their adherence to protocols as they sample and conduct interviews. In the case that there are only audits, if a team is not visited on a particular day of work there is no chance to check that they actually interviewed subjects and recorded their responses accurately.\nAuditors and backcheckers must report directly to survey management. Imagine an example: Say a village is difficult to find and the team of enumerators chooses a replacement (rather than resampling by the PIs), and the auditors visit the sampled village and uncover it was not surveyed. If this error is communicated to someone also managing the enumerators, their best response is to cover this up or try to fix it without the PI knowing. This prevents having to admit a management mistake, and having to add a day of work to revisit the original or resampled village. If the survey team is notified directly, there is an opportunity to fix the mistake and make personnel changes as needed. Unmonitored communication between auditing teams and enumeration teams can result in a lot of unauthorized fixes and unexplainable data patterns.\n\n\n5 Recruit enumerators\n##Sources If you are working alone, recruit experienced enumerators through contacts at survey firms, NGOs, or universities. It is important that enumerators are experienced, literate, educated, and able to build rapport with subjects. Hiring enumerators who are connected, in some way, with the survey leaders or local coordinator, e.g. through a youth organization or other social tie, can help immensely with oversight as the enumerators have bigger reputational costs if they shirk their duties.\n##Languages The foremost requirement is that the enumerators speak the required local languages. We know that coethnicity between enumerators and subjects can reduce bias, so recruitment of coethnic interviewers, and balancing across the sample if using treatment and control groups, is important.\n##Gender parity Having a team of mostly male enumerators interview a sample with equal numbers of men and women there can introduce response bias. For sensitive questions, such as questions on sexual behavior or violence, it is strongly recommended that women interview other women. If it is difficult to recruit experienced women enumerators, it usually makes sense to hold a special training for women candidates with less experience in order to ensure teams are balanced in the end.\n\n\n6 You must pre-test!\nThere are several different and necessary phases of pre-testing:\n\nThe first pre-test is for instrument clarity and is typically conducted by the researcher(s) or the wider survey team. This step involves a thorough review of the instrument after all the questions have been written—the focus here is on order, clarity, and flow.\nThe second phase of pre-testing focuses on the translated version of the instrument; the key concern is that the questions are easily understood by native speakers while retaining the meaning intended by the researcher. This is best done by a group of translators or members of your survey team, as it often it takes several people to discuss and settle upon the widely understood meaning of words and phrases. If you are translating into multiple languages, it’s important to have people from every language represented for consistency, working together to ensure consistency across versions. Fellow enumerators can work here, but it is better to recruit people of varying education levels.\nThe third phase of pre-testing ensures that respondents understand the intended meaning of each question and are comfortable responding. The best way to get at this is to observe enumerators conduct practice surveys in the field. You’ll want to get as close as you can to the real sample for this test, incorporating different subgroups within the real sample, e.g. men and women, more and less educated. Instruct enumerators on how to identify and record issues, so that they can describe them after to the PI and survey manager, but also observe these practice interviews first-hand. Key concerns are clarity and length: respondents should not become confused, tired, unfocused, or disinterested. You want to understand how the questions are understood by respondents and if enumerators are changing questions at all during the survey. This step will also, importantly, give the project team a good idea of how long the average survey should take, so you can adjust expectations of how many surveys can be done per enumerator per day.\n\n\n\n7 Training\n##Standards Trainings establish consistent standards for data collection. If you are contracting a survey firm and are not on the ground yourself, training is the most important part of the process to personally attend. It’s a key moment to communicate quality standards, expectations, the intended meaning of each question, and teach important procedures that may be more technical than what the firm is used to, such as a list experiment. It is also a key moment to motivate the team, by communicating the project’s goals and importance. In order to ensure that the each member of the team is prepared to a certain standard, it is a good idea to test each team member at the end of the training period. There should be an expectation that some team members will be asked not to proceed any further with the project as a result of the test, which will emphasize the importance of taking training to heart and taking the test seriously.\n##Assessment Trainings are a key moment for assessment as well. If you train teams together it is easy to spot management issues and leadership capabilities. A good practice is to train teams together, and select team leaders at the end of training—this gives you a few days to gauge skills and also incentivizes trainees to perform during the training.\n##Participation Trainings set the tone for the rest of fieldwork. Beyond communicating standards and expectations, this is also a key moment to create a culture of participation. Encouraging trainees to speak out about issues with the survey can show that you are open to feedback and increase the chances that they will report adverse events or challenges during the actual data collection.\nTraining sections:\n\nProtocol review, e.g. how to get permission to work in village/household, how to select respondent, etc.\nDiscussion of unforeseen contingencies, e.g. what happens when you get a refusal, when enumerators are targeted or threatened, when enumerators observe perverse reactions to or consequences of the survey\nQuestion by question review\nInterviewing techniques (rapport building, discussions)\nReview translated instrument\nUsing a PDA/tablet and conducting the interview on a PDA/tablet\nUsing GPS\nGroup practice (enumerators interview each other and get feedback)\nField practice– at least one day of training (or more for complicated or long surveys) should be spent interviewing real people who are similar to the survey subjects\nCertification exam\n\nTraining usually takes several more days than you expect. See below for a rough guide to realistic training schedules.\n\nList of documents needed for training:\n\nInstrument + translated instrument\nQuestion-by-question guide\nManual with expectations, instructions for filling responses, tips on interviewing etc.\nProtocol for sampling, consent, reporting, and unforeseen contingencies\n\nBefore being deployed to the field, each enumerator must:\n\nBe able to correctly list, sample and interview individuals in the enumeration area\nUnderstand their role\nUnderstand and correctly follow interviewing protocols\nBe informed about oversight procedures\nComplete an IRB-approved module on human subjects protection\n\nData from mock surveys must be individually assessed and feedback given to each enumerator. You can check whether certain enumerators are entering data differently than their peers, for example by entering lots of “Don’t know” or “Refuse” answers, finding low prevalence of sensitive behaviors, or entering data that is logically inconsistent. However, there is a lot that you can’t tell from the data alone. Spending a lot of time observing enumerators while they run surveys can greatly increase the quality of the data by improving their training, allowing you to select the best enumerators more accurately, and allowing you to understand how the questions are being implemented in the field.\n\n\n8 Employee incentives\nTo a large extent, the quality of the data collected is determined by the behavior the enumerators. Throughout the hiring, training, and field stages of the survey it is important to get the incentives right so that enumerators are motivated to do high quality work.\n##Expectations and Quality Control Expectations should be laid out clearly during training, in a manual, and reiterated in clearly worded contracts (signed after training).\nBasic expectations of enumerators:\n\nBeing on time\nAdhering to within-enumeration area sampling and replacement scheme\nGetting informed consent\nBuilding rapport with subjects\nAccurately recording responses\nCommunication with supervisors\n\n##Contracts and Payment As much as possible, make payment dependent on delivery. Enumerators have less and less incentive to stick with the project towards the end of fieldwork. The marginal returns are lower and they may be concerned about finding new work. In order to offset this, it is good practice to withhold a portion of their total salary (+/- 30%) until the end of fieldwork, and sometimes until data has been thoroughly reviewed if using paper instruments that need to be entered manually. At the same time, enumerators are often living paycheck to paycheck and may have expenses to cover during their long absence in the field. It is important to pay an advance up front to allow enumerators to take care of personal expenses that may otherwise make them anxious and unhappy during fieldwork. Having a strong local manager who understands the enumerators financial situations can help you create incentives while still making sure that they perceive the compensation structure as fair and adequate.\n##Soft Incentives Soft incentives help to keep teams happy and motivated throughout work. Some examples are:\n\nPerformance-based bonuses: Allowing managers to give performance-based bonuses for exceptional performance on a daily or weekly basis.\nCertificates: Survey trainings often involve learning portable skills, like the use of tablets or PDAs. Certificates can help enumerators prove to new employers that that they have these skills.\nLetters of Recommendation\nRecommendations to other survey firms, NGOs, etc.\nWrap party\n\n\n\n9 Map out your routes\nMake route plans that set the order in which enumeration areas [EAs] will be covered, and then assign teams to routes. The basic idea is to minimize transportation costs while taking into account regional differences in languages or dialects that could mean that only some teams can work in certain areas.\nA good way to visualize route plans is to mark sampled EAs on a map, using different colors to indicate different languages spoken in each EA. [SAMPLE PHOTO HERE]. Rely on team leaders to gauge travel time between sampled points and to suggest best routes.\n\n\n10 Checking the data\nWrite code to clean data and check for errors, and run it on available data as soon as possible. This code should check for nonsensical responses or patterns, both within and across instruments (enumerator error).\nIf you are using tablets or PDAs, you should begin to run the cleaning and error script on the incoming data as soon as interviewing begins. If you are not using PDAs/tablets, you’ll need to develop a procedure for checking the paper instruments in the field (the job of the team leader), and also begin checking and cleaning of entered data as soon as possible.\n##Checking data entered from paper instruments After interviewing the team leader needs to review all instruments for completeness and accuracy. If there are missing data or other inconsistencies, the team leader should send the enumerator back to revisit the respondent to correct all problems before leaving the area.\nOnce instruments are collected, data entry should commence as soon as possible. All data should be entered twice, and any discrepancies should be checked by a supervisor against the paper instrument.\n##Checking data gathered using PDAs or tablets When using tablets or PDAs, checking the data is the responsibility of the RA and PIs. In addition to using a script that checks for patterns and outliers, it is also best practice to record selected portions of the interview and listen to a subsample of responses, both for errors and quality.\n\n\n\n\n\nFootnotes\n\n\nThanks to Brandon de la Cuesta for help with this section↩︎"
  },
  {
    "objectID": "guides/getting-started/late_en.html",
    "href": "guides/getting-started/late_en.html",
    "title": "10 Things You Need to Know About the Local Average Treatment Effect",
    "section": "",
    "text": "Abstract\nSometimes a treatment or a program is delivered but for some reason or another only some individuals or groups actually take the treatment. In this case it can be hard to estimate treatment effects for the whole population. For example maybe people for whom the treatment would have had a big effect decided not to take up the treatment. In these cases it is still possible to estimate what’s called the “Local Average Treatment Effect,” or LATE. This guide1 discusses the LATE: what it is, how to estimate it, and how to interpret it.2\n\n\n1 What the LATE is\nWhen subjects do not receive the treatment to which they were assigned, the experimenter faces a “noncompliance” problem. Some subjects may need the treatment so badly that they will always take up treatment, irrespective of whether they are assigned to the treatment or to the control group. These are called “Always-Takers”. Other subjects may not take the treatment even if they are assigned to the treatment group: the “Never-Takers”. Some subjects are “Compliers”. These are the subjects that do what they are supposed to do: they are treated when assigned to the treatment group, and they are not treated when they are assigned to the control group. Finally, some subjects do the exact opposite of what they are supposed to do. They are called “Defiers”. Table 1 shows these four different types of subjects in the population.\n\nNoncompliance can make it impossible to estimate the average treatment effect (ATE) for the population. For example, say that in a population of 200, 100 people are randomly assigned to treatment and we find that only 80 people are actually treated. What is the impact of the treatment? One method to answer this question is simply to ignore the noncompliance and compare the outcome in the treatment (100 people) and control (100 people) groups. This method estimates the average intention-to-treat effect (ITT). (See our guide on different kinds of treatment effects for more on the ITT.) While informative, this method does not give a measure of the effect of the treatment itself. Another approach would be to compare the 120 really-untreated and 80 really-treated subjects. Doing so, however, might give you biased estimates. The reason is that the 20 subjects that did not comply with their assignment are likely to be a nonrandom subset of those that were assigned to treatment.\nSo what now? In some cases it is possible to estimate the “Local Average Treatment Effect” (LATE), also known as the “Complier Average Causal Effect” (CACE). The LATE is the average treatment effect for the Compliers. Under assumptions discussed below, the LATE equals the ITT effect divided by the share of compliers in the population.\n\n\n2 With one-sided noncompliance you need to satisfy an exclusion restriction to estimate the LATE\nThe example introduced above is termed one-sided noncompliance: 80% of the population respond to the treatment assignment (the “Compliers”) and 20% do not (the “Never-Takers”). Say that after the treatment, the experimenter measures the average outcome to be 50 in the treatment group and 10 in the control group. This situation is illustrated in Table 2. Note that only those indicated with blue in Table 2 were in fact treated.\n\nBefore we can calculate the LATE under one-sided noncompliance we need to make an assumption. The exclusion restriction (also called “excludability”) stipulates that outcomes respond to treatments, not treatment assignments. In normal words this simply means that the outcome for a Never-Taker is the same regardless of whether they are assigned to the treatment or control group: in both cases the subject is not treated, and that is what matters.\nBecause the treatment was randomly assigned, we know that if there are 20% Never-Takers in the treatment group (left column), there are probably about 20% Never-Takers in the control group. Because of the exclusion restriction, the Never-Takers have the same outcome under both assignment conditions, and thus the difference in average outcomes (40) cannot be attributed to the Never-Takers. We can thus attribute the entire ITT effect to the Compliers. The LATE can therefore be estimated by dividing the ITT estimate by the share of Compliers: 40/0.8 = 50.\n\n\n3 With two-sided noncompliance the LATE can be estimated assuming both the exclusion restriction and a “no defiers” assumption\nThe experimenter may also face two-sided noncompliance. In this case, some subjects in the treatment group go untreated and some in the control group receive the treatment. In this world, the population consists of the Compliers, the Never-Takers, the Always-Takers, and the Defiers. To estimate LATE under two-sided noncompliance we need a second assumption: that the population contains no Defiers (the assumption is also called the “monotonicity” assumption). To see the use of this assumption look at Table 3, which illustrates our example under two-sided noncompliance. Again, after the treatment the experimenter measures the average outcome to be 50 in the treatment group and 10 in the control group. Note that those subjects in blue were in fact treated.\n\nWith the exclusion restriction and the no Defiers assumption we can estimate the LATE. Because of the exclusion restriction, we can attribute the entire ITT effect to Compliers and not to Never-Takers or Always-Takers. Given that we have an estimate of the ITT effect (40), what remains is to estimate the share of Compliers in the population. (Table 3 shows the subjects’ types as seen by an omniscient deity. The experimenter cannot observe these types, but can estimate their shares, as explained below.)\nWe cannot observe whether any given subject is a Complier, but we do observe whether they took the treatment. In the treatment group, we observe that 90 people took the treatment (and thus must be either Compliers or Always-Takers) and 10 did not (and thus must be Never-Takers, since there are no Defiers). Thus, 10% of the treatment group are Never-Takers, and since treatment was assigned randomly, we estimate that about 10% of the control group are Never-Takers. Similarly, in the control group, we observe that 10 people took the treatment (and thus must be Always-Takers, since there are no Defiers) and 90 did not (and thus must be either Compliers or Never-Takers). Thus, 10% of the control group are Always-Takers, and we estimate that about 10% of the treatment group are Always-Takers. From all this, we can estimate the share of Compliers as 100% - 10% (Never-Takers) - 10% (Always-Takers) = 80%. Finally, we can estimate the LATE as 40/0.8=50.\n\n\n4 You can estimate the LATE using an instrumental variables approach\nThe LATE estimate is equivalent to an instrumental variables estimate. This is most easily illustrated following a set of regressions. Say that 50 individuals from a population of 100 are randomly assigned to treatment. Regressing treatment status (D) on the treatment assignment (Z) gives the estimated share of compliers: 80%. The ITT effect is estimated by regressing outcome Y on the assignment to treatment (Z). Again, LATE is estimated by dividing the ITT estimate by the estimated share of compliers. A researcher will get exactly the same results when running a two-stage least squares (2SLS) regression in which the outcome (Y) is regressed on the treatment (D), using the assignment to treatment as an instrumental variable (Z). This is shown in the code below.\n\nZ <- rep(0:1,50) # Assign 50 to treatment group (Z = 1), 50 to control group (Z = 0)\nD <- Z           # Compliers have D (treatment received) = Z (treatment assignment)\nD[1:10]  <- 0    # 10 Never Takers\nD[11:20] <- 1    # 10 Always Takers\nY        <- 50*D # Compliers have Y = 50 if treated, 0 if not treated\nY[1:10]  <- 100  # Never takers have high Y\nY[11:20] <- 0    # Always takers have low Y\n# Estimated share of compliers \nITTD <- coef(lm(D~Z))[2] \n# Estimated intention-to-treat effect\nITT  <- coef(lm(Y~Z))[2] \n# LATE estimate\nLATE <- ITT / ITTD\ncbind(Y_1 = mean(Y[Z==1]), Y_0=mean(Y[Z==0]), ITTD, ITT, LATE)\n\n  Y_1 Y_0 ITTD ITT LATE\nZ  50  10  0.8  40   50\n\n# library(AER) \nsummary(ivreg(Y~ D | Z)) \n\n\nCall:\nivreg(formula = Y ~ D | Z)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n   -55     -5     -5     -5     95 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)    5.000      5.660   0.883    0.379    \nD             50.000      8.839   5.657 1.53e-07 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 35.36 on 98 degrees of freedom\nMultiple R-Squared: -0.1136,    Adjusted R-squared: -0.125 \nWald test:    32 on 1 and 98 DF,  p-value: 1.528e-07 \n\n\n\n\n5 How to conduct statistical inference about the LATE\nBecause the LATE equals the ratio of the ITT and the share of Compliers, the LATE will be equal to zero whenever the ITT equals zero. To test the null hypothesis that the LATE is zero, you can thus rely on tests of the null hypothesis that the ITT is zero. This is a straightforward way to go if you would like to rely on randomization inference for hypothesis tests. (See our guides on hypothesis testing and randomization inference for more.) Alternatively, you can make use of the conventional standard errors and confidence intervals generated by instrumental variables regression, which rely on parametric assumptions about the sampling distribution. As a rule of thumb, the standard error of the CACE will be roughly equal to the standard error of the ITT divided by the share of Compliers.\n\n\n6 The LATE only reflects treatment effects among compliers\nWhile a LATE estimate is better than nothing, it provides a consistent estimate of the average treatment effect only for a subgroup of the population: the Compliers. It does not capture effects of the treatment among everyone in the experimental sample (ATE). For instance, Angrist and Evans (1998) study the effect of childbearing on a mother’s labor supply. In their paper, compliers account for only 6% of the total population, while we would like to know the effect for everyone, or at least for a larger subgroup of the population of interest.3 Whether or not only obtaining the effect for Compliers is problematic depends on an experimenter’s objectives. Sometimes the LATE is exactly what the researcher is interested in: the average effect on those that actually comply with the assignment to treatment. Moreover, LATE might not be very different from the ATE if the share of compliers is large and the treatment effects for the different types in the population are similar enough. To explore the latter, researchers can compare the background attributes of the Compliers and Never-takers in the treatment group. Another approach is to compare the average outcomes of Always-Takers and Compliers among those that are treated (those in blue in Table 3), and the average outcomes of Never-Takers and Compliers among those that are not treated.4 Finally, it is important to keep in mind that whether a subject is a Defier, Complier, Never-Taker or Always-Taker also depends on the experimental design and the context in which the experiment is conducted. For example, using phone calls instead of a monetary incentive to encourage treatment take-up can alter the share of compliers in the population. As a result, different instruments will estimate different LATEs.\n\n\n7 The LATE estimate is always larger than the ITT estimate\nThe LATE estimate is calculated as the intention-to-treat estimate (ITT) divided by the estimated share of Compliers in the population. With noncompliance, the share of Compliers in the population is smaller than one. As a result, the LATE estimate will always be larger than the ITT estimate. Another way to look at this is that following the exclusion restriction (reminder: the exclusion restriction states that the outcome for a Never-Taker or Always-Taker is the same regardless of whether they are assigned to the treatment or control group), the ITT effect for the Never-Takers and the Always-Takers is zero. Thus, given any positive number of Never and/or Always-Takers, the average ITT effect is smaller than the LATE.\n\n\n8 The LATE is an important estimand in “encouragement” designs and in downstream experiments\nEncouragement Designs: In an encouragement design, subjects are randomly invited to participate in the treatment. The reason to do so is that in some cases it might be unethical to make subjects adhere to the treatment assignment. In other cases, it might require unnecessarily large incentives to obtain adherence. As a result, in encouragement designs subjects self-select into treatment. For example, Hirano et al (2000) study the impact of a letter encouraging inoculation of patients at risk for flu, sent to a randomly selected set of physicians. The outcome of interest is an indicator for flu-related hospital visits. Needless to say, the incentives for the treatment (the letter) have only a limited effect on the actual treatment received (a flu shot by the physician), and thus the study population will consist of Compliers, Always-Takers, and Never-Takers. (We assume there are no Defiers, patients who would get the flu shot if and only if their physician did not get the letter.) It is thus easy to see how such an encouragement design corresponds to the two-sided noncompliance case.5\nDownstream experiments: Downstream experiments are studies in which an initial randomization (e.g. distribution of school vouchers) causes a change in an outcome (e.g. education level), and this outcome is then considered a treatment affecting a subsequent outcome (e.g. income).6 Also, these experiments correspond to our two-sided noncompliance setup. Noncompliance occurs because the random intervention is just one of many “encouragements” that cause people to take the treatment. Downstream experiments place particular pressure on the exclusion restriction, which requires that (following the example) school vouchers influences income only through higher education. This assumption would be violated if school vouchers affected income for reasons other than education.\n\n\n9 You can use a placebo-controlled design to identify the LATE\nAnother strategy to estimate the LATE involves designing your experiment in such a way that you can find out who the Compliers are even among those who did not receive the treatment. One way to do so is to create a placebo group that receives a version of the treatment without the treatment’s “active ingredient.” Gerber, Green, Kaplan, and Kern (2010), for example, study the effect of an automated phone call that delivers an encouragement to vote on whether study participants turn out to vote.7 The experiment included a placebo group in which study participants received automated phone calls that encouraged them to recycle. Because respondents in the placebo group also received calls, it is possible to observe which respondents in the placebo group answered the phone. Under the assumption that the content of the phone call does not affect who answers the phone, one can estimate the LATE by comparing turnout rates among those who answered the phone in the treatment group to turnout rates among those who answered the phone in the placebo group. The key assumption which makes this strategy work is that respondents who comply with the treatment (pick up the voting phone call) also comply with the placebo (pick up the recycling phone call) and vice versa. Gerber, Green, Kaplan, and Kern (2010) discuss the advantages of having both a pure control and a placebo group for estimating the LATE.\n\n\n10 Addressing partial compliance can be complicated\n“Partial compliance” occurs when a subject is assigned to a treatment but receives less than “all” of the treatment. This is possible in designs with compound treatments, multi-arm designs like factorial designs, and in dose-response trials where the treatment variable is continuous. For example, subjects assigned to a three-session job training program may only attend two of the three sessions. Patients in a clinical trial assigned to receive 100 mg dosages of an experimental drug once every week for five weeks may only receive four of the five assigned doses. Addressing partial compliance can be especially complicated because the effective number of treatment conditions exceeds the number intended in the original design. This expansion of the number of treatment conditions affects the definition of the LATE and how to estimate it. First, the number and definition of compliance statuses changes. The categories used in designs with a binary treatment (Always-Takers, Never-Takers, Compliers, and Defiers) no longer suffice. Instead, the set of possible compliance statuses is determined by all possible combinations of treatment assignment and treatment receipt. In the binary case, we ruled out Defiers. In the partial compliance case, we can make similar (design-specific) monotonicity assumptions that rule out some theoretically possible compliance statuses. Finally, we are no longer interested in a single LATE. Partial compliance means that the number of quantities we are trying to estimate increases. Unfortunately, the IV/2SLS estimator used under one- and two-way noncompliance in two-group designs is a biased estimator of LATEs under partial compliance. Instead, Bayesian approaches have emerged as an alternative method for inference.8\n\n\n\n\n\nFootnotes\n\n\nOriginating author: Peter van der Windt, 20 October 2014. Revisions: Winston Lin, 22 August 2016. The guide is a live document and subject to updating by EGAP members at any time; contributors listed are not responsible for subsequent edits. Thanks to Albert Fang for point 10.↩︎\nFor more extensive overviews, see: J. D. Angrist, G. W. Imbens, and D. B. Rubin (1996), “Identification of Causal Effects Using Instrumental Variables” (with discussion), Journal of the American Statistical Association 91: 444-472; J. D. Angrist (2006), “Instrumental Variables Methods in Experimental Criminological Research: What, Why and How,” Journal of Experimental Criminology 2: 23-44; J. D. Angrist and J.-S. Pischke (2009), Mostly Harmless Econometrics, sections 4.4-4.6 and 6.2; T. Dunning (2012), Natural Experiments in the Social Sciences; M. Baiocchi, J. Cheng, and D. S. Small (2014), “Instrumental Variable Methods for Causal Inference,” Statistics in Medicine 33: 2297-2340 (with correction in Statistics in Medicine 33: 4859-4860).↩︎\nAngrist, J. D. Evans, W. N. 1998. Children and their Parents’ Labor Supply: Evidence from Exogenous variation in family size. American Economic Review, 88(3), 450-477.↩︎\nSee: Imbens, G. W. (2010). Better LATE Than Nothing: Some Comments on Deaton (2009) and Heckman and Urzua (2009). Journal of Economic Literature, 48, 399-423. And Imbens, G. W., & Angrist, J. D. (1994). Identification and Estimation of Local Average Treatment Effects. Econometrica, 62(2), 467-475, and 2). And Imbens, G. W. & Wooldridge, J. 2007. Lecture notes and slides at: http://www.nber.org/minicourse3.html.↩︎\nHirano, K., Imbens, G.W., Rubin, D.B. & Zhou, X. (2000). Assessing the Effect of an Influenza Vaccine in an Encouragement Design. Biostatistics, 1(1), 69-88.]↩︎\nSee: Green, D. P. & Gerber, A. S. 2002. The Downstream Benefits of Experimentation. Political Analysis, Vol. 10(4), 394-402.↩︎\nSee Gerber, Alan S., Donald P. Green, Edward H. Kaplan, and Holger L. Kern. 2010. “Baseline, Placebo, and Treatment: Efficient Estimation for Three-Group Experiments.” Political Analysis, Vol.18(3), 297-315.↩︎\nSee Qi Long, Roderick J. A. Little, and Xihong Lin. 2010. Estimating Causal Effects in Trials Involving Multi-Treatment Arms Subject to Non-compliance: A Bayesian framework. Journal of the Royal Statistical Society: Series C (Applied Statistics), 59(3): 513-531.; Jin, H. & Rubin, D. B. (2009). Public schools versus private schools: Causal inference with Partial Compliance. Journal of Educational and Behavioral Statistics, 34, 24-45; Jin, H. & Rubin, D. B. (2008). Principal Stratification for Causal Inference with Extended Partial Compliance. Journal of the American Statistical Association, 103, 101-111.↩︎"
  },
  {
    "objectID": "guides/getting-started/latex_en.html",
    "href": "guides/getting-started/latex_en.html",
    "title": "10 Things to Know About Writing Academic Papers in LaTeX",
    "section": "",
    "text": "Writing is a time-consuming process; writing high-quality publications requires attention to detail at every step of the way, from the actual prose on paper to its layout in the document to the presentation of figures. In this guide we walk you through 10 aspects of writing a scientific article using LaTeX{target=“_blank”} to format your work and save you time. This is not an introduction to LaTeX.1 We emphasize typing commands at the unix command line in this guide as a way for you to peek under the hood of the LaTeX engine. This will give you (the author!) power over the production of your own academic documents.2\nThis guide could be even longer than it is. There are many, many fantastic resources on typesetting. Here we have hand-selected 10 topics to help lower the barrier to a more efficient and higher quality paper writing workflow. Specifically we focus on\nThe structure of a document\nWhat are all of these tools? tex, latex, pdflatex, xelatex, lualatex, etc.\nLaTeX happy workflows for your paper\ngit and version control\nJournal style\nOn writing, an interlude\nDos and Don’ts\nOn bibliographies\nOn figures\nHandy tools\nTo help people practice these commands we have hands-on examples ready in a JupyterLab{target=“_blank”} session, through Binder{target=“_blank”}. Here you can follow along, processing documents in a terminal session. You can start this environment here:\nBinder{target=“_blank”}\nTo use LaTeX on your own computer, you will need to install it{target=“_blank”} (we highly recommend following the links therein to TeX Live on each system). 1. Structure and Markup\nA LaTeX document (or a .tex file) is a plain text{target=“_blank”} document that contains commands that tell the LaTeX processing program how to create a beautiful pdf. These commands can be “markup” like for bold text or \\(\\alpha + \\beta \\frac{1}{x^2}\\) for math like\nor commands that tell LaTeX about document structure like\nor even commands to identify a bibliography like\n.\nOnce you have a plain text document with markup, you then process it using a set of programs to create a publishable output like a .pdf file. This figure shows an example of a LaTeX document and highlights different parts of the document and their role.\nThe Structure of a LaTeX document\nImagine we have a document called example.tex. After processing that document via, say, the command latexmk -pdflatex example.tex, one can see a pdf file like the following image:\n\nAbove see an image of the pdf document associated with the example.tex file in the 1_structure subdirectory.\\label{fig:struct_image}{ style=“width: 50%; margin: auto; text-align: center; border: 1px;” } Takeaways\nA LaTeX document contains mainly two sections: 1) a preamble, which defines the styling and defines title and author, and 2) the document text.\nThe LaTeX system separates concerns having to do with writing from concerns having to do with format. It allows you to focus on writing content in a plain text document, followed by processing to make a nice pdf file including automatically formatted citations, bibliography, cross-references, figures, tables, etc.\nProcessing the typed document delivers a layout that automatically handles spacing (as we will see later).\nPractice\nWhat does example.tex look like when compiled to a pdf document? Can you add a title or author? Can you make some text bold?3 You can practice by following these steps (and similar ones) in later sections:\nselect the directory 1_structure in the JupyterLab window that launches when you clink on launch binder above or here: Binder{target=\"_blank\"}\nThen clicking on the Terminal icon in the JupyterLab pane\nType ls. If you see a list of directories like adaptive, you need to change directories to the latex-guide/1_struture so you should type (or paste) cd latex-guide/1_structure. Now try ls again. You should should see files like example.tex.\nOnce you are there, try typing latexmk -pdf example.tex and then looking at the pdf (you can click on it in the right-hand sidebar).\nYou can also copy the GitHub repository for the EGAP methods guides or just the subdirectory for latex-guide to your own local machine and launch the Terminal to see a Unix command prompt if you are using a Mac{target=“_blank”} or Linux machine. Windows machines also offer a Unix command prompt, but it is a bit more involved to install it{target=“_blank”}. 2. Flavors and Programs: tex, latex, pdflatex, etc\nAlthough the most basic program that parses markup is called latex, in current daily use, you will mostly find yourself using pdflatex or even xelatex or maybe lualatex.\nWhen Donald Knuth{target=“_blank”} created this approach to making beautiful scientific documents, he started with the tex program but Leslie Lamport{target=“_blank”} built latex by combining multiple tex commands into fewer and simpler macros. Both originally created documents in dvi or postscript format. Nowadays, pdf files are the best way to make a document that looks the same to all who want to view it on their screens or print it for themselves.\nHere is a list of the common programs that one might use to create a pdf file from a latex document:\ntex: a program that typesets TeX directives or macros\npdftex: a program that generates a PDF (instead of DVI)\nlatex: a program that typesets a pile of LaTeX directives and macros\npdflatex: a program that generates a PDF from LaTeX\nbibtex: a program to take bibliographic information from a .aux file (created by a run of latex or pdflatex etc.) and generates a bibliography\nbiber: a program like bibtex but with more database management capabilities\nxelatex: support for a wide variety of fonts and characters (you can type xelatex example.tex after changing the font to one that is installed on your system)\nlualatex: extends latex so that more programming can be done within it (via Lua for more complicate document designs and workflows. See here for more on lualatex{target=\"_blank\"})\nFor example, at the command prompt in the Terminal, you might type pdflatex example.tex to create an example.pdf file.\nNotice also:\npdflatex (or xelatex or lualatex) takes several passes --- it must be run more than one time --- if your document involves citations or other more complex features (like cross-references, tables of contents, etc.). In the example above, if you only create example.pdf once, the citation will show up as a ? and no bibliography will be printed.\nTools like latexmk or latexrun automate this process of multiple passes by a latex processing program and a bibliography creation program.\nThe following figure shows how it may require three runs of pdflatex (plus a run of bibtex) to go from an example.tex file to an example.pdf file:\nFrom LaTeX to PDF commands \nYou can replace those multiple lines with a single call to latexmk -pdflatex example.tex. Takeaways\nAlways use LaTeX markup: very rarely (if ever) should you need to dip into plain TeX\nAlways use PDF output (pdflatex) and PDF figures (or PNG ... more on this later) rather than DVI or PS format for sharing generated documents\nWe recommend using tools like latexmk to automate the process of repeatedly using both pdflatex and bibtex (or biber for those using biblatex) to process a file.\nPractice\nSee the directory 2_texflavors and the readme.md file therein. Can you change the font and use xelatex to make a pdf, say, trying latexmk -xelatex example.tex? You may need to use the unix cd (change directory) command to move from 1_structure to 2_texflavors by typing cd ../2_texflavors (this means “change directory to 2_texflavors which is one above my current directory in the directory hierarchy”. 3. LaTeX workflows\nA given scientific paper will require many files and often involves many authors. For example, a single paper will often use several .tex files (for different sections), multiple figures (in .pdf form), and bibliographies (in .bib files). Further, each figure might depend on a pipeline of raw data and code. Organizing these files in a consistent fashion will lead to a clear process when dealing with revisions later.\nFor example a main.tex file might look like this:\n\n\nFootnotes\n\n\nWe suggest the Free online introduction to LaTeX{target=“_blank”} if you are brand new to LaTeX.↩︎\nWe have decided to write this guide in a very opinionated way. And we emphasize the nitty gritty of technical document creation. If these opinions inspire a reader to write a 10 Things Guide on using Markdown or Google Docs, please do write one! As an open-source document, we are also happy to receive pull requests for improvements to this guide.↩︎\nTry out ↩︎"
  },
  {
    "objectID": "guides/getting-started/measurement_en.html",
    "href": "guides/getting-started/measurement_en.html",
    "title": "10 Things to Know About Measurement in Experiments",
    "section": "",
    "text": "1. The validity of inferences we draw from an experiment depend on the validity of the measures used.\nWe typically experiment in order to estimate the causal effect of a treatment, \\(Z\\), on an outcome, \\(Y\\). Yet, the reason that we care about estimating this causal effect is, in principle, to understand characteristics of the relationship between two theoretical, unobserved, concepts measured by observed variables \\(Z\\) and \\(Y\\).\nFollowing Adcock and Collier (2001), consider the measurement process graphed in Figure 1 in three steps. First, researchers begin with systematized concept, a clearly-defined theoretical construct. From this concept, the researcher develops an indicator mapping the concept onto a scale or a set of categories. Finally, units or cases are scored on the indicator, yielding a measurement of treatment, \\(Z\\) and an outcome \\(Y\\). A measurement is valid if variation in the indicator closely approximates variation in the underlying concept of interest.\nAn experimental research design should allow a researcher to estimate the causal effect of \\(Z\\) on \\(Y\\) under standard assumptions. But if the ultimate goal is to make an inference about causal effect of the concept that \\(Z\\) measures on the concept that \\(Y\\) measures, the inferences that we can hope to make on the basis of our experimental evidence are valid if and only if both measures are valid.\n\n\n\n\n\nThe process of measurment in the context of an experimental research design.\n\n\n\n\n\n\n2. Measurement is the link between a researcher’s substantive and/or theoretical argument and an (experimental) research design.\nWhen we consider the design of an experiment, we tend to focus on the process by which the randomly assigned treatment, \\(Z\\) is assigned and the joint distribution of \\(Z\\) and an outcome, \\(Y\\). In other words, we tend to divorce scores of \\(Z\\) and \\(Y\\) from broader concepts when considering the statistical properties of a research design. In this telling, two completely separate experiments with the same distribution of \\(Z\\) and \\(Y\\) could have identical properties.\nFor example, a clinical trial on the efficacy of aspirin on headaches and an experiment that provides information on an incumbent politician’s level of corruption and then asks the respondent if she will vote for the incumbent could have identical sized and distributed samples, assignments, estimands, and realizations of outcomes (data). Yet, this characterization of two completely distinct research projects that seek to make completely distinct inferences as “equivalent” may strike us as quite strange or even unsettling.\nHowever, when we consider measurement as a fundamental component of research design, clearly these experiments are distinct. We observe measures of different concepts in the data for the two experiments. By considering the indicators and the broader concepts underlying the treatments and outcomes, we are forced to examine the researchers’ respective theories or arguments. In so doing, we can raise questions about the validity of the measures and the relationship between the validity of the measures and the validity of final, substantive, inferences.\n\n\n3. Measuring treatments includes the operationalization of treatment as well as compliance with treatment assignment.\nIn an experiment, treatments are typically designed, or at a minimum, described, by the researcher. Consumers of experimental research should be interested the characteristics of the treatment and how it manipulates a concept of interest. Most treatments in social science are compound, or include a bundle of attributes. We may be interested in the effect of providing voters with information on their elected officials’ performance. Yet, providing information also includes the mode of delivery and who was delivering the information. To understand the degree to which the treatment manipulates a concept, we must also understand what else the treatment could be manipulating.\nHowever, despite all the effort operationalizing a treatment, in experimental research, the link from the operationalization to the treatment indicator is fundamentally distinct from measurement of covariates or outcomes for two reasons. First, by assigning treatment, experimenters aim to control the values a given unit takes on. Second, for the treatment indicator, the score comes from assignment to treatment, which is a product of the randomization. A subject may or may not have received the treatment, but her score on the treatment indicator is simply the treatment that she was assigned to, not the treatment she received.\nWhen subjects receive treatments other than those to which they are assigned, we typically seek to measure compliance — whether the treatments were delivered and to what extent. To do so, we define what constitutes compliance with treatment assignment. In determining what constitutes compliance, researchers should consider the core aspect of how the treatment manipulates the concept of interest. At what point in the administration of the treatment does this manipulation occur? Once compliance is operationalized,we seek to code the compliance indicator in a manner faithful to this definition.\nFor example, consider a door-to-door canvassing campaign that distributes information about the performance of an incumbent politician. Households are assigned to receive a visit from a canvasser who shares the information (treatment) or no visit (control). The treatment indicator is simply whether a household was assigned to the treatment or not. However, if residents of a household are not home when the canvasser visits, they do not receive the information. Our definition of compliance should determine what constitutes “treated” on our (endogenous) measure of whether a household received the treatment, here the information. Some common definitions of compliance may be (a) that someone from the household answered the door; or (b) that someone from the household listened to the full information script.\n\n\n4. Most outcomes of interest in social science are latent.\nIn contrast to measuring treatment indicators and compliance, measuring outcomes in experimental research follows much more closely the process outlined in the figure above. We theorize how the treatment may influence an outcome concept. We then operationalize the concept and record scores or values to complete our measurement of the outcome.\nOne particular challenge in the measurement of outcomes is that many of the most common outcomes of interest in social science are latent. This means that we are unable to observe the true value of the outcome concept directly. In fact, the nature of the true value may itself be under debate (for example, the debate about the measurement of “democracy” is a classic case where the definition of the concept itself is contested). Outcomes including knowledge, preferences, and attitudes are latent. We thus record or score observable indicators assumed to be related to the latent outcome in an effort to infer characteristics of the latent variable. Even behavioral outcomes are often used as manifestations of larger latent concepts (i.e. assessed voting behavior is used to make inferences about “electoral accountability” in a place).\nBecause these variables are latent, it is challenging to devise appropriate indicators. Poor operationalization has rather drastic consequences for the validity of our inferences about the concept of interest for two reasons. As in section #1 above, if these indicators do not conceptually measure the concept of interest, then inferences we make about the relationship between \\(Z\\) and \\(Y\\) (even with a “perfect” design in terms of statistical power and missing data,etc.) may not teach us about the “ultimate inference” we are seeking to make. Furthermore, measurement error may undermine our ability to estimate the effect of \\(Z\\) and \\(Y\\) leading to incorrect inferences. The remainder of this guide focuses on the latter problem.\n\n\n5. There are two types of measurement error that we should consider.\nWe can formalize measurement challenges quite simply. Suppose a treatment, \\(Z_i\\) is hypothesized to change preferences for democratic norms, \\(\\nu_i\\). In principle, the quantity that we would like to estimate is \\(E[\\nu_i|Z_i = 1] - E[\\nu_i|Z_i =0]\\), the ATE of our treatment on preferences for democratic norms. However, \\(\\nu_i\\) is a latent variable: we cannot measure it directly. Instead we ask about support for various behaviors thought to correspond to these norms. This indicator, \\(Y_i\\), can be decomposed into the latent variable, \\(\\nu_i\\) and two forms of measurement error:\n\nNon-systematic measurement error, \\(\\delta_i\\): This error is independent of treatment assignment, \\(\\delta_i \\perp Z_i\\).\nSystematic measurement error, \\(\\kappa_i\\): This error is not independent of treatment assigniment, \\(\\kappa_i \\not\\perp Z_i\\).\n\n\\[Y_i = \\underbrace{\\nu_i}_{\\text{Latent outcome}} + \\underbrace{\\delta_i}_{\\substack{\\text{Non-systematic} \\\\ \\text{measurement error}}} + \\underbrace{\\kappa_i}_{\\substack{\\text{Systematic} \\\\ \\text{measurement error}}}\\]\n\n\n6. Measurement error reduces the power of your experiment.\nNon-systematic measurement error, represented by \\(\\delta_i\\) above, refers to the noise with which we are measuring the latent variable. In the absence of systematic measurement error, we measure:\n\\[Y_i = \\underbrace{\\nu_i}_{\\text{Latent outcome}} + \\underbrace{\\delta_i}_{\\substack{\\text{Non-systematic} \\\\ \\text{measurement error}}}\\]\nNow, consider the analytical power formula for a two-armed experiment. We can express \\(\\sigma\\), or the standard deviation of the outcome as \\(\\sqrt{Var(Y_i)}\\). Note that in the formula below, this term appears in the denominator of the first term. As \\(\\sqrt{Var(Y_i)}\\) increases, statistical power decreases.\n\\[\\beta = \\Phi \\left(\\frac{|\\mu_t− \\mu_c| \\sqrt{N}}{2 \\color{red}{\\sqrt{Var(Y_i)}}} − \\Phi^{−1}\\left(1 − \\frac{\\alpha}{2}\\right)\\right)\\]\nIn what way does non-systematic measurement error \\(\\delta_i\\) impact power? We can decompose \\(\\sqrt{Var(Y_i)}\\) as follows:\n\\[\\sqrt{Var(Y_i)} = \\sqrt{Var(\\nu_i) + Var(\\delta_i) + 2 Cov(\\nu_i, \\delta_i)}\\]\nSo long as \\(Cov(\\nu_i, \\delta_i)\\geq 0\\) (we often assume \\(Cov(\\nu_i, \\delta_i)= 0\\)), it must be the case that the \\(Var(Y_i)\\) is increasing as measurement error, or \\(Var(\\delta_i)\\) increases. This implies that power is decreasing as non-systematic measurement error increases. In other words, the noisier our measures of a latent variable, the lower our ability to detect effects of a treatment on a latent variable.\nWhat about the case in which \\(Cov(\\nu_i, \\delta_i) < 0\\)? While this reduces \\(Var(Y_i)\\) (holding \\(Var(\\nu_i)\\) and \\(Var(\\delta_i)\\) constant), it also attenuates the variation that we measure in \\(Y_i\\). In principle, this should attenuate the numerator \\(|\\mu_t-\\mu_c|\\), which, if sufficient relative to the reduction in variance, will also reduce power.\n\n\n7. Systematic measurement error biases estimates of causal effects of interests.\nIf we are estimating the Average Treatment Effect (ATE) of our treatment \\(Z_i\\), on preferences for democratic norms, \\(\\nu_i\\), we are trying to recover the ATE, or \\(E[\\nu_i|Z_i = 1] - E[\\nu_i|Z_i =0]\\). However, in the presence of systematic measurement error, where measurement error is related to the treatment assignment itself (say, the outcome is measured differently in the treatment group than in the control group) a difference-in-means estimator on the observed outcome, \\(Y_i\\), recovers a biased estimate of the ATE. The effect of the treatment now includes the measurement difference as well as the difference between treated and control groups:\n\\[E[Y_i|Z_i = 1]−E[Y_i|Z_i = 0] =  E[\\nu_i + \\delta_i + \\kappa_i |Z_i = 1] − E[\\nu_i + \\delta_i + \\kappa_i|Z_i =0]\\] Because non-systematic measurement error, \\(\\delta_i\\) is independent of treatment assignment, \\(E[\\delta_i|Z_i = 1] = E[\\delta_i |Z_i = 0]\\). Simplifying and rearranging, we can write:\n\\[E[Y_i|Z_i = 1]−E[Y_i|Z_i = 0] = \\underbrace{E[\\nu_i|Z_i = 1] − E[\\nu_i|Z_i =0]}_{ATE} +\n\\underbrace{E[\\kappa_i|Z_i = 1] - E[\\kappa_i|Z_i =0]}_{\\text{Bias}}\\]\nThere are various sources of non-systematic measurement error in experiments. Demand effects and Hawthorne effects can be motivated as sources of systematic measurement error. Moreover, designs that measure outcomes asymmetrically in treatment and control groups may be prone to systematic measurement error. In all cases, there exists asymmetry across treatment conditions in: (a) the way that subjects respond to being observed; or (b) the way that we observe outcomes that is distinct from any effect of the treatment on the latent variable of interest. The biased estimate of the ATE becomes the net of any effects on the latent variables (the ATE) and the non-systematic measurement error.\nWhen designing an experiment, researchers can take various steps to limit systematic measurement error. First and foremost, they can attempt to use identical measurement strategies across all experimental groups. To limit demand and Hawthorne effects, researchers often aim to design treatments and measurement strategies that are as naturalistic and unobtrusive as possible. For example, sometimes it can be beneficial to avoid baseline surveys at the outset of an experiment that would reveal the purpose of a study to participants. Researchers may also want to separate treatment from outcome measurement phases to limit the apparent connection between the two. Ensuring that study staff are blind towards the treatment status of study participants can also help maintain measurement symmetry across treatment conditions. The use of placebo treatments sometimes helps to hide their treatment status even from study participants themselves. Finally, researchers sometimes supplement outcome measures such as survey questions that are particularly susceptible to demand effects with behavioral measures for which experimenter demand may be less of a concern. See de Quidt et al. (2018) for a way to assess the robustness of your experimental results to demand effects.\n\n\n8. Leverage multiple indicators to assess the validity of a measure but be aware of the limitations of such tests.\nBeyond consideration of the quality of the mapping between a concept and a measure, we can often assess the quality of the measure by comparing it to measures from alternate operationalizations of the same concept, closely related concepts, or distinct concepts. In convergent tests of the validity of a measure, we assess the correlation between alternate measures of a concept. If they are coded in the same direction, we expect the correlation to be positive and validity of both measures increases as the magnitude of the correlation increases. One limitation of convergent tests of validity is if two measures are weakly correlated, absent additional information, we do not know whether one measure is valid (and which) or whether both measures are invalid.\nGathering multiple indicators may also allow for researchers to assess the predictive validity of a measure. To what extent does a measure of a latent concept predict behavior believed to be shaped by the concept? For example, does political ideology (the latent variable) predict reported vote choice for left parties? This provides an additional means of validating a measure. Here, the higher the ability of an indicator to predict behavior (or other outcomes), the stronger the predictive validity of the indicator. Yet, we believe that most behaviors are a result of a complex array of causes. Determining whether a measure is a “good enough” predictor is a somewhat arbitrary determination.\nFinally, we may want to determine whether we are measuring the concept of interest in isolation rather than a bundle of concepts. Tests of discriminant validity look at indicators of a concept and a related but distinct concept. In principle, we look for low correlations (correlations close to 0) between both indicators. One limitation of tests of discriminant validity is that we don’t know how underlying distinct concepts covary. It may be the case that we have valid indicators of both concepts, but they exhibit strong correlation (positive or negative) because units with high levels of \\(A\\) tend to have higher (resp. low) levels of \\(B\\).\nIn sum, the addition of more measures can help validate an indicator, but these validation tests are limited in what they tell us when they fail. To this extent, we should remain cognizant of the limitations in addition to the utility of collecting additional measures to simply validate an indicator.\n\n\n9. The use of multiple indicators often improves the power of your experiment, but may introduce a bias-efficiency tradeoff.\nGathering multiple indicators of a concept or outcome may also improve the power of your experiment. If multiple indicators measure the same concept but are measured with (non-systematic) error, we can improve the precision with which we measure the latent variable by leveraging multiple measures.\nThere are multiple ways to aggregate multiple outcomes into an index. “10 Things to Know about Multiple Comparisons” describes indices built from \\(z\\)-score and inverse covariance weighting of multiple outcomes. There are also many other structural models for estimating latent variables from multiple measures.\nBelow, we look at simple \\(z\\)-score index of two noisy measures of a latent variable. We assume that the latent variables and both indicators “Measure 1” and “Measure 2” are drawn from a multivariate normal distribution and are positively correlated with the latent variable and with each other. For the purposes of simulation, we assume that we know the latent variable, though in practice this is not possible. First, we can show that across many simulations of the data, the correlation between the \\(z\\)-score index of the two measures and the latent variable is, on average, higher than the correlation between either of the indicators and the latent variable. When graphing the correlation of the individual measures and the latent variable against (\\(x\\)-axes) the correlation of the index and the latent variable (\\(y\\)-axis), almost all points are above the 45-degree line. This shows that the index approximates the latent variable with greater precision.\n\nlibrary(mvtnorm)\nlibrary(randomizr)\nlibrary(dplyr)\nlibrary(estimatr)\nmake_Z_score <- function(data, outcome){\n  ctrl <- filter(data, Z == 0)\n  return(with(data, (data[,outcome] - mean(ctrl[,outcome]))/sd(ctrl[,outcome])))\n}\npull_estimates <- function(model){\n  est <- unlist(model)$coefficients.Z\n  se <- unlist(model)$std.error.Z\n  return(c(est, se))\n}\ndo_sim <- function(N, rhos, taus, var = c(1, 1, 1)){\n   measures <- rmvnorm(n = N, \n                       sigma = matrix(c(var[1], rhos[1], rhos[2], \n                                        rhos[1], var[2], rhos[3], \n                                        rhos[2], rhos[3], var[3]), nrow = 3))\n   df <- data.frame(Z = complete_ra(N = N),\n                      latent = measures[,1],\n                      Y0_1 = measures[,2],\n                      Y0_2 = measures[,3]) %>%\n            mutate(Yobs_1 = Y0_1 + Z * taus[1],\n                   Yobs_2 = Y0_2 + Z * taus[2])\n   df$Ystd_1 = make_Z_score(data = df, outcome = \"Yobs_1\")\n   df$Ystd_2 = make_Z_score(data = df, outcome = \"Yobs_2\")\n   df$index = (df$Ystd_1 + df$Ystd_2)/2\n   cors <- c(cor(df$index, df$latent), cor(df$Ystd_1, df$latent), cor(df$Ystd_2, df$latent))\n   ests <- c(pull_estimates(lm_robust(Ystd_1 ~ Z, data = df)),\n             pull_estimates(lm_robust(Ystd_2 ~ Z, data = df)),\n             pull_estimates(lm_robust(index ~ Z, data = df)))\n   output <- c(cors, ests)\n   names(output) <- c(\"cor_index\", \"cor_Y1\", \"cor_Y2\", \"est_Y1\", \"se_Y1\",\n                      \"est_Y2\", \"se_Y2\", \"est_index\", \"se_index\")\n   return(output)\n}\nsims <- replicate(n = 500, expr = do_sim(N = 200, \n                                         rhos = c(.6, .6, .6), \n                                         taus = c(.4, .4),\n                                         var = c(1, 3, 3)))\ndata.frame(measures = c(sims[\"cor_Y1\",], sims[\"cor_Y2\",]),\n           index = rep(sims[\"cor_index\",], 2),\n           variable = rep(c(\"Measure 1\", \"Measure 2\"), each = 500)) %>%\n  ggplot(aes(x = measures, y = index)) + geom_point() + \n  facet_wrap(~variable) + \n  geom_abline(a = 0, b = 1, col = \"red\", lwd = 1.25) + \n  scale_x_continuous(\"Correlation between measure and latent variable\", limits = c(0.1, .6)) +\n  scale_y_continuous(\"Correlation between index and latent variable\", limits = c(0.1, .6)) + \n  theme_minimal()\n\n\n\n\nNow, consider the implications for power. In the simulations, we estimate of the ATE of a treatment on Measure 1, Measure 2, and the index. The following graph visualizes the estimates. The blue lines show 95 percent confidence intervals. The smaller confidence intervals about the index visualize the precision gains from leveraging both measures. We see that this manifests in higher statistical power for the experiment.\n\ndata.frame(est = c(sims[\"est_index\",], sims[\"est_Y1\",], sims[\"est_Y2\",]),\n           se = c(sims[\"se_index\",], sims[\"se_Y1\",], sims[\"se_Y2\",]),\n           outcome = rep(c(\"Index\", \"Measure 1\", \"Measure 2\"), each = 500)) %>%\n  mutate(T = est/se, \n         sig = 1 * (abs(T) > 1.96)) %>%\n  group_by(outcome) %>%\n  mutate(power = sum(sig)/n(),\n          lab = paste0(\"Power = \", round(power, 2))) %>%\n  arrange(est) %>%\n  mutate(order = 1:500/500) %>%\n  ggplot(aes(x = order, y = est)) + \n  geom_errorbar(aes(ymin = est - 1.96 * se, ymax = est + 1.96 * se), width = 0,\n                col = \"light blue\", alpha = .25) +\n  geom_point() +\n  facet_wrap(~outcome) +\n  geom_text(x = 0.5, y = -.4, aes(label = lab), cex = 4) +\n  geom_hline(yintercept = 0, col = \"red\", lty = 3) + \n  theme_minimal() + xlab(\"Percentile of Estimate in 500 simulations\") + \n  ylab(\"ATE\")\n\n\n\n\nWe have examined an index composed of just two indicators. In principle, there are further efficiency gains to be made by incorporating more indicators into your index. Yet, as we increase the number of indicators, we should consider the degree to which the amalgamation of indicators adheres to the original concept. By adding measures to leverage efficiency gains, we may introduce bias into the measure of the latent concept. Researchers must navigate this tradeoff. Pre-registration of the components of an index provides one principled way to navigate the issue which forces thorough consideration of the concept in the absence of data. This also avoids the ex-post questions about the choice of indicators for an index.\n\n\n10. While concepts may be global, many indicators are context-specific.\nMany studies in the social sciences focus on concepts that are typically assumed to be latent including preferences, knowledge, and attitudes. To the extent that we work on common concepts, there is a tendency to draw from existing operationalizations from studies on related concepts in different contexts. In studies in multiple contexts, as in EGAP’s Metaketa Initiative, researchers aim to study the same causal relationship in multiple national contexts. But a desire to study common concepts need not imply that the same indicators should be used across contexts.\nFor example, consider a set of studies that seek to measure variation in the concept of political knowledge or sophistication. Political knowledge may be assessed through questions that ask subjects to recall a fact about politics. One question may ask subjects to recall the current executive’s (president/prime minister etc.) name, scoring answers as “correct” or “incorrect.” In country \\(A\\), 50% of respondents answer the question correctly. In Country \\(B\\), 100% of respondents answer the question correctly. In Country \\(B\\), we are unable to identify any variation in the indicator because everyone could answer the question. This does not imply that there is no variation in political knowledge in Country \\(B\\), just that this indicator is a poor measure of the variation that exists. In Country \\(A\\), however, this question may be a completely appropriate indicator of political knowledge. If political knowledge was the outcome of an experiment, the lack of variation in the outcome in Country \\(B\\) fails to allow us to identify any difference in political knowledge between treatment and control groups.\nFor this reason, while it may be useful to develop indicators based on existing work or instruments from other contexts, this is not necessarily the best way to develop measures in a new context. Pre-testing can provide insights into whether indicators are appropriate in a given setting. In sum, the mapping between concepts and indicators is site-specific in many cases. Researchers should consider these limitations when operationalizing common concepts in distinct settings.\n\n\nBibliography\nAdcock, Robert and David Collier. “Measurement Validity: A Shared Standard for Qualitative and Quantitative Research.” American Political Science Review. 95 (3): 529-546.\nde Quidt, Jonathan, Johannes Haushofer, and Christopher Roth. 2018. “Measuring and Bounding Experimenter Demand.” American Economic Review. 108 (11): 3266-3302."
  },
  {
    "objectID": "guides/getting-started/mechanisms_en.html",
    "href": "guides/getting-started/mechanisms_en.html",
    "title": "10 Things to Know About Mechanisms",
    "section": "",
    "text": "As social scientists, we are fascinated by causal questions. As soon as we learn that X causes Y, we want to better understand why X causes Y. This guide explores the role of “mechanisms” in causal analysis and will help you to understand what kinds of conclusions you may draw about them.\n\nMechanisms are pathways through which X causes outcome Y.\nMechanisms have long been at the heart of medicine. Every time a doctor prescribes a treatment, she does so out of an understanding of which chemical or physical factors cause a disease, and she prescribes a treatment that is effective because it interrupts these factors. For example, many clinical psychologists recommend exercise to patients dealing with depression. Exercise raises endorphins in the body’s chemistry, which trigger positive feelings and also act as analgesics, which reduce the perception of pain. Endorphins, therefore, are a mechanism by which exercise helps reduce depression. Exercise may have positive effects on a number of other dependent variables (e.g. heart disease) through other mechanisms (e.g. elevating heart rates), but the mechanism that causes it to affect depression in particular is endorphins. We could also conclude that another treatment, such as a drug that raised endorphins, may have similar effects on depression.\nMechanisms are just as important for social sciences. Take, for example, recent research that has connected climate change to an increase in civil conflict. One study1 claims to identify the causal effect of climate shocks on violent conflict by studying the rate of civil conflict in El Nino-affected countries during El Nino versus non-El Nino years. Suppose this study is correct. Why would experiencing a climate shock cause a country to have elevated levels of conflict? One mechanism could be poverty: climate shocks hurt the economy, and with lower opportunity costs, individuals are more inclined to join armed groups. An alternative mechanism is physiological: people are physically wired to be more aggressive in hotter temperatures. Perhaps the mechanism is migration: climate shocks displace people in coastal regions, and this produces social conflict between migrants and natives. In reality, several or all of these mechanisms (as well as others not listed here) could be operating simultaneously, even in the same case! In many of the most interesting social science questions, there are several channels (“M”s) that could transmit the total effect of X on Y.\n\n\nWhile we don’t need to know the mechanism to conclude that X causes Y, there are several reasons why we want to.\nIn the climate/conflict example above, we can have full confidence in the researchers’ ability to causally identify that climate shocks cause conflict, and yet have no evidence of which mechanism(s) is/are at work. But social scientists are interested in learning about mechanisms because they tightly relate to social science theories. For example, the “poverty” mechanism above closely relates to Gurr’s2 theory that individuals rebel when their opportunity costs of conflict are low, whereas the “migration” mechanism could support a theory of conflict based on grievances between social groups. It is no wonder that upon learning that X causes Y, social scientists immediately ask what the mechanism is – they want to relate this finding to theory!\nUnderstanding mechanisms has not only theoretical but practical benefits. First, knowing M allows us to guess for which populations X will lead to Y. If the mechanism for climate/conflict is physiological response to heat, then climate shocks may produce conflict only when temperature is quite warm. Second, knowing M helps us to consider other outcomes that may be affected by X. If the mechanism for climate/conflict is migration, then we might also expect climate shocks to result in overuse of public goods in urban areas. Third, knowing M helps us to consider other ways to cause or avoid causing changes in Y. If the mechanism for climate/conflict is poverty, then development programs could decrease conflict by reducing the sensitivity of incomes to climate shocks, even though they can’t change climate shocks.\n\n\nBut it is extremely challenging to identify causal mechanisms because the mechanisms themselves are not randomly assigned…\nConsider an experimental example. Chong et al. (2015)3 used a field experiment to study the effect of corruption information on voter turnout. They randomly assigned some polling precincts in Mexico to receive information about the corrupt use of funds within that municipality. Surprisingly, they found that treated precincts turned out to vote at lower rates than control precincts. They suggest the following mechanism at work: corruption information convinces voters that the municipality is so severely corrupt that electing a good politician will not change it, so individuals find their vote to carry less value.\nIn short, their argument is:4\nReceiving corruption information (X) \\(\\xrightarrow{+}\\) Believes corruption too severe (M) \\(\\xrightarrow{+}\\) Stay home (Y)\nChong et al. face a common obstacle in interpreting their results: their proposed mechanism was not randomly assigned. Some people are more inclined to believe that “all politicians are rascals” while others have a tendency to push for “change we can believe in.” Unfortunately, we can observe only the random treatment an individual received and their non-random belief about corruption; we can’t tell what belief about corruption they would have had if they had received the other treatment condition. This makes it impossible for us to determine, for each individual, the extent to which her decision to turn out to vote was caused by the proposed mechanism versus other mechanisms.\nSome researchers try to get around this problem by estimating the average effect of the treatment on the mechanism and then estimating the average effect of the mechanism on the outcome. One reason that this is problematic is that we can imagine several factors other than the treatment that could be causing both M and Y. Suppose that the level of apathy – let’s call it Q – varies among the citizens in our study, and Q has a very strong effect on both M and Y. Highly apathetic individuals might be more likely to believe that problems are beyond solving, and they might also be more likely to stay at home on election day. We are therefore likely to observe a strong correlation between M and Y that is driven by the confounder of Q, not by our treatment X. Mechanically, our results will be biased in favor of finding evidence of X’s effect on Y via M simply because Q has produced a relationship between M and Y.\n\n\n…and because treatment effects are rarely homogeneous.\nThe other problem with trying to decompose the average effects of X on M and then M on Y is that this approach assumes that every subject responds to the treatment identically. Recalling our example in which X is the information treatment, M is the belief that corruption is too severe, and Y is staying home, we can imagine two types of respondents. Type A thought that corruption was too severe to ever solve until she received a postcard containing information about corruption in her district. She was surprised to see that the problem was not as bad as she had expected. Formally, for Type A, \\(M(X=0)=1\\) and \\(M(X=1)=0\\), so X has a negative effect on M. Type B thought corruption was a manageable problem until she received a postcard containing information about corruption in her district. She was surprised by how extensive the problem was and gave up hope of solving the problem. Formally, for Type B, \\(M(X=0)=0\\) and \\(M(X=1)=1\\), so X has a positive effect on M. If we were to average the effects for these two types, we would see no relationship between X and M.\n\n\n\n\n\n\n\n\n\n\n\n\nType\nX (Info treatment)\nM conditional on X=0 (unobserved)\nM conditional on X=1 (observed)\nEffect of X on M\nEffect of M on Y\nY (Stay home)\n\n\n\n\nA\n1\n1\n0\nnegative\nnegative\n1\n\n\nB\n1\n0\n1\npositive\npositive\n1\n\n\n\nEstimating the role of M can be further complicated when the relationship between M and Y is also heterogeneous. Imagine that Type A only votes when she’s angry (in other words, M has a negative effect on Y). Type A was planning on voting to express her anger over the pervasiveness of corruption in her district, even though she knew it would not have changed anything, until she learned that corruption was not as bad as she had expected it to be. Her fiery passion gone, she chooses to stay home on election day. However, Type B only votes when she thinks her vote can make a difference (in other words, M has a positive effect on Y). Type B was going to vote for the non-corrupt politicians in her district until she learned that they were all corrupt. Without any hope of changing the situation, she also decided to stay home on election day. For both Type A and Type B, there is an “indirect effect” of M (in other words, X affects Y through M). But we will miss this relationship in the aggregate because we will be unable to obtain unbiased estimates of the average effect of X on M.5\nWe can imagine many more “types” than just A and B – the point here is to demonstrate intuitively that because M is not randomly assigned, and because it is unlikely that the effects of X on M and M on Y are identical for everyone, it will be very difficult to accurately characterize how much of our effect is mediated through M.\n\n\nMany studies try to decompose a total treatment effect into its “direct” and “indirect” effects.\nBecause learning about mechanisms holds such rich theoretical promise, researchers would love to quantify how much of an effect of X on Y operates via M. Sometimes researchers will try to do this through a technique called “decomposition of effects.”\nA decomposition of effects analysis tries to decompose a total effect of X on Y into the effect X has on Y directly and the effect of X on Y that occurs indirectly through M. The “total effect” refers to the Average Treatment Effect (ATE), which is simply the average effect that X has on Y. Any experiment that randomly assigns a treatment in order to observe its effects on some outcome is estimating the ATE. Next, the researcher tries to quantify the size of the effect that X has on Y through the mechanism M. This is often known as the “indirect effect” – because X is affecting Y indirectly through M – or the Average Causally Mediated Effect (ACME). Finally, the researcher will try to estimate the effect of X on Y that doesn’t go through M. This is known as the “direct effect” of X on Y or the Average Controlled Direct Effect (ACDE), because it is the effect of X on Y when we control for the work that M is doing.\n\n\nBut be cautious about using regression analysis to decompose effects.\nAlthough commonly used, using mediation regression analysis presupposes some strong and often unrealistic assumptions. We will use some code to illustrate what this method entails and demonstrate the conditions under which it can produce biased estimates.\nThe basic idea is that if we have data on the treatment an individual received (X), whether they exhibit the proposed mechanism (M), and what the outcome is (Y), then we can distinguish these effects using the following three regressions.\n\n\\[ M_i = \\alpha_1+aX_i+e_{1i} \\]\n\\[ Y_i = \\alpha_2+cX_i+e_{2i} \\]\n\\[ Y_i = \\alpha_3+dX_i+bM_i+e_{3i} \\]\n\nHow would we do this? Using equation 1, we can regress M on X to obtain the direct effect of X on M, which is the coefficient \\(a\\). Next, we turn to equation 3, in which we regress Y on M and X. In this regression, the coefficient \\(b\\) represents the direct effect of M on Y when we control for X. A decomposition of effects analysis would multiply \\(a*b\\) to reveal the indirect effect of X on Y via M. To find the direct effect of X on Y, we need look no further than \\(d\\), which is the coefficient on X in equation 3 when we control for M. In other words, \\(d\\) is the effect of X on Y that does not go through M. If we add the indirect effect and direct effect, we will come up with the “total effect” of X on Y, which is equal to \\(c\\). To summarize, the decomposition of effects analysis ostensibly disaggregates the total effect into the effect that is mediated via M and the effect that is not mediated via M, enabling the researcher to conclude how important M is for explaining the relationship between X and Y.6\nThe problem is that this arithmetic only works under some very strong assumptions. One of these assumptions is that the error terms in regressions 1 and 3 are unrelated to each other—in other words, M can’t be predicted by unobservable factors that also predict Y. We described this problem intuitively in point 3 when we introduced Q, a confounding variable that contributes both to M and to Y and therefore engenders a very strong relationship between them, even if X’s effect on Y is not operating through M at all. Now let’s describe this problem using a simulation.\nIn the following code, we start by creating this Q variable for each individual and defining the “true” effects of X on M, M on Y, and X on Y. Next, we create hypothetical potential outcomes for M—that is, for each individual, we define what value of M they would reveal if they were treated, and what value of M they would reveal if they were untreated. These values are related not only to the “true” effect of X on M, but also to Q. Then we can also define hypothetical potential outcomes for Y. We do this for four scenarios, all of which assume constant effects, an assumption we will relax later. Two of these are simple potential outcomes of Y: the Y exhibited by the individual who is untreated and reveals her untreated M potential outcome, and the Y exhibited by the individual who is treated and reveals her treated M potential outcome. However, we also define two complex potential outcomes of Y: the Y exhibited by the individual who is untreated but reveals her treated M potential outcome, and the Y exhibited by the individual who is treated but reveals her untreated M potential outcome. While these potential outcomes bend the mind a bit, they are important to define in the hypothetical so that we can calculate the “true” (but inherently unobservable) direct and indirect effects to compare our decomposition analysis to.\nIn the second half of the code, we conduct a random assignment of treatment and proceed with the decomposition of effects analysis described above, using the data we “observe.” Under the (strong) assumptions that the error terms are uncorrelated and effects are constant across subjects, \\(a*b\\) = ACME, \\(d\\) = ACDE, and \\(c\\) = ATE. However, the simulation reveals that \\(a*b\\) > ACME and \\(d\\) < ACDE; that is, we overestimated the average indirect or mediated effect (ACME) and underestimated the average direct effect (ACDE). Our decomposition of effects analysis was biased because the first assumption – uncorrelated error terms – did not hold: unobserved variable Q predicted both M and Y, and this led us to overestimate the role of the mechanism M.\n\nrm(list = ls())\nset.seed(20160301)\nN <- 1000000\n# Simulate Data, Create Potential Outcomes, Estimate \"True\" Effects -----------------------\n# build in an ideosyncratic unobserved characteristic\nQ_i <- rnorm(N)\n# create the \"true model\" by defining our treatment effects (tau)\ntau_X_on_M <- 0.2 # X's effect on M\ntau_M_on_Y <- 0.1 # M's effect on Y\ntau_X_on_Y <- 0.5 # total effect of X on Y (ATE), both through M and not through M\n# build the potential outcomes (POs) for the mediator\n# individual reveals M_1 if treated; M_0 if untreated\n# M is a function of both treatment and the unobserved characteristic\nM_0 <- 0 * tau_X_on_M + Q_i\nM_1 <- 1 * tau_X_on_M + Q_i\n# we can estimate the unbiased Average Treatment Effect (ATE) of X on M\nATE_M <- mean(M_1 - M_0)\nATE_M\n\n[1] 0.2\n\n# build POs for the outcome variable\nY_M0_X0 <- tau_M_on_Y * (M_0) + tau_X_on_Y * 0 + Q_i\nY_M1_X1 <- tau_M_on_Y * (M_1) + tau_X_on_Y * 1 + Q_i\nY_M0_X1 <- tau_M_on_Y * (M_0) + tau_X_on_Y * 1 + Q_i # this is a \"complex\" PO\nY_M1_X0 <- tau_M_on_Y * (M_1) + tau_X_on_Y * 0 + Q_i # this is a \"complex\" PO\n# some of these POs are \"complex\" because we are imagining what Y we would\n# observe if we assigned treatment but observed the untreated M PO or\n# if we assigned control but observed the treated M PO\n# building these complex POs is necessary for estimating the \"true\" direct and indirect effects\n# we can estimate the unbiased Average Causally Mediated Effect (ACME)\n# we estimate the effects of M holding X constant\n# they are the same\n# this is the \"indirect effect\"\nACME_X0 <- mean(Y_M1_X0 - Y_M0_X0)\nACME_X1 <- mean(Y_M1_X1 - Y_M0_X1)\nACME <- mean(((Y_M1_X1 - Y_M0_X1) + (Y_M1_X0 - Y_M0_X0)) / 2)\n# we can estimate the unbiased Average Controlled Direct Effect (ACDE)\n# we estimate the effects of X holding M constant\n# they are the same\n# this is the \"direct effect\"\nACDE_M0 <- mean(Y_M0_X1 - Y_M0_X0)\nACDE_M1 <- mean(Y_M1_X1 - Y_M1_X0)\nACDE <- mean(((Y_M0_X1 - Y_M0_X0) + (Y_M1_X1 - Y_M1_X0)) / 2)\n# now we build the simple POs for Y\nY_1 <- tau_M_on_Y * (M_1) + tau_X_on_Y * 1 + Q_i\nY_0 <- tau_M_on_Y * (M_0) + tau_X_on_Y * 0 + Q_i\n# we estimate the true ATE of X on Y\n# this is the \"total effect\"\nATE <- mean(Y_1 - Y_0)\nATE\n\n[1] 0.52\n\nACDE + ACME # note that the direct and indirect effects sum to the total\n\n[1] 0.52\n\nACDE\n\n[1] 0.5\n\nACME\n\n[1] 0.02\n\nATE_M\n\n[1] 0.2\n\n# Random Assignment, Revelation of POs, Attempt to Decompose Effects ---------------------------------\n# we assign half of our sample to treatment and half to control\nX <- sample(c(rep(1, (N / 2)), rep(0, (N / 2))))\n# we reveal POs for M and Y based on treatment assignment\nM <- X * M_1 + (1 - X) * M_0\nY <- X * Y_1 + (1 - X) * Y_0\nmodel1 <- lm(M ~ X)\na <- coef(model1)[2] # extract the coefficient to get the effect of X on M\na\n\n        X \n0.2001291 \n\nmodel2 <- lm(Y ~ X)\nc <- coef(model2)[2] # extract the coefficient to get the total effect of X on Y\nc\n\n       X \n0.520142 \n\nmodel3 <- lm(Y ~ X + M)\nd <- coef(model3)[2] # extract this coefficient to get the effect of X on Y controlling for M\nb <- coef(model3)[3] # extract this coefficient to get the effect of M on Y controlling for X\n# some would now multiply the average effect of X on M and the average effect of M on Y to get the average indirect/mediated effect of X on Y via M (ACME)\na * b\n\n       X \n0.220142 \n\n# but when we compare this to the true ACME, we see that this is biased\nACME\n\n[1] 0.02\n\n# some would also interpret the average effect of X on Y controlling for M as the average controlled direct effect (ACDE)\nd\n\n  X \n0.3 \n\n# but when we compare this to the true ACDE, we see that this is biased\nACDE\n\n[1] 0.5\n\n# note that we have OVERestimated the average indirect effect and UNDERestimated the average direct effect\n# the estimates that are unbiased are the average effects of X on Y and X on M because X is randomly assigned\na\n\n        X \n0.2001291 \n\nATE_M\n\n[1] 0.2\n\nc\n\n       X \n0.520142 \n\nATE\n\n[1] 0.52\n\n\nLet’s tie this exercise back to the issue raised in point 3. This simulation illustrated that quantifying the mediated effect proves difficult when background predictive variables confound the relationship between M and Y. Because M is not randomly assigned, it is important for us to think about how likely it is that our M and our Y are both affected by unobserved variables. In principle, if there are no confounding variables in this relationship, then a decomposition of effects analysis may be unbiased, but this assumption is strong and usually hard to prove.\nWhile we did not demonstrate it in this simulation, it is also possible to show that decomposition of effects also breaks down when treatment effects are heterogeneous (we introduced the intuition for this in point 4). The technical reason for this comes from our law of expectations, which is: \\(E[a*b]\\) = \\(E[a]E[b]+cov(a,b)\\). If we have constant treatment effects, then \\(a\\) and \\(b\\) do not covary, the covariance term drops out, and we can simply multiply \\(a*b\\) to get the ACME. However, if the covariance term is non-zero, then we are not able to estimate this indirect effect from these two coefficients obtained from separate regressions. We constructed constant treatment effects in order to be able to demonstrate the process of decomposing effects, but if we were to re-do the simulation with heterogeneous treatment effects that covary, then we would not even be able to calculate the ACME or ACDE using the potential outcomes approach at the beginning of our code.\nWhat you can do… Before you embark on a decomposition of effects analysis, ask yourself:\n\nCan I imagine any unobserved variables that predict both M and Y?\nIs it possible that my subjects respond to treatment effects in different ways?\n\nIf the answer to any of these questions is yes, we strongly recommend that you proceed with caution. In particular, think carefully about how unobserved variables and heterogeneous treatment effects would affect your estimation strategy.\n\n\nSometimes subgroup analysis can provide suggestive evidence for or against a mechanism.\nIn points 3-6, we’ve cautioned researchers against trying to confidently quantify the proportion of an effect that is mediated by a particular mechanism, but there may be other ways to learn more about mechanisms at work in a particular study. In point 1, we underscored the tight relationship between mechanisms and theory. Just because it’s challenging to quantify evidence of a mechanism directly does not mean we cannot explore the testable predictions of the theory in which our mechanism is featured!\nOne strategy is to use subgroup analysis, or treatment-by-covariate interactions, to see whether different populations respond to the treatment differently in accordance with our theories. For example, suppose we wanted to learn more about the role of income in mediating the climate/conflict relationship. One of the testable implications of a theory in which income plays a mediating role is that we would expect climate shocks to be associated with conflict in areas where income is sensitive to climate shocks but not where income is independent of climate shocks. Sarsons (2015)7 does exactly this. Exploiting the fact that districts downstream of irrigation dams do not depend on rainfall for income while districts upstream of irrigation dams do, she explores the income mechanism by testing whether rain shocks predict riot incidence in downstream districts but not in upstream districts. Formally, she tests these hypotheses:\n\nX\\(\\rightarrow\\)Y in places where X is known to affect M [Rainfall shocks will increase riots in areas where rainfall shocks will negatively affect income (upstream of dam).]\nX has no effect on Y in places where X has no effect on M [Rainfall shocks will have no effect on riots in areas where income is not sensitive to rainfall (downstream of dam).]\n\nHowever, she found that the relationship between rainfall shocks and riot incidence held just as tightly in the downstream districts where income was not sensitive to rainfall. She interprets this finding as “suggestive” evidence against the income mechanism. To be clear, Sarsons did not conduct any mediation analysis: she did not measure the income of each village and quantify the direct effect of rainfall shocks on riots and the indirect effect of rainfall shocks on riots through income. Instead, she looked for the heterogeneous treatment effects the theory would have implied and, finding no evidence of them, concluded that the income channel may be less important than previously thought.\nWhat you can do… In future projects, ask yourself: If the mechanism is M, which groups or units would I expect to exhibit a treatment effect, and which groups or units would I expect not to respond to treatment? Next, test whether these predictions are supported by your data and interpret this as suggestive evidence for or against your proposed mechanism M. Keep in mind that such evidence is not decisive because the groups could differ in other ways that could affect their responsiveness to the treatment.\n\n\nWe can also look for suggestive evidence by looking at the effects of our treatment on various outcomes.\nAgain, while it’s difficult to quantify evidence of a mechanism at work, we can always explore the testable implications of the theory in which our mechanism features. In point 7, we did this by exploring whether the treatment affected the particular subgroups for which a treatment effect is implied by our theory. Another approach is to explore whether the treatment affects only the outcomes implied by our theory.\nFor example, many social scientists are interested in how mass education influences democracy. Several theories of democratization expect different mechanisms would connect education and democracy. First, according to modernization theory, education could facilitate the smooth functioning of democracy by undermining group attachments (such as ethnicity or religion) in favor of merit.8 Second, according to social theorists of oppression, education could undermine democracy by reinforcing obedience to authority, which is inherent in a classroom structure.9 Third, according to many political scientists and psychologists, education can encourage democratic participation by empowering individuals with the ability to acquire and act on knowledge.10 Friedman et al. (2011)11 decide to tease apart these mechanisms by investigating the results of a field experiment in which Kenyan girls were randomly assigned to receive an education subsidy. They followed up with the students five years after the program and asked them several questions designed to test which of these three mechanisms were at work: Did the girls accept a husband’s right to beat his wife? Was a parent involved in selecting their spouse? How strongly did the girl identify with her religious or ethnic group? Did the girl regularly read news?\nThe following table outlines the direction of the effects that each theory would suggest. Note that the various mechanisms being tested here result from theories with diverging predictions on some of these outcomes. The predictions from each of the three mechanisms are outlined on the rows, followed by the actual results. We can see that two of the outcomes collected provided support for modernization theory. However, modernization theory would have predicted a decrease in religious or ethnic group association (in reality, there was no effect) and had no predictions for newspaper readership (in reality, readership increased). None of the predictions of the obedience to authority mechanism were supported by the data. However, the data supported all four of the predictions of individual empowerment theory. The authors conclude that it is more likely that \\(X→M3→Y\\) than \\(X→M1,M2→Y\\).12\n\n\n\n\n\n\n\n\n\n\nMechanism\nAcceptance of husband’s right to beat wives (Y1)\nParent involved in selecting spouse (Y2)\nAssociation with religion, ethnic identity (Y3)\nReads news (Y4)\n\n\n\n\n(M1) Modernization\n\\(\\downarrow\\)\n\\(\\downarrow\\)\n\\(\\downarrow\\)\nNo effect\n\n\n(M2) Obedience to authority\n\\(\\uparrow\\)\n\\(\\uparrow\\)\n\\(\\uparrow\\)\nNo effect\n\n\n(M3) Individual empowerment\n\\(\\downarrow\\)\n\\(\\downarrow\\)\nNo effect\n\\(\\uparrow\\)\n\n\nActual effect\n\\(\\downarrow\\)\n\\(\\downarrow\\)\nNo effect\n\\(\\uparrow\\)\n\n\n\nThis study, like Sarsons’s study, is not trying to quantify how much of the effect of X on Y is conveyed via M. However, through thoughtful investigation of various outcomes, the authors are able to provide suggestive evidence of which mechanisms seem most plausible.\nWhat you can do… In future projects, ask yourself: If the mechanism is M, which outcomes would I expect to be affected by my treatment, and which outcomes would I expect not to be affected by my treatment? Next, test whether these predictions are supported by your data and interpret this as suggestive evidence for or against your proposed mechanism M.\n\n\nDesigning complex treatments can help narrow our understanding of what part of the treatment is “doing the work.”\nSometimes experimental researchers will try to better understand mechanisms by adding or subtracting elements of the treatment that are thought to trigger different mechanisms. This approach is sometimes called “implicit mediation analysis” because different components of X are thought to implicitly manipulate certain mechanisms. This, of course, is an assumption: because we are not measuring M directly, we are relying on a theoretical claim that component A will trigger M, whereas component B will not.\nFor example, many governments including Mexico, Brazil, Tanzania, and Uganda have created conditional cash transfer programs to address poverty. These programs provide cash to poor individuals, but they frequently come with conditions such as attending school or a job training program. Until recently, we knew only that these programs (X) successfully reduced poverty (Y) and that X caused Y either via cash or via the required attendance at school or job programs. To distinguish between these mechanisms, Baird et al. (2011)13 conducted an experiment in Malawi, where they assigned one group of families to receive a conditional cash transfer for the regular school attendance of their girls, another group of families to receive the cash unconditionally, and a control group to receive no transfer. This design “implicitly” manipulated M: while girls in the unconditional transfer group could also seek out education, school attendance (the condition under study) would likely be higher in the group that was required to seek it out. Unsurprisingly, school attendance and test performance was better for the group receiving conditional cash transfers. However, their measures of Y–the rate at which the girls became pregnant or married–were actually better (lower) in the group receiving the unconditional cash transfers. The authors concluded that attendance requirements associated with conditional cash transfers were probably not the mechanism responsible for the success of these programs in reducing the symptoms of poverty.\nStudies like these help not only social scientists to learn more about the channels through which X causes Y, but also policymakers to explore and discover new treatments. After several other studies joined Baird et al. in demonstrating the remarkable effects of unconditional cash transfers, many governments and organizations have begun to implement unconditional cash transfer programs.\nWhat you can do… In future projects, ask yourself: Can my treatment be “unpacked” into multiple treatment arms, some that implicitly manipulate M, and some that do not? Consider using a factorial design to identify the effects of different treatment arms. If you have ample power, comparing the various treatment arms will provide you with suggestive evidence for or against M.\n\n\nDespite the difficulties in empirically measuring mechanisms, it is worth paying serious attention to them but being cautious in our language.\nAttempting to identify causal mechanisms is a noble endeavor. Articulating causal mechanisms is what allows us to unpack “black box” treatments and understand why and how certain treatments work. Even though causal claims can be (and often are) made without evidence for a causal mechanism, exploring causal mechanisms is what enables us to extend the research frontier and re-evaluate how our evidence maps on to our theories. For these reasons, audiences (be they the general public or academic reviewers) are often understandably eager for you to expound upon causal mechanisms after demonstrating evidence for a provocative causal claim. In anticipation of this, it is worth considering whether it is possible to design a way to test causal mechanisms in advance of implementing an experiment. If not, consider whether certain outcome measures or treatment by covariate interactions would provide some support for a particular causal mechanism, and be explicit about the limitations of this kind of analysis in your write-up. Mechanisms are an exciting domain of inquiry and should be considered both in the design and analysis of an experiment, but we should be sure to discuss mechanisms with caution appropriate to our ability to identify a particular mechanism and avoid overselling the argument.\n\n\n\n\n\nFootnotes\n\n\nSolomon M. Hsiang, Kyle C. Meng, and Mark A. Cane, “Civil Conflicts Are Associated with the Global Climate,” Nature 476.7361 (2011): 438-441.↩︎\nTed Gurr, Why Men Rebel, Princeton University Press, 1970.↩︎\nAlberto Chong, Ana L. de la O, Dean Karlan, and Leonard Wantchekon, “Does Corruption Information Inspire the Fight or Quash the Hope? A Field Experiment in Mexico on Voter Turnout, Choice, and Party Identification,” The Journal of Politics 77.1 (2015): 55-71.↩︎\nNote that Chong et al. test their argument using data at the precinct level, not the individual level, but we’ve adapted their argument to the individual level for ease of exposition.↩︎\nFor a more rigorous discussion of these fallacies, see Adam N. Glynn, “The Product and Difference Fallacies for Indirect Effects,” American Journal of Political Science 56.1 (2012): 257-269.↩︎\nExplanation adapted from Alan Gerber and Donald Green, Field Experiments, W.W. Norton and Company, 2012, chapter 10.↩︎\nHeather Sarsons, “Rainfall and Conflict: A Cautionary Tale.” Journal of Development Economics 115 (2015): 62-72.↩︎\nMarion Joseph Levy, Modernization and the Structure of Societies, Princeton University Press, 1966.↩︎\nFrantz Fanon, The Wretched of the Earth, Grove Press, 1964. John Lott, Jr., “Public Schooling, Indoctrination and Totalitarianism,” Journal of Political Economy 107(6), 1999.↩︎\nGabriel Almond and Sidney Verba, The Civic Culture: Political Attitudes and Democracy in Five Nations, Sage Publications, 1963. Robert Mattes and Michael Bratton, “Learning about Democracy in Africa: Awareness, Performance, and Experience,” American Journal of Political Science, 51(1), 2007.↩︎\nWilla Friedman, Michael Kremer, Edward Miguel, and Rebecca Thornton, “Education as Liberation?” NBER Working Paper 16939, 2011.↩︎\nIn the actual study, the authors were surprised to uncover evidence that education also increased individuals’ acceptance of political violence. While they still argue that individual empowerment is responsible for the relationship between education and democracy, they caution that education does not always lead to democratization (that is, M3→Y but it is also possible that M3→NOT Y). Nonetheless, their approach is a useful demonstration of how multiple outcomes may shed light on mechanisms.↩︎\nSarah Baird, Craig McIntosh, Berk Ozler, “Cash or Condition? Evidence from a Cash Transfer Experiment,” Quarterly Journal of Economics 126, 2011.↩︎"
  },
  {
    "objectID": "guides/getting-started/meta-analysis_en.html",
    "href": "guides/getting-started/meta-analysis_en.html",
    "title": "10 Things to Know About Conducting a Meta-Analysis",
    "section": "",
    "text": "1. What is meta-analysis?\nMeta-analysis is a method for summarizing the statistical findings from a research literature. For example, if five experiments have been conducted using the same intervention and outcome measure on the same population of people with five separate estimates of an average treatment effect, one might imagine pooling these five studies together into a single dataset and analyzing them jointly. In broad strokes, in such a case, we could act as though the studies came from five blocks within a single experiment rather than five separate experiments. The benefit of such an approach would be more statistical power in the estimation of one overall average treatment effect. In essence, a meta-analysis produces a weighted average of the five studies’ results. As explained below, this method is also used to summarize research literatures that comprise a diverse array of interventions and outcomes measured in diverse settings, under the assumption that the interventions are theoretically similar and the outcome measures tap into a shared underlying trait.\n\n\n2. How does a meta-analysis differ from a literature review?\nMeta-analysis is often characterized as a form of systematic review insofar as it involves a specific set of data collection and analysis procedures. These procedures are spelled out in great detail by the Campbell Collaboration and by the James Lind Library. Particular attention is paid to gathering both published and unpublished studies (see below). By comparison, most conventional literature reviews cite the most noteworthy theoretical or empirical contributions but rarely attempt to be comprehensive or to summarize the findings quantitatively. Critics of conventional reviews point out the possibility that the most noteworthy or memorable studies present findings that are unrepresentative of the broader research literature and therefore may be a poor guide for policy. On the other hand, critics of meta-analysis point out that the flaws of individual studies are often lost sight of when their estimates are blended together to generate an overarching conclusion. As Uri Simonsohn once quipped, “Meta-analysis is a sausage factory that uses sausages by other factories as inputs.”1\n\n\n3. What types of data are used as input for a meta-analysis?\nIn principle, meta-analysis could be applied to the original data from each study, but in practice such data are seldom available for all relevant studies. Instead, researchers typically cull estimated treatment effects from research papers or other reports. This process presents scholars conducting a meta-analysis with an array of decisions when the research papers present results involving multiple outcomes, treatments, and estimation approaches. Often meta-analysis focuses on the “main” results, but identifying the main or primary results can be a judgment call. The reproducibility of meta-analysis hinges on careful documentation of such decisions. In addition to locating the key estimates, the meta-analyst must also track down measures of statistical uncertainty (e.g., standard errors, confidence intervals), as these statistics will be used to assign weights to each study in the averaging process. As noted below, meta-analysis tends to assign more weight to studies with less sampling variability such as studies with larger sample sizes.\n\n\n4. What is the estimand in meta-analysis?\nSome meta-analyses are narrowly tailored to specific treatments and outcomes. For example, a vast literature dating back to the 1920s focuses on the extent to which mailings that encourage voting in fact cause people to vote. In this case, one could imagine a population parameter that represents the average causal effect of mailed voting encouragements on a population of people in a specified region over some specified time period.\nOther meta-analyses are more abstract, focusing on a broad class of treatments and outcomes. For example, the literature on prejudice reduction comprises hundreds of studies on the effects of interpersonal contact between people with different racial, ethnic, religious, age, or gender backgrounds (Pettigrew and Tropp 2006).2 Contact ranges from a brief conversation to a year of co-habitation in a college dormitory. Outcomes also range widely from overt behaviors to self-reported feelings about in-groups and out-groups. Since these interventions and outcomes are on different scales and may refer to different concepts, the underlying population parameter is ambiguous. Researchers try to sidestep this issue by standardizing the outcomes (e.g., by dividing the outcome by the standard deviation in the control group), but there remains the problem of what to make of treatments that vary in intensity and duration. In effect, the population parameter in such cases becomes the average extent to which an ad hoc collection of interventions changes putative measures of prejudice within some location and time period.\nMeta-analyses can also struggle when the underlying population represented by the component studies is vague or abstract. For example, in a literature dominated by laboratory experiments conducted in the United States, the meta-analysis will implicitly assess an underlying average treatment effect in which the “average” gives disproportionate weight to American undergraduates.\n\n\n5. Meta-analysis and Bayes’ Rule\nConsider the simple case in which two experiments are conducted using the same treatments and outcomes. Imagine that both studies draw their subject pool from the same population. In this case, if we had the individual data for the experiments, we could pool them together into a single dataset and analyze them as though they were part of the same block-randomized experiment. But suppose that we did not have the individual data; instead, we only have the estimated ATE and estimated standard error from each study. How might we combine the two studies to form our best guess of the average treatment effect in the population from which the subjects were drawn? With some simplifying assumptions, we could apply Bayes’ Rule. Let’s assume that the sampling distribution of each experimental estimate is normal. (This is a reasonable assumption under the Central Limit Theorem, since we are using an average to estimate the average treatment effect and we assume that each experiment has at least a few dozen subjects and that the outcome distribution is not too skewed.) Since these experiments are independent of one another, Bayes’ Rule takes a simple form: take a weighted average of the two estimates, where the weights are the inverse of each study’s squared standard error (\\(\\hat{\\sigma}_j^2\\) is the squared estimated standard error for study \\(j\\)).\n\\[ \\hat{ATE_{pooled}} = \\frac{\\frac{1}{\\hat{\\sigma}_1^2}}{\\frac{1}{\\hat{\\sigma}_1^2} + \\frac{1}{\\hat{\\sigma}_2^2}}\\hat{ATE_1} + \\frac{\\frac{1}{\\hat{\\sigma}_1^2}}{\\frac{1}{\\hat{\\sigma}_1^2} + \\frac{1}{\\hat{\\sigma}_2^2}}\\hat{ATE_2} \\]\nThis formula turns out to be the same as a so-called “fixed effects” meta-analysis. This formula is sometimes called a “precision-weighted average,” where the term “precision” refers to the inverse of the squared standard error. In a simple two-arm, completely randomized study, the standard error of the simple estimator of the average treatment effect is a function of sample size and variation in the outcome, and ratio of treated to control units. So, notice that in this case the study with the smaller standard error (i.e. larger sample, less variable outcome, more equal ratio of treated to control units) received more weight in the pooled meta-analytic result.\n\n\n6. Fixed effects versus random effects estimation\nMost meta-analysis software3 presents users with a choice between fixed effects estimation and random effects estimation. Fixed effects estimation is simply a precision-weighted average.4 And random effects estimation is a special case of more general Bayesian meta-analysis. In either case, the studies with the smallest standard errors are accorded the most weight. Random effects estimation applies a different set of weights depending on the extent to which the estimates vary more than would be expected by chance under a fixed effects model. Therefore, the weights for the random effects estimation not only consider the variance within each study but also an estimate of the between-study variance (\\(\\tau^2\\)).\n\\[ \\hat{ATE_{pooled}^*} = \\frac{\\frac{1}{\\hat{\\sigma}_1^2+\\tau^2}}{\\frac{1}{\\hat{\\sigma}_1^2+\\tau^2} + \\frac{1}{\\hat{\\sigma}_2^2+\\tau^2}}\\hat{ATE_1} + \\frac{\\frac{1}{\\hat{\\sigma}_1^2+\\tau^2}}{\\frac{1}{\\hat{\\sigma}_1^2+\\tau^2} + \\frac{1}{\\hat{\\sigma}_2^2+\\tau^2}}\\hat{ATE_2} \\]\nThe more heterogeneous the estimated effects–perhaps due to variations in experimental techniques, outcome measurement, or context–the more the resulting weighted average represents a simple average rather than a precision-weighted average. Typically, researchers start with a fixed effects meta-analysis, test whether the estimates are significantly overdispersed given the fixed effects model, and, if so, estimate and report a random effects meta-analysis.\n\n\n7. Is it okay to summarize both experimental and observational research findings?\nBeware of meta-analyses that combine experimental and observational estimates. When properly executed, experiments provide unbiased estimates of the average treatment effect. An observational study, on the other hand, is prone to bias insofar as the treatments are not randomly assigned. The nominal standard errors associated with observational studies ignore the potential for bias; the standard errors are biased downward because they assume the best-case scenario, namely, that nature assigned treatments in a manner that was as good as random. Gerber, Green, and Kaplan (2004)5 show that merely being uncertain about the bias of an observational study is equivalent to according it a larger standard error. Although many prominent meta-analyses include both experiments and observational studies (e.g., Lau and Sigelman6; Pettigrew and Tropp 2006), this practice is frowned upon by leading scholars conducting biomedical meta-analyses.\n\n\n8. Publication bias as a threat to meta-analysis\nBecause meta-analyses draw their data from reported results, publication bias presents a serious threat to the interpretability of meta-analytic results. If the only results that see the light of day are splashy or statistically significant, meta-analysis may simply amplify publication bias. Methodological guidance to meta-analytic researchers therefore places special emphasis on conducting and carefully documenting a broad-ranging search for relevant studies, whether published or not, including languages other than English. This task is, in principle, aided by pre-registration of studies in public archives; unfortunately, pre-registration in the social sciences is not sufficiently comprehensive to make this a dependable approach on its own.\nWhen assembling a meta-analysis, it is often impossible to know whether one has missed relevant studies. Some statistical methods have been developed in order to detect publication bias, but these tests tend to have low power and therefore may give more reassurance than is warranted. For example, one common approach is to construct a scatterplot to assess the relationship between study size (whether measured by the N of subjects or the standard error of the estimated treatment effect) and effect size. A telltale symptom of publication bias is a tendency for smaller studies to produce larger effects (as would be the case if studies were published only if they showed statistically significant results; to reach the significance bar, small studies (with large standard errors) would need to generate larger effect estimates. Unfortunately, this test often produces ambiguous results (Bürkner and Doebler 2014),7 and methods to correct publication bias in the wake of such diagnostic tests (e.g., the trim-and-fill method) may do little to reduce bias. Given growing criticism of statistical tests for publication bias and accompanying statistical correctives, there is an increasing sense that the quality of a meta-analysis hinges on whether research reports in a given domain can be assembled in a comprehensive manner.\n\n\n9. Modeling inter-study heterogeneity using meta-regression\nResearchers often seek to investigate systematic sources of treatment effect heterogeneity. These systematic sources may reflect differences among subjects (Do certain drugs work especially well for men or women?), contexts (Do lab studies of exposure to mass media produce stronger effects than field studies?), outcomes (Are treatment effects especially large when outcomes are measured via opinion surveys as opposed to direct observation of behavior?), or treatments (Are partisan messages more effective at mobilizing voters than nonpartisan messages?). Quite often, these investigations are best studied directly, via an experimental design. For example, variation in treatment may be studied by randomly assigning different treatment arms. Variation in effects associated with different outcome measures may also be studied in the context of a given experiment by gathering data on more than one outcome or by randomly assigning how outcomes are measured.\nA second-best approach is to compare studies that differ on one or more of these dimensions (subjects, treatments, context, or outcomes). The drawback of this approach is that it is essentially descriptive rather than causal – the researcher is basically characterizing the features of studies that contribute to especially large or small effect sizes. That said, this exercise can be conducted via meta-regression: the estimated effect size is the dependent variable, while study attributes (e.g., whether outcomes were measured through direct observation or via survey self-reports) constitute the independent variables. Note that meta-regression is a generalization of random effects meta-analysis, with measured predictors of effect sizes as well as unmeasured sources of heterogeneity.\nSince meta-analysis is a technique for combining information across different studies, we do not here discuss the detection or modeling of heterogeneous treatment effects within any single study. See our guide 10 Things to Know About Heterogeneous Treatment Effects for more on this topic.\n\n\n10. Methods for assessing the accuracy of meta-analytic results\nA skeptic might ask whether meta-analysis improves our understanding of cause-and-effect in any practical way. Do we learn anything from pooling existing studies via a weighted average versus presenting the studies one at a time and leaving the synthesis to the reader? To address this question EGAP conducted an experiment among the academics and policy experts attending a conference to reveal the results of the first round of EGAP’s Metaketa Initiative, which focused on conducting a coordinated meta-analysis on the impact of information and accountability programs on electoral outcomes. The round consisted of six studies measuring the impact of the same causal mechanism.\nTo test the idea that accumulated knowledge (in the form of meta-analysis) allows for better inferences about the effect of a given program, the Metaketa committee randomized the audience to hear a presentation of the meta-analysis, each component study, a placebo, and an external study of a similar intervention that was not part of the Metaketa round or the subsequent meta-analysis. Each group of participants was not exposed to one of the above group of studies. And the participants were asked to predict the results of the left out study. This allowed the committee to measure the effect of each study type on attendees’ predictive abilities. The event attendees were then asked to predict the findings of the one study they had not yet seen. The resulting analysis found that exposure to the meta-analysis led to greater accuracy in predicting the effect in the left-out study in comparison to the external study (which, as a reminder, was not part of the meta-analysis in any way). For more on this Metaketa round, along with a more substantial discussion of this “evidence summit” see the book Information, Accountability, and Cumulative Learning: Lessons from Metaketa I.8\n\n\n\n\n\nFootnotes\n\n\nhttps://twitter.com/uri_sohn/status/471318552470126592↩︎\nPettigrew, T.F. & Tropp, L.R. (2006). A Meta-Analytic Test of Intergroup Contact Theory. Journal of Personality and Social Psychology, 90(5), 751–783.↩︎\nfor a list of R packages useful in conducting meta-analysis, see here: https://cran.r-project.org/web/views/MetaAnalysis.html↩︎\nSee for example https://www.stata.com/support/faqs/statistics/meta-analysis/ and https://cran.r-project.org/web/views/MetaAnalysis.html↩︎\nGerber, A.S., Green, D.P., & Kaplan, E.H. (2004). The illusion of learning from observational research. In I. Shapiro, R.M. Smith, & T.E. Masoud (Eds.), Problems and Methods in the Study of Politics (251-273). Cambridge, England: Cambridge University Press.↩︎\nLau, R.R., Sigelman, L., & Rovner, I.B. (2007). The Effects of Negative Political Campaigns: A Meta‐Analytic Reassessment. The Journal of Politics, 69(4), 1176-1209.↩︎\nBürkner, P. C., & Doebler, P. (2014). Testing for publication bias in diagnostic meta‐analysis: a simulation study. Statistics in Medicine, 33(18), 3061-3077.↩︎\nDunning, T., Grossman, G., Humphreys, M., Hyde, S. D., McIntosh, C., & Nellis, G. (Eds.). (2019). Information, accountability, and cumulative learning: Lessons from Metaketa I. Cambridge: Cambridge University Press.↩︎"
  },
  {
    "objectID": "guides/getting-started/missing-data_en.html",
    "href": "guides/getting-started/missing-data_en.html",
    "title": "10 Things to Know About Missing Data",
    "section": "",
    "text": "1. What is missing data?\nWhen variables are missing some data values, we say that there is “missing data.” Depending on your software and the coding of the dataset, missing values may be coded as NA, ., an empty cell (\"\"), or a common numeric code (often -99 or 99).\nThe consequences of missing data for estimation and interpretation depend on the type of variable missing the data. For our purposes, we will consider three types of variables: pretreatment covariates, treatment indicator(s), and outcome (or dependent) variables. Pretreatment covariates, often known simply as “covariates,” are variables that we observe and measure before treatment is assigned. Outcome (or dependent) variables refer to outcomes that are measured after the assignment of treatment.\nMissing data emerges for different reasons. In survey data, a respondent could decline to answer a question or quit the survey without completing all questions. In a panel survey, some subjects may skip the second or later waves. With administrative data, records may be lost at some point in the process of collecting or recording data. To the extent that we can know the process by which data becomes missing, we can better understand the consequences of missing data for our analysis and inferences.\n\n\n2. Missing treatment or outcome data can bias our ability to describe empirical patterns and estimate causal effects.\nMissing data can induce bias in our estimates of descriptive patterns and causal effects. Consider a researcher trying to describe the income distribution in a country with survey data. Some individuals’ incomes are missing but the researcher describes the non-missing data at hand. Suppose low-income individuals are less likely to report their income than high-income individuals, thus missingness concentrates in the lower portion of the distribution. Then, the researcher’s characterization of the income distribution is apt to be biased. For example, the researcher’s estimate of median income is bound to be higher than the true (unknown) median income because more data is missing from the lower portion of the distribution. Since missingness is correlated with the variable that we are trying to describe, our characterization of the median of the distribution is biased.\nWe can illustrate two types of missingness by considering a variable \\(x\\) – for example, income, as above. The left panel shows the full distribution of the variable \\(x\\) without missing data. The middle panel depicts a scenario in which simulated missingness in \\(x\\) is not independent of \\(x\\) – low values of \\(x\\) are much more likely to be missing. The right panel depicts a scenario in which simulated missingness in \\(x\\) is independent of \\(x\\) (often called “missing at random”). The red line represents the median of the distribution without missingness. The blue lines represent the median of the observed data in each simulation. Where missingness is not independent of \\(x\\), we observe that the median of the nonmissing data is, in this instance, higher than the true median. This illustrates that missing data can bias our descriptions of single variables.\n\nlibrary(rmutil)\nlibrary(dplyr)\nlibrary(ggplot2)\ndata.frame(x = rep(rchisq(n = 1000, df = 5), 3),\n           panel = rep(c(\"No missing data\", \"Missingness is not\\nindependent of x\", \"Missingness is\\nindependent of x\"), each = 1000)) %>%\n  mutate(panel = factor(panel, levels  = unique(panel)),\n         missing_cor = rbinom(n = 3000, size = 1,  prob = (1 - pchisq(x, df = 5))),\n         missing_ind = rbinom(n = 3000, size = 1, prob = .5),\n         obs = ifelse(missing_cor == 1 & panel == \"Missingness is not\\nindependent of x\", NA, \n                      ifelse(missing_ind == 1 & panel == \"Missingness is\\nindependent of x\", NA, x))) %>%\n  group_by(panel) %>%\n  mutate(med_x = median(x),\n         med_obs = median(obs, na.rm = T),\n         med_obs = ifelse(panel == \"No missing data\", NA, med_obs)) %>%\n  ggplot(aes(x = obs)) +\n  geom_histogram(bins = 50) +\n  facet_grid(~panel) +\n  geom_vline(aes(xintercept = med_x), col = \"red\", lwd = 1) +\n  geom_vline(aes(xintercept = med_obs), col = \"blue\", lty = 2, lwd = 1) +\n  scale_x_continuous(\"x\") +\n  theme_minimal()\n\n\n\n\nSimilarly, when we seek to estimate causal effects, some patterns of missing data can lead to biased estimates of causal effects. In particular, missingness of the treatment indicator or the outcome variable of interest can induce bias in estimates of the ATE. First, consider missingness of an outcome variable \\(Y_i(Z)\\). Adopting some notation from Gerber and Green (2013), define “reporting” as a potential outcome of a treatment, \\(Z\\), as \\(R_i(Z) \\in \\{0, 1\\}\\). In this notation, \\(R_i(Z) = 0\\) indicates that \\(Y_i(Z)\\) is missing and \\(R_i(Z)=1\\) indicates that the outcome is non-missing. Using this notation, we can express the ATE as:\n\\[\\begin{align}\n\\underbrace{E[Y_i(1)]-E[Y_i(0)]}_{ATE} =& \\underbrace{E[R_i(1)]E[Y_i(1)|R_i(1) = 1]}_{Z = 1\\text{ and }Y_i \\text{ is not missing}} + \\underbrace{(1-E[R_i(1)])(E[Y_i(1)|R_i(1) = 0])}_{Z = 1 \\text{ and } Y_i \\text{ is missing}} - \\\\\n&\\underbrace{E[R_i(0)]E[Y_i(0)|R_i(0) = 1]}_{Z = 0 \\text { and } Y_i \\text{ is not missing }} - \\underbrace{(1-E[R_i(0)])E[Y_i(0)|R_i(0) = 0]}_{Z = 0 \\text { and } Y_i \\text{ is missing }}\n\\end{align}\\]\nIf we condition our analysis on on non-missing outcomes, our estimator of the ATE is:\n\\[E[Y_i(1)|R_i(1)=1] - E[Y_i(0) |R_i(0)=1]\\]\nExamining the preceding equations, the estimator using only only the non-missing outcomes is only (necessarily) equivalent to the ATE if:\n\nThere is no missingness, \\(E[R_i(1)] = 1\\) and \\(E[R_i(0)] = 1\\).\nMissingness is independent of potential outcomes: \\[\\underbrace{E[Y_i(1)|R_i(1) = 1]}_{E[Y_i(1)] \\text{ if } Y_i(1) \\text{ is not missing}} =  \\underbrace{E[Y_i(1)|R_i(1) = 0]}_{E[Y_i(1)] \\text{ if } Y_i(1) \\text{ is missing}} \\text{ and } \\underbrace{E[Y_i(0)|R_i(0) = 1]}_{E[Y_i(0)] \\text{ if } Y_i(0) \\text{ is not missing}} = \\underbrace{E[Y_i(0)|R_i(0) = 0]}_{E[Y_i(0)] \\text{ if } Y_i(0) \\text{ is missing}}\\]\n\nOtherwise, the analysis conditional upon observing \\(Y_i(Z)\\) can induce an unknowable (but boundable) amount of bias in our estimate of the ATE.\nWe often do not think of missingness of the treatment indicator in experiments. Indeed, competent administration of an experiment generally ensures against missing treatment values. Nevertheless, it is important to note that missingness of the treatment indicator can also produce bias if missingness is not independent of potential outcomes.\nThe following simulation shows the consequences of two types of missingness for estimation of the ATE. We set the true ATE to 0.5 (the red vertical lines) in all cases. We simulate missingness through two types of data generating processes. In both cases, all missingness occurs among subjects in treatment (\\(Z = 1\\)). In the top panel, missingness is most likely among subjects in treatment with higher values of the outcome \\(Y_i(1)\\). In the bottom pannel, missingness is independent of the value of \\(Y_i(1)\\). If missingness is correlated with potential outcomes, the estimator of the ATE is biased (top row). This occurs whether we are missing values of the outcome (left column) or the treatment indicator (right column). In contrast, when missing data is independent of potential outcomes, the estimator is unbiased (bottom row).\n\nlibrary(randomizr)\nlibrary(estimatr)\n  \nextract_ests <- function(estimatr_model){summary(estimatr_model)$coef[2,1]}\nsimulation <- function(){\n  Y0 <- rnorm(2000)\n  Z <- complete_ra(2000)\n  Yobs <- Y0 + Z * .5 # .5 standard deviation treatment effect\n  Z_miss <- rbinom(n = 2000, prob = Z * pnorm(Yobs), size = 1)\n  Z_miss_ind <- rbinom(n = 2000, prob = sum(Z_miss)/2000, size = 1)\n  Y_miss <- rbinom(n = 2000, prob = Z * pnorm(Yobs), size = 1)\n  Y_miss_ind <- rbinom(n = 2000, prob = sum(Y_miss)/2000, size = 1)\n  \n  m1 <- lm_robust(Yobs ~ Z, subset = Z_miss == 0)\n  m2 <- lm_robust(Yobs ~ Z, subset = Z_miss_ind == 0)\n  m3 <- lm_robust(Yobs ~ Z, subset = Y_miss == 0)\n  m4 <- lm_robust(Yobs ~ Z, subset = Y_miss_ind == 0)\n  return(sapply(list(m1, m2, m3, m4), FUN = extract_ests))\n}\nreps <- replicate(n = 500, expr = simulation())\ndata.frame(ests = as.vector(t(reps)),\n           missing = rep(c(\"Missing Treatment Indicator\", \"Missing Outcome\"), each = 1000),\n           pos = rep(c(\"Missing is\\nNot Independent of POs\", \"Missingness is\\nIndependent of POs\"), each = 500)) %>%\n  ggplot(aes(x = ests)) + \n  facet_grid(pos ~ missing) +\n  geom_histogram(bins = 100) +\n  geom_vline(xintercept = .5, col = \"red\") +\n  theme_minimal() +\n  xlab(\"ATE Estimates\")\n\n\n\n\n\n\n3. The potential for bias increases in the proportion of treatment or outcome data that is missing.\nReturning to the equations in #2, it is useful to identify the terms that we can estimate (know) as analysts of a dataset. Rewriting the expression for the ATE in the presence of missing data, we can estimate:\n\nThe proportion of missingness in treatment and control: \\(\\color{red}{E[R_i(1)]}\\) and \\(\\color{red}{E[R_i(0)]}\\).\nThe expectation of the outcome variable among reporters (non-missing data) in treatment and control: \\(\\color{red}{E[Y_i(1)|R_i(1) = 1]}\\) and \\(\\color{red}{E[Y_i(0)|R_i(0)=1]}\\)\n\nThese expressions are colored in the following equation.\n\\[\\begin{align}\n\\underbrace{E[Y_i(1)]-E[Y_i(0)]}_{ATE} =& \\underbrace{\\color{red}{E[R_i(1)]E[Y_i(1)|R_i(1) = 1]}}_{Z = 1\\text{ and }Y_i \\text{ is not missing}} + \\underbrace{(1-E[R_i(1)])(E[Y_i(1)|R_i(1) = 0])}_{Z = 1 \\text{ and } Y_i \\text{ is missing}} - \\\\\n&\\underbrace{\\color{red}{E[R_i(0)]E[Y_i(0)|R_i(0) = 1]}}_{Z = 0 \\text { and } Y_i \\text{ is not missing }} - \\underbrace{(1-E[R_i(0)])E[Y_i(0)|R_i(0) = 0]}_{Z = 0 \\text { and } Y_i \\text{ is missing }}\n\\end{align}\\]\nWe are ultimately interested in estimating the ATE, \\(E[Y_i(1)]-E[Y_i(0)]\\). One straightforward implication of this expression is that the magnitude of bias possible for an estimator of the ATE on non-missing observations increases in the amount of missingness. As \\(E[R_i(1)] \\rightarrow 1\\) and \\(E[R_i(0)]\\rightarrow 1\\), bias stemming from missing outcome data converges to 0. In contrast, when we are missing a large proportion of the data, the magnitude of possible bias increases. Thus, our concerns about missing data should increase as the amount (proportion) of missingness increases.\n\n\n4. The consequences of missing data for bias in estimates of causal effects depend on the type of variable that is missing.\nMissingness of pretreatment covariates need not induce bias in our estimates of the ATE. However, researchers can actually induce bias through improper treatment of missing pretreatment covariate data. If treatment is randomly assigned, treatment assignment should be orthogonal to pre-treatment missingness. In other words, pre-treatment missingness should be balanced across treatment assignment conditions.\nHowever, we should avoid “dropping” (excluding) observations based on pretreatment missingness for two reasons. First, it is possible to induce bias in our estimate of an ATE by dropping observations with pre-treatment missingness. After dropping these observations, we can estimate an unbiased estimate the local average treatment effect (LATE) among observations with no missing pretreatment data. However, if treatment effects vary with missingness of pretreatment variables, this LATE may be quite different than the ATE. Second, as we drop observations the number of observations decreases, reducing our power to detect a given ATE. In sum, we should refrain from dropping observations based on pre-treatment covariates to avoid inducing bias or efficiency loss in our estimates of the ATE.\nIn contrast, missingness of the treatment indicator or outcome variable(s) can induce bias in our estimates of causal effects, as demonstrated in #2. This categorization informs the strategies that we adopt to address the consequences of missing data.\n\n\n5. What assumptions do we invoke when we “ignore” treatment or outcome missingness in estimation?\nSuppose that we analyze a dataset with missing treatment or outcome data while ignoring the missingness. If we “ignore” the missingness, we drop observations for which we lack a value for one of these variables. If we proceed to estimate the ATE on the subsample of data for which we have full data for both treatment and outcomes, we estimate:\n\\[E[Y_i(1)|R_i(1)]- E[Y_i(0)|R_i(1)]\\]\nThis is necessarily equivalent to the ATE estimand \\(E[Y_i(1)]-E[Y_i(0)]\\) if missingness is independent of potential outcomes (MIPO), i.e. \\(Y_i(Z) \\perp R_i(Z)\\) (Gerber and Green, 2013). Thus, to interpret \\(E[Y_i(1)|R_i(1)]- E[Y_i(0)|R_i(1)]\\) as an unbiased estimator of the ATE, we must impose an assumption that MIPO.\nThe assumption that MIPO is most plausible when missingness occurs by some random process. Under what conditions might this assumption be plausible? Perhaps we were only able to gather a random subset of administrative outcome data. In this case, missingness would be independent of both potential outcomes and pretreatment covariates. Alternatively, idiosyncratic behavior in data collection (enumerator absence or error) that is plausibly unrelated to potential outcomes may also be consistent with MIPO. On the other hand, survey non-response or other forms of outcome measurement dependent on subject reporting are often much harder to justify under MIPO. Because we cannot validate MIPO, we depend on researchers’ consideration of whether the assumption is plausible under a given data generating process. Where MIPO is not plausible, we should not simply “ignore” missing data in estimation. In these cases, researchers should consider the methods described in #6-#10.\n\n\n6. Why should we assess whether missingness of outcomes is related to treatment assignment?\nWhen researchers encounter missingness in an experiment, they often examine the relationship between missingness of outcomes and treatment assignment. We have denoted reporting (or non-missingness) as a potential outcome of treament assignment, \\(R_i(Z)\\). For a binary treatment, we can denote four “types” of subjects in the experiment, as denoted in the following table.\n\n\n\nType\nProportion\n\\(R_i(1)\\)\n\\(R_i(0)\\)\n\n\n\n\nAlways Reporter\n\\(\\pi_A\\)\n1\n1\n\n\nIf Treated Reporter\n\\(\\pi_T\\)\n1\n0\n\n\nIf Untreated Reporter\n\\(\\pi_U\\)\n0\n1\n\n\nNever Reporter\n\\(\\pi_N\\)\n0\n0\n\n\n\nIn the case in which missingness is related to potential outcomes but not to treatment assignment, we are generally not able to identify an unbiased estimate of the ATE. However, we may be interested in identifying the LATE among always reporters – those subjects for which we observe the outcome regardless of treatment assignment. This effect can be a main estimand of interest and even the most policy-relevant estimand in certain settings. However, to estimate this LATE, we want to be sure that the outcomes that we observe are those of always reporters, not if-treated or if-untreated reporters.\nTo assess the plausibility of ths conjecture, we often examine the relationship between treatment assignment and reporting (non-missingness). Using the notation from the table, we can estimate:\n\\[\\begin{align}\nE[R_i(1)-R_i(0)] &= \\pi_A + \\pi_T - (\\pi_A + \\pi_U)\\\\\n&=\\pi_T - \\pi_U\n\\end{align}\\]\nIf we find no difference in reporting across treatment groups, this test provides no evidence that \\(\\pi_T \\neq \\pi_U\\). However, to further justify that the complete observations in the data are those of “always reporters,” we further must know that \\(\\pi_T = \\pi_U = 0\\). We cannot test this by examining the relationship between reporting and treatment assignment. As such, we generally complement this test with a justification of why reporting should not be endogenous to treatment assignment: for example by assessing covariate balance between treated and control units who are not missing, or by assessing covariate balance between units with missing vs non-missing outcomes. If reporting is not endogenous, then in principle the assumption that \\(\\pi_T = \\pi_U = 0\\) holds. As such, if we find no evidence of differential levels of reporting and see no way that reporting should be endogenous to treatment, we can justify that the \\(E[Y_i(1)|R_i(1) = 1] - E[Y_i(0)|R_i(0) = 1]\\) estimates the LATE among always reporters.\n\n\n7. What is imputation?\nThe most common approaches used to deal with missing data involve the imputation or “filling in” of missing values. In the following dataset with missingness, imputation procedures “fill in” the missing data – the NAs.\n\n\n\n\n\nXobs\nZ\nYobs\n\n\n\n\n-1.2070\n0\n3\n\n\nNA\n0\n2\n\n\n1.0840\n1\n3\n\n\n-2.3460\n1\n4\n\n\n0.4291\n1\n2\n\n\n0.5061\n0\nNA\n\n\nNA\n1\nNA\n\n\nNA\n1\n3\n\n\n-0.5645\n0\n2\n\n\nNA\n0\n1\n\n\n-0.4772\n0\n2\n\n\n-0.9984\n1\n4\n\n\n\n\n\nJust as the consequences of missingness vary by the type of variable that is missing, the imputation methods advocated to address missingness also vary. Importantly, these methods vary in the strength of the assumptions about missingness that are invoked to identify causal effects in the presence of missingness. We review three common approaches to imputation in #8-#10.\n##8. How do we address missingness of pre-treatment covariates and why does this matter?\nAs mentioned in #4, we should never “drop” observations on account of missing pre-treatment data. In order to estimate a model with covariate adjustment, thus, we need to “fill in” missing values to avoid dropping observations. We outline two forms of imputation advocated for missing pre-treatment covariates. The most common approach to address missingness of pre-treatment covariates is to create indicators for missingness and include these as covariates. To do this form of imputation:\n\nSubstitute a numerical value for the NA (as necessary). In the dataset below, we impute a 0 for all values of Xobs that are NAs. The new variable is named Ximputed.\nCreate an indicator for the missingness in each pretreatment variable. This indicator, Xmissing takes the value 1 whenever Xobs is NA, and a 1 otherwise.\n\nOur imputed dataset is thus:\n\n\n\n\n\nXobs\nXimputed\nXmissing\nZ\nYobs\n\n\n\n\n-1.2070\n-1.2070\n0\n0\n3\n\n\nNA\n0.0000\n1\n0\n2\n\n\n1.0840\n1.0840\n0\n1\n3\n\n\n-2.3460\n-2.3460\n0\n1\n4\n\n\n0.4291\n0.4291\n0\n1\n2\n\n\n0.5061\n0.5061\n0\n0\nNA\n\n\nNA\n0.0000\n1\n1\nNA\n\n\nNA\n0.0000\n1\n1\n3\n\n\n-0.5645\n-0.5645\n0\n0\n2\n\n\nNA\n0.0000\n1\n0\n1\n\n\n-0.4772\n-0.4772\n0\n0\n2\n\n\n-0.9984\n-0.9984\n0\n1\n4\n\n\n\n\n\nConsider how this imputation changes the specification of a regression model. Instead of estimating:\n\nmodel1 <- lm(Yobs ~ Z + Xobs)\n\nwe estimate:\n\nmodel2 <- lm(Yobs ~ Z + Ximputed + Xmissing)\n\nThe estimator model2 does not drop observations on the basis of the missing pre-treatment variable Xobs like model1 does.\nAlternatively, if pre-treatment missingness is minimal (less than 10% of observations), or when working with very small datasets with few observations relative to the number of covariates and missingness indicators, Lin, Green, and Coppock (2016) advocate imputing the (unconditional) mean of the observed pre-treatment covariate. Call this variable Ximputed_mean.\n\n\n\n\n\nXobs\nXimputed_mean\nZ\nYobs\n\n\n\n\n-1.2070\n-1.2070000\n0\n3\n\n\nNA\n-0.4467375\n0\n2\n\n\n1.0840\n1.0840000\n1\n3\n\n\n-2.3460\n-2.3460000\n1\n4\n\n\n0.4291\n0.4291000\n1\n2\n\n\n0.5061\n0.5061000\n0\nNA\n\n\nNA\n-0.4467375\n1\nNA\n\n\nNA\n-0.4467375\n1\n3\n\n\n-0.5645\n-0.5645000\n0\n2\n\n\nNA\n-0.4467375\n0\n1\n\n\n-0.4772\n-0.4772000\n0\n2\n\n\n-0.9984\n-0.9984000\n1\n4\n\n\n\n\n\nIf we are simply imputing the pretreatment mean, then instead of estimating model1 (as above) our regression model should be:\n\nmodel3 <- lm(Yobs ~ Z + Ximputed_mean)\n\nSince we have imputed missing values in Xobs when constructing Ximputed_mean, we will not lose observations on the basis of the missing pretreatment covariate when estimating model3.\n\n\n9. We can bound ATEs to account for missing outcome data without making assumptions about the distribution of missing outcomes.\nIf we know the maximum and minimum values of the outcome variable, we can construct bounds on the ATE even in the presence of missing values of the dependent variable. For example, the range of the variable Yobs is 1 to 4. While we do not know what values missing values of Yobs would have been, we can take advantage of the fact that we know the maximum and minimum possible value to construct bounds on the ATE. This allows us to construct an interval estimate of the ATE instead of the point estimate we would construct if we had no missing data. These bounds are known as “extreme value bounds” or “Manski bounds” and do not invoke any additional assumptions about the value of Yobs.\nManski bounds consist of a maximum and minimum bound (estimate) of the possible ATE. To create these bounds, we impute the maximum or minimum value of the outcome variable. as a function of treatment assignment. Thus we construct:\n\nA maximum bound by imputing the maximum value of the outcome for missing values in treatment (\\(Z=1\\)) and imputing the minimum value of the outcome for missing values in control (\\(Z=0\\)).\nA minimum bound by imputing the minimum value of the outcome for missing values in treatment (\\(Z=1\\)) and imputing the maximum value of the outcome for missing values in control (\\(Z=0\\)).\n\nUsing the above dataset, we can construct two variables Y_maxbound and Y_minbound as follows:\n\n\n\n\n\nXobs\nZ\nYobs\nY_maxbound\nY_minbound\n\n\n\n\n-1.2070\n0\n3\n3\n3\n\n\nNA\n0\n2\n2\n2\n\n\n1.0840\n1\n3\n3\n3\n\n\n-2.3460\n1\n4\n4\n4\n\n\n0.4291\n1\n2\n2\n2\n\n\n0.5061\n0\nNA\n1\n4\n\n\nNA\n1\nNA\n4\n1\n\n\nNA\n1\n3\n3\n3\n\n\n-0.5645\n0\n2\n2\n2\n\n\nNA\n0\n1\n1\n1\n\n\n-0.4772\n0\n2\n2\n2\n\n\n-0.9984\n1\n4\n4\n4\n\n\n\n\n\nWithout covariate adjustment, we can obtain our interval estimate of the ATE by estimating:\n\nupper <- lm(Y_maxbound ~ Z)\nlower <- lm(Y_minbound ~ Z)\ncoef(upper)[2]\n\n  Z \n1.5 \n\ncoef(lower)[2]\n\n  Z \n0.5 \n\n\nOur interval estimate of the ATE using Manski bounds is thus [0.5, 1.5].\n\n\n10. Multiple imputation for missing outcomes allows for point estimation of ATEs, but relies on stronger assumptions than bounding.\nThe methods in #8 and #9 describe methods of single imputation, where a single value is substituted for missing values. In multiple imputation, we impute missing values of the dataset multiple times according to an assumed stochastic data generating process. Different methods for multiple imputation impose different structures and assumptions about the probability distributions governing the data generating processes used to impute missing values. In general, multiple imputation proceeds via three stages:\n\nImputation: Missing values are imputed via a random draw of plausible values under the specified data generating process. This creates a full dataset without missing values. Typically, researchers will impute at least five complete datasets. The only differences across these imputed datasets are the values that were missing in the original data.\nEstimation: Estimate the ATE (or other estimand of interest) using each imputed dataset. This generates as many estimates and standard errors as there are imputed datasets.\nPooling estimates: Finally, researchers combine estimates from the different imputed datasets to generate a point estimate of the ATE and its stanard error. Typically, this point estimate can be calculated using Rubin’s rules (2004).\n\nMultiple imputation is implemented in many software packages and relatively straightforward to implement. However, the specification of a data generating process from which datasets are imputed relies on additional assumptions about the correctness of the model of missingness (the data generating process). These assumptions are generally untestable and stronger than the standard experimental assumptions invoked to identify an interval estimate of the ATE using Manski bounds.\n\n\nReferences:\nGerber, Alan S. and Donald P. Green. (2013). Field Experiments: Design, Analysis, and Interpretation. New York: W.W. Norton.\nLin, Winston, Donald P. Green, and Alexander Coppock. (2016). “Standard Operating Procedures for Don Green’s Lab at Columbia.” Available at https://alexandercoppock.com/Green-Lab-SOP/Green_Lab_SOP.html.\nRubin Donald B. (2004). Multiple Imputation for Nonresponse in Surveys. New York: John Wiley and Sons."
  },
  {
    "objectID": "guides/getting-started/multiple-comparisons_en.html",
    "href": "guides/getting-started/multiple-comparisons_en.html",
    "title": "10 Things You Need to Know About Multiple Comparisons",
    "section": "",
    "text": "Abstract\nThe “Multiple Comparisons Problem” is the problem that standard statistical procedures can be misleading when researchers conduct a large group of hypothesis tests. When a researcher does more than one test of a hypothesis (or set of closely related hypotheses), the chances are that some finding will appear “significant” even when there’s nothing going on.\nClassical hypothesis tests assess statistical significance by calculating the probability under a null hypothesis of obtaining estimates as large or larger as the observed estimate. When multiple tests are conducted, however, classical p-values can mislead — they no longer reflect the true probability under the null.\nThis guide 1 will help you guard against drawing false conclusions from your experiments. We focus on the big ideas and provide examples and tools that you can use in R.\n\n\n1: Almost every social science experiment faces a multiple comparisons problem\nTypically, researchers are not interested in just one treatment versus control comparison per experiment. There are three main ways that comparisons proliferate:\n\nMultiple treatment arms. When an experiment has \\(n\\) treatment arms, there are \\(n(n-1)/2\\) possible comparisons between the arms.\nHeterogeneous treatment effects. Often, we are interested in whether the treatment has different impacts on different subgroups. For example, a treatment might be more effective for women than for men.\nMultiple estimators. Often, experimenters will apply multiple estimators to the same dataset: for example, difference-in-means and covariate adjustment. There is of course nothing wrong with employing multiple treatment arms, exploring treatment effect heterogeneity, or using multiple estimators of the treatment effect. However, these design and analysis choices sometimes require that researchers correct their statistical tests to account for multiple comparisons.\nMultiple outcomes. Researchers often assess the effects of an intervention on multiple distinct outcomes or multiple operationalizations of the outcome variable.\n\nThese concerns are especially problematic when making a “family claim,” that is, when you are summarizing a series of results. For example, a family claim might be that treatments A, B, C, and D had no effect, but treatment E did. Or, similarly, the treatment had no effect among group 1, group 2, or group 3, but had a strong effect among group 4.\nThe multiple comparisons problem is related to, but different from, the problem of “fishing.” Fishing occurs when an unscrupulous analyst conducts many tests but only reports the “interesting” ones. In essence, fishing withholds the necessary information we would need in order to correct for multiple comparisons.\n\n\n2: Why multiple comparisons are a problem\nLet’s set up 1 test: we have 1 coin and we will flip it 10 times. We don’t know if the coin is fair but decide that if we flip over 9 heads and 1 tails, we will say that the coin is unfair. Let’s suppose that this is a fair coin; a coin that has a 50% chance of showing a head in a single flip. We are therefore not likely to flip over 9 heads and 1 tails and will most likely find that the coin is fair.\nNow, let’s set up 5 tests: we have 5 coins and we will flip each of them 10 times. Again, we decide that the coin is unfair if we flip 9 heads and 1 tails; again, let’s suppose that all 5 coins are fair. The chance that we see 9 heads and 1 tails for a single coin is still very low. However, after doing 5 tests, it is much more likely that at least 1 of the coins will show 9 heads and 1 tails purely by chance. This result may then lead us to think that some or all of the coins are unfair, even though in reality all the coins are fair.\nWe can see from the coin flipping example that the more tests we run, the more likely we are to see an effect or relationship and the more likely we are to mistakenly claim to have detected an effect when in reality there is no effect and what we observe occurred by chance; this is the multiple comparisons problem.\nIn this guide, we will describe three main approaches for addressing the multiple comparisons problem:\n\np-value adjustments. Statisticians have derived a number of corrections that can guard against multiple comparisons mistakes. As described in the next section, these corrections control either the Family-Wise Error Rate (FWER) or the False Discovery Rate (FDR). Most of these adjustments apply a simple formula to a series of “raw” p-values; we will also describe a simulation method that can take account of features of a specific research setting.\nPre-analysis plans. These plans are a powerful design-based tool that enables an analyst to pro-actively manage the multiple comparisons problem.\nReplication. If we are concerned that a finding is simply an artifact of sampling variability that we happened to discover because of a naive repeated application of classical hypothesis testing, then the best way to resolve the question is to conduct the experiment again.\n\n\n\n3: Don’t mix up the FWER and FDR!\nIn classical hypothesis testing, the “\\(\\alpha\\) level” describes how willing the researcher is to make a certain kind of mistake: a false positive or a “Type I error” where a researcher falsely concludes that an observed difference is “real,” when in fact there is no difference. From the coin flipping example, concluding that we have an unfair coin because we flipped 9 heads and 1 tails when in reality we have fair coins is an example of a Type I error or false positive error. After setting the \\(\\alpha\\) level, the researcher conducts a hypothesis test and if the p-value \\(\\leq \\alpha\\), we call the result “statistically significant”. In many social science applications, the alpha level, or Type I error rate, is set to 0.05. This means that the researcher is willing to commit a Type I error 5% of the time.\nIn the world of multiple testing, the Type I error rate is associated with one of two things: the Family-Wise Error Rate (FWER) or the False Discovery Rate (FDR). To explain their differences, let’s first consider Table 1 which shows different types of errors. After conducting our hypothesis tests, we observe \\(m\\) (the total number of hypothesis tests), \\(R\\) (the total number of hypothesis tests that are statistically significant), \\(m-R\\), (the total number of hypothesis tests that are not statistically significant). However, we do not know how many tests from \\(R\\) are false positives (FP, Type I error) or true positives (TP).\n\n\n\n\n\n\n\n\n\n \nFail to reject null hypothesis (p > 0.05)\nReject null hypothesis (p \\(\\leq\\) 0.05)\nTotal Hypotheses\n\n\n\n\nNull hypothesis is true\nTN  (True Negative)\nFP  (Type I error, False Positive)\n\\(m_0\\)\n\n\nNull hypothesis is false\nFN  (Type II error, False Negative)\nTP  (True Positive)\n\\(m - m_0\\)\n\n\nTotal Hypotheses\n\\(m - R\\)\n\\(R\\)\n\\(m\\)\n\n\n\nThe FWER is the probability of incorrectly rejecting even one null hypothesis, or \\(P(FP \\geq 1)\\) across all of our tests. Suppose we have three null hypotheses, all of which are true. When the null hypothesis is true, but we nevertheless reject it in favor of some alternative, we commit a Type I error. If we set \\(\\alpha\\) (the Type I error rate) to be 0.05, we have a [\\(1−(1−0.05)^3=0.142\\)] chance of rejecting at least one of them. In order to control the FWER (i.e., reduce it from 14.2% back down to 5%), we need to employ a correction. We’ll explore three ways to control the FWER (Bonferroni, Holm, and simulation) in the sections below.\nThe FDR is subtly different. It is the expected proportion of false discoveries among all discoveries, or \\(E[FP/R]\\)2. In the case where no discoveries are found (\\(R=0\\)), then the “share” of false discoveries is taken to be zero. There are some connections to the FWER. For example, if in fact all null hypotheses are true then the FWER and FDR are the same. To see this, note that in this case if no significant rejections of the null are found, then the share that are false discoveries is zero. But if some are found (no matter how many), then the share that are false is 100% (since all null hypotheses are true). So the false discovery rate in this case is just the probability that some true null hypothesis is falsely rejected—the FWER. Beyond this case however the FDR is less stringent than the FWER. We’ll also explore some ways to control FDR in the sections below.\n\n\n4: Control the FWER with Bonferroni-style corrections (including the Holm correction)\nThe Bonferroni correction is a simple and commonly-used approach for addressing the multiple comparisons problem although it usually understates how much information is available to detect an effect. If you conduct \\(m\\) tests but want to make sure that you make no more than \\(\\alpha\\) errors out of the total \\(m\\) tests, the target significance level should be \\(\\alpha/m\\), or, equivalently, you multiply your p-values by \\(m\\), and apply the standard \\(\\alpha\\) level. (The trouble with multiplying the p-values is sometimes you end up with values over one, rendering the interpretation of the p-values incoherent so software just replaces those p-values with the number 1.)\nFor example, suppose you conduct an experiment that has 3 dependent variables. You conduct three difference-in-means tests that yield the following classical p-values: 0.004, 0.020, and 0.122. If your \\(\\alpha\\) level is the standard 0.05 threshold, then you would usually declare the first two tests statistically significant and the last test insignificant. The Bonferroni correction, however, adjusts the target p-value to \\(0.05/3 = 0.016\\). We then declare only the first test to be statistically significant.\nThe Bonferroni correction works under the most extreme circumstances, that is, when all \\(m\\) tests are independent from one another. To see how this works, imagine we are testing three true null hypotheses using a classical \\(\\alpha\\) level of 0.05. Each test, therefore has a 5% chance of yielding the wrong answer that the null hypothesis is false.\nBut our chances of making at least one mistake are much greater than 5% because we have three chances to get it wrong. As above, this probability is in fact [\\(1 - (1 - 0.05)^3 = 0.142\\)]. If we use the Bonferroni correction, however, our chances of getting it wrong fall back to our target \\(\\alpha\\) value: [\\(1 - (1 - 0.05/3)^3 \\approx 0.05\\)] .\nThis correction works in the worst-case scenario that all tests are independent. But in most cases, tests are not independent. That is, if your treatment moves outcome A, it probably moves outcome B too, at least a little. So what tends to happen is, researchers report that their results “withstand” Bonferroni when they are extremely strong, but decry Bonferroni as too extreme when the results are weaker.\nInstead of using the Bonferroni correction, you can use the Holm correction. It is strictly more powerful than Bonferroni, and is valid under the same assumptions. It also controls the FWER. Suppose you have \\(m\\) p-values. Order them from smallest to largest. Find the smallest p-value that satisfies this condition: \\(p_{k}>\\frac{\\alpha}{m+1−k}\\), where \\(k\\) is the p-value’s index. This and all larger p-values are insignificant; all smaller p-values are significant.\nTaking our three p-values from above: 0.004, 0.020, and 0.122: \\[0.004<\\frac{0.05}{3+1−1}=0.017\\] \\[0.020<\\frac{0.05}{3+1−2}=0.025\\] \\[0.122>\\frac{0.05}{3+1−3}=0.050\\]\nUnder the Holm correction, the first two tests are significant, but the last test is not.\n\n\n5: Control the FDR with Benjamini-Hochberg\nThe Benjamini–Hochberg (B-H) procedure controls the FDR. Like the Holm correction, you also begin by ordering \\(m\\) p-values. Then you find the largest p-value that satisfies: \\(p_{k}≤\\frac{k}{m}\\alpha\\). This test, and all tests with smaller p-values are declared significant.\n\\[0.004<\\frac{1}{3}0.05=0.017\\] \\[0.020<\\frac{2}{3}0.05=0.033\\] \\[0.122>\\frac{3}{3}0.05=0.050\\]\nUsing the Benjamini–Hochberg procedure, the first two tests are significant, but the third is not. Notice that the FDR does not control the same error rate as the FWER. It is common for those controlling the FDR error rate to take “significant tests” to indicate places to direct more attention for confirmatory tests (which, would then be analyzed using the stricter FWER control). The idea that one uses the FDR to explore and FWER to confirm is also common in genetics and other applications of large scale hypothesis testing.\n\n\n6: It’s easy to implement these procedures\nIn R, the p.adjust() function contains many of the corrections devised by statisticians to address the multiple comparisons problem. The p.adjust() function is in base R, so no additional packages are required. The p.adjust() function gives adjusted p-values after implementing a correction.\n\n# Set seed for reproducibility\nset.seed(343)\n \n# Generate 50 test statistics\n# Half are drawn from a normal with mean 0\n# The other half are drawn from a normal with mean 3\nx <- rnorm(50, mean = c(rep(0, 25), rep(3, 25)))\n \n# Obtain 50 p-values\np <- round(2*pnorm(sort(-abs(x))), 3)\n \n# Choose alpha level\nalpha <- 0.05\n \n# Without any corrections\nsig <- p < alpha\n \n# Conduct three corrections\n# and compare to target alpha\nbonferroni_sig <- p.adjust(p, \"bonferroni\") < alpha\nholm_sig <- p.adjust(p, \"holm\") < alpha\nBH_sig <- p.adjust(p, \"BH\") <alpha\n\nThe results of this simulation are presented in the table and figure below.\n\n\n\n\n\n\n\n\n\n\nCorrection Type\nNo Correction\nBenjamini-Hochberg\nHolm\nBonferroni\n\n\n\n\nStatistically Significant\n25\n22\n11\n8\n\n\nNot Statistically Significant\n25\n28\n39\n42\n\n\n\n\n\n\n\n\nOf the 25 null hypotheses that would be rejected if no correction were made, the Bonferroni correction only rejects 8, the Holm procedure rejects 11, and the Benjamini–Hochberg procedure rejects 22 (or tags 22 hypotheses as promising for future exploration). Of these three corrections, Bonferroni is the most stringent while Benjamini–Hochberg is the most lenient.\nInstead of R, you can also use this calculator to adjust your p-values.\nThis calculator works best in Firefox. To use full-screen, go here.\n\n\n\n\n7: A better way to control the FWER is simulation\nThe trouble with the corrections above is that they struggle to address the extent to which the multiple comparisons are correlated with one another. A straightforward method of addressing this problem is simulation under the sharp null hypothesis of no effect for any unit on any dependent variable. Note that this is a family-wise sharp null.\nIf the treatment has no effect at all on any outcome, then we observe all potential outcomes for all subjects. We can re-randomize the experiment 1000 or more times and conduct all \\(m\\) hypothesis tests each time. We know for sure that all \\(m\\) null hypotheses are true, because the treatment has no effect by construction.\nThe next step is picking the right threshold value below which results are deemed statistically significant. If \\(\\alpha\\) is 0.05, we need to find the target p-value that, across all simulations under the sharp null, yields 5% significant hypothesis tests.\nOnce we have the right threshold value, it’s as easy as comparing the uncorrected p-values to the threshold value — those below the threshold are deemed significant.\n\n# Control the FWER through simulation\nrm(list=ls())\nlibrary(mvtnorm)\nlibrary(randomizr)\n# Helper functions\ndo_t_test <- function(Y, Z){\n  t.test(Y[Z==1], Y[Z==0])$p.value\n}\npermute_treat <- function(){\n  treatment_sim <- complete_ra(n, m=n/2)\n  ps_sim <- apply(outcomes, 2, do_t_test, Z = treatment_sim)\n  return(ps_sim)\n}\nthreshold_finder<- function(threshold){\n  mean(apply(many_ps, 2, x <- function(x) sum(x <= threshold) > 0 ))\n}\n# Set a seed\nset.seed(343)\n# Generate correlated outcomes\n# Outcomes are unrelated to treatment\n# All null hypotheses are true\nn <- 1000\nk <- 100; r <- .7; s <- 1\nsigma <- matrix(s*r, k,k)\ndiag(sigma) <- s\noutcomes <- rmvnorm(n=n, mean=rep(0, k), sigma=sigma)\n# Complete Random Assignment\ntreatment <- complete_ra(n, m=n/2)\n# Conduct k hypothesis tests\np_obs <- apply(outcomes, 2, do_t_test, Z = treatment)\n# Simulate under the sharp null\nmany_ps <- replicate(1000, permute_treat(), simplify = TRUE)\n# Obtain the Type I error rate for a series of thresholds\nthresholds <- seq(0, 0.05, length.out = 1000)\ntype_I_rate <- sapply(thresholds, threshold_finder)\n# Find the largest threshold that yields an alpha type I error rate\ntarget_p_value <- thresholds[max(which(type_I_rate <=0.05))]\n# Apply target p_value to observed p_values\nsig_simulated <- p_obs <= target_p_value\n# Compare to raw p-values\nsig <- p_obs <= 0.05\n\nThe target p-value obtained by the simulation is 0.002 — hypothesis tests with raw p-values below 0.002 are deemed significant. Compare this with the Bonferroni method, which would require a p-value below 0.05/100 = 0.0005, an order of magnitude smaller. The closer the correlation of the tests (the parameter “r” in the code above) is to zero, the closer the two methods will be.\nThe flexibility of the simulation method is both an advantage and a disadvantage. The advantage is that it can accommodate any set of testing procedures, returning a study-specific correction that will generally be more powerful than other methods to control the FWER. The disadvantage is that it requires the researcher to code up a simulation — there are no prewritten functions that will apply across research contexts.\nHere are some guidelines and tips for writing your own simulation.\n\nFollow the original random assignment procedure as exactly as possible. For example, if you block-randomized your experiment, make sure your simulations permute the treatment assignment according to the same blocks.\nEach simulation should return a set of p-values. (this was accomplished in the permute_treat() function above.)\nBe sure to count up the number of simulations in which at least one test was deemed significant, not the average number of tests across all simulations deemed significant.\n\n\n\n8: Alternative ways to control FDR and variants of FDR\nRecall from earlier that the Benjamini-Hochberg procedure to control FDR can also be too conservative when all null hypotheses are true. There are a number of different variants of the FDR and with each variant, their own procedures for control. In general, these are more powerful than the B-H procedure. Below is a table of a few types:\n\n\n\nFDR Variants\nMethods for Control\nSoftware\n\n\n\n\npFDR: positive FDR, \\(E[V/R|R>0]\\)\nThe Storey-BH procedure sets a rejection area and estimates the corresponding error rate. This contrasts the B-H procedure sets an error rate \\(\\alpha\\) and estimates its rejection area with the adjustments (Storey, 2002).\nSee R package qvalue\n\n\nmFDR or Fdr: marginal FDR, \\(E[FP]/E[R]\\).\n\\(\\alpha\\)-investing, a procedure where, after rejecting a null hypothesis, the researcher can “invest” in the \\(\\alpha\\) threshold by increasing the threshold for subsequent tests (Foster and Stine, 2008).\nSee R package  onlineFDR \n\n\nfdr: Local false discovery rate, \\(fdr(z)\\)\nAn empirical Bayes approach to estimate local false discovery rate as a function of the size of the test statistic \\(z\\) (Efron, 2004).\nSee R pacakge  locfdr \n\n\n\nThere is the increased chance of accepting more false discoveries with these other methods over the basic B-H approach. However, in cases with many, many tests, where the researcher might be willing to accept a few more false discoveries along with making more true discoveries, these methods for controlling FDR are good alternatives.\n\n\n9: Creating an index is a way to get a single comparison out of many\nSuppose3 a researcher measures \\(k>1\\) dependent variables. Indexing allows the researcher to reduce these \\(k\\) outcomes into a single measure (or several thematically-grouped measures). These indexing methods effectively condense the number of dependent variables that investigators test in order to address the multiple comparisons problem. There are a number of ancillary benefits of these indexing methods:\n\nUnlike the other methods of addressing the multiple comparisons problem, the indexing approach may reward researchers for increasing the number of dependent variables. Imagine that a researcher collects \\(k=50\\) outcome variables and that the treatment does not cause significant differences for any of them, but all the point estimates are in the same direction. If we were to apply a multiple comparisons correction to our 50 tests, our results would get even murkier. However, if we combine all 50 dependent variables into a single index, the resulting dependent variable may in fact exhibit significant differences.\nIn the presence of limited amounts of attrition across outcomes, these methods may provide some leverage for dealing with missingness on some dependent variables (but not for units for which outcome variables are entirely unobserved).\n\nThere are two principal indexing methods in the literature:\n\nMean Effects Index\nKling, Liebman, and Katz (2004) employ a mean effects index, constructed as follows:\n\nIf necessary, reorient some outcomes so that beneficial effects are consistently scored higher across all outcomes.\nCalculate a \\(z\\)-score, \\(\\tilde{y}_{ik}\\) by subtracting off the control group mean and dividing by the control group standard deviation, as follows, where \\(i\\) indexes individuals and \\(k\\) indexes outcomes:\n\n\\[\\tilde{y}_{ik}= \\frac{y_{ik}- \\bar{y}_k^{Z=0}}{\\sigma_{k}^{y,Z=0}}\\]\n\nSum the \\(z\\)-scores, \\(\\sum_{i=1}^K \\tilde{y}_{ik}\\) (optionally) divide by \\(K\\) to generate the index.\nOptional: It may be desirable to normalize the final index by the control group mean and standard deviation.\n\nIn the presence of missing outcomes, one of two approaches could be employed:\n\nImputation: Kling, Liebman, and Katz advocate a imputation approach for missing values on individual outcomes. Specifically, prior to constructing the index, compute the mean of each outcome variable for each experimental group, \\(\\bar{y}_{ik}^{Z=1}\\) and \\(\\bar{y}_{ik}^{Z=0}\\) using the above notation. Then, impute the mean corresponding to a unit’s assignment status (treatment or control) prior to constructing the index.\n“Greedy” Indexing: Instead of imputing values of missing outcome variables ex-ante as in method 1, calculate the \\(z\\)-scores as above. Where there are missing values for the “raw” outcome variables, there will be missing \\(z\\)-scores. For each unit, sum the non-missing \\(z\\)-scores and then divide by the number of non-missing outcomes. Hence, instead of dividing \\(\\sum_{i=1}^K \\tilde{y}_{ik}\\) by \\(K\\) as above, we calculate \\(K_{i}\\), the number of non-missing outcomes, for each unit.\n\n\n\nInverse Covariance Weighted Index\nAnderson (2008) provides a similar approach that constructs an index that employs inverse covariance weighting. This weighting scheme improves efficiency relative to the mean effects index above by affording less weight to highly correlated outcomes. The Anderson index can be constructed through the following procedure:\n\nIf necessary, reorient some outcomes so that beneficial effects are consistently scored higher across all outcomes.\nCalculate a \\(z\\)-score, \\(\\tilde{y}_{ik}\\) by subtracting off the control group mean and dividing by the control group standard deviation, as follows, where \\(i\\) indexes individuals and \\(k\\) indexes outcomes:\n\n\\[\\tilde{y}_{ik}= \\frac{y_{ik}- \\bar{y}_k^{Z=0}}{\\sigma_{k}^{y,Z=0}}\\]\n\nConstruct and invert the (variance)-covariance matrix of the resultant matrix of \\(z\\)-scores calculated in step 2. Call this \\(k \\times k\\) inverted (variance)-covariance matrix \\(\\hat{\\boldsymbol{\\Sigma}}^{-1}\\).\nThe weighted indexed outcome, \\(\\bar{s}_i\\) can be estimated via the following procedure, where \\(\\textbf{1}\\) is a \\(k \\times 1\\) vector of ones and \\(\\textbf{y}_{ik}\\) is the \\(n \\times k\\) matrix of \\(z\\)-scores calculated in step 2.\n\n\\[\\bar{s}_i = (\\textbf{1}^T \\hat{\\boldsymbol{\\Sigma}}^{-1} \\textbf{1})^{-1}(\\textbf{1}^T \\hat{\\boldsymbol{\\Sigma}}^{-1} \\textbf{y}_{ik})\\]\n\nOptional: As above, it may be desirable to normalize the final index by the control group mean and standard deviation.\n\nAs with the mean effects index, this varible \\(\\bar{s}_i\\) the serves as the dependent variable in your analysis. One potential drawback to the inverse covariance weighting index is that there is no guarantee that elements in the inverted covariance matrix (\\(\\boldsymbol{\\Sigma}^{-1}\\)) are positive. As such, it is possible to generate negative weights using this indexing method. Given that outcomes are oriented in the same direction, a negative weight effectively reverses the direction of the effect on negatively-weighted outcomes in the construction of the index.\nThe following functions implement both the mean effects and inverse covariance weighted index methods and evaluate both functions on a DGP with 50 outcome measures:\n\nstopifnot(require(mvtnorm))\nstopifnot(require(dplyr))\nstopifnot(require(randomizr))\nstopifnot(require(ggplot2))\nset.seed(1234)\ncalculate_mean_effects_index <- function(Z, outcome_mat, to_reorient, reorient = FALSE, greedy = TRUE,\n                                impute = FALSE){\n  if(length(Z) != nrow(outcome_mat)) stop(\"Error: Treatment assignment, outcome matrix require same n!\")\n  if(impute == TRUE){\n    R <- 1 * is.na(outcome_mat)\n    means_for_imputation <- rbind(apply(outcome_mat[Z==0,], MAR = 2, FUN = mean, na.rm = T),\n                                  apply(outcome_mat[Z==1,], MAR = 2, FUN = mean, na.rm = T))\n    to_impute <- R * means_for_imputation[Z+1,]\n    outcome_mat[is.na(outcome_mat)] <- 0\n    outcome_mat <- outcome_mat + to_impute\n  }\n  c_mean <- apply(X = outcome_mat[Z==0,], MARGIN = 2, FUN = mean, na.rm = T)\n  c_sd <- apply(X = outcome_mat[Z==0,], MARGIN = 2, FUN = sd, na.rm = T)\n  z_score <- t(t(sweep(outcome_mat, 2, c_mean))/ c_sd)\n  index_numerator <- rowSums(z_score)\n  if(greedy == TRUE){\n    n_outcomes <- rowSums(!is.na(z_score))\n  }\n  else if(greedy == FALSE){\n    n_outcomes <- ncol(outcome_mat)\n  }\n  index <- index_numerator/n_outcomes\n  index <-  (index - mean(index[Z==0], na.rm =T))/sd(index[Z==0], na.rm =T)\n  return(index)\n}\ncalculate_inverse_covariance_weighted_index <- function(Z, outcome_mat, to_reorient, reorient = FALSE){\n  if(length(Z) != nrow(outcome_mat)) stop(\"Error: Treatment assignment, outcome matrix require same n!\")\n  if(reorient == TRUE){\n    outcome_mat[, c(to_reorient)] <- -outcome_mat[, c(to_reorient)] \n  }\n  c_mean <- apply(X = outcome_mat[Z==0,], MARGIN = 2, FUN = mean, na.rm = T)\n  c_sd <- apply(X = outcome_mat[Z==0,], MARGIN = 2, FUN = sd, na.rm = T)\n  z_score <- t(t(sweep(outcome_mat, 2, c_mean))/ c_sd)\n  Sigma_hat <- solve(cov(z_score, y = z_score, use = \"complete.obs\"))\n  one_vec <- as.vector(rep(1, ncol(outcome_mat)))\n  if(sum(is.na(outcome_mat))>0){\n    z_score[is.na(z_score)] <- 0\n  }\n  w_ij <- t(solve(t(one_vec) %*% Sigma_hat %*% one_vec) %*% (t(one_vec) %*% Sigma_hat))\n  if(sum(w_ij < 0) > 0){warning('Warning, at least one weight is negative!')}\n  s_ij <- t(solve(t(one_vec) %*% Sigma_hat %*% one_vec) %*% (t(one_vec) %*% Sigma_hat %*% t(z_score)))\n  index <- (s_ij - mean(s_ij[Z==0], na.rm = T))/sd(s_ij[Z==0], na.rm = T)\n  return(s_ij)\n}\n\nWe can see how these indices perform in a setting with \\(k = 5\\) outcome variables.\n\n\n\n[Click to show code]\n\n\n# A DGP with K outcome variables\n# Untreated potential outcomes drawn from multivariate normal distribution\nK <- 5\nr <- runif(n = K, min = -.9, max = .9)\nsigma <- outer(r, r, FUN = \"*\")\ndiag(sigma) <- 1\nmat <- rmvnorm(n = 200, mean = rep(0, K), sigma = sigma)\n# Treatment assignment\nZ <- complete_ra(200)\n# Created observed potential outcomes\n# Assume that ATEs are all oriented in the same direction for the time being\nATEs <- rnorm(K, mean = .25, sd = 1)\nfor(i in 1:K){\n  mat[,i] <- mat[,i] + rnorm(n = 200, mean = Z * ATEs[i], sd = 1)\n}\nmean_effects_index <- calculate_mean_effects_index(Z = Z, outcome_mat = mat, reorient = F)\ninv_cov_weighted_index <- calculate_inverse_covariance_weighted_index(Z = Z, outcome_mat = mat,reorient = F)\n\nFirst, we can examine the properties of the indices alongside our five outcome variables by looking at the covariance matrix.\n\n\n\n[Click to show code]\n\n\nknitr::kable(cov(data.frame(mat, mean_effects_index, inv_cov_weighted_index)), digits = 3)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nX1\nX2\nX3\nX4\nX5\nmean_effects_index\ninv_cov_weighted_index\n\n\n\n\nX1\n2.096\n0.247\n-0.330\n-0.394\n-0.443\n0.448\n0.249\n\n\nX2\n0.247\n2.059\n-0.195\n0.057\n-0.054\n0.747\n0.247\n\n\nX3\n-0.330\n-0.195\n2.614\n-0.172\n0.450\n0.641\n0.295\n\n\nX4\n-0.394\n0.057\n-0.172\n1.784\n0.249\n0.534\n0.242\n\n\nX5\n-0.443\n-0.054\n0.450\n0.249\n2.525\n0.755\n0.305\n\n\nmean_effects_index\n0.448\n0.747\n0.641\n0.534\n0.755\n0.999\n0.428\n\n\ninv_cov_weighted_index\n0.249\n0.247\n0.295\n0.242\n0.305\n0.428\n0.189\n\n\n\n\n\nWe can also plot the two indices to show their similarities (or differences). Note that with the final normalization included in the functions above, both indices are on the same scale.\n\n\n\n[Click to show code]\n\n\ndata.frame(Z, mean_effects_index, inv_cov_weighted_index) %>%\n  mutate(Group = ifelse(Z==1, \"Treatment\", \"Control\")) %>%\n  ggplot(aes(x = mean_effects_index, y = inv_cov_weighted_index, colour = Group)) + \n  geom_point() + theme_bw() + xlab(\"Mean Effects Index\") + ylab(\"Inverse Covariance Weighted Index\")\n\n\n\n\nWe can estimate the treatment effect on the indexed variable using OLS or a difference-in-means. Note that given the normalization of both indices, the coefficient estimates are on the same scale and thus directly comparable. The p-values here use the standard OLS test-statistic.\n\n\n\n[Click to show code]\n\n\ntable <- rbind(summary(lm(mean_effects_index ~ Z))$coef[\"Z\", c (1, 2, 4)], \n        summary(lm(inv_cov_weighted_index ~ Z))$coef[\"Z\", c(1, 2, 4)])\nrownames(table) <- c(\"Mean Effects Index\", \"Inverse Covariance Weighted Index\")\ncolnames(table) <- c(\"Estimate\", \"Std. Error\", \"p-value\")\nknitr::kable(table, digits = 3)\n\n\n\n\n\nEstimate\nStd. Error\np-value\n\n\n\n\nMean Effects Index\n0.304\n0.140\n0.031\n\n\nInverse Covariance Weighted Index\n0.155\n0.061\n0.011\n\n\n\n\n\n\n\n\n10: Use Design Based approaches\nThere are also two design based approaches for thinking about this problem. One is to use pre-analysis plans to describe in advance which comparisons will be made; the number of tests implicated in a Bonferroni or Bonferroni-style correction is specified before any data analysis is conducted. A pre-analysis plan, among its many benefits, helps to clarify the multiple comparisons problem.\nA good example is this pre-analysis plan by Gwyneth McClendon and Rachel Beatty Riedl. The authors specify 24 individual tests they plan to conduct and state ahead of time that they will employ both the Bonferroni and Benjamini-Hochberg corrections. The authors do not state beforehand how they will handle a situation in which the corrections disagree; presumably it will be a matter of judgment for both the authors and the readers of their study.\nAn additional benefit of pre-analysis plans is the ability to specify beforehand what the primary hypothesis is. There is disagreement among methodologists on this point, but some argue that because the primary hypothesis is not part of a “family claim” that a standardp-value is correct. For example, a researcher might have one primary hypothesis and 10 ancillary hypotheses. The uncertainty surrounding the primary hypothesis should not depend on the number of ancillary hypotheses. The advantage of a preanalysis plan is establishing beforehand which of the many hypotheses is the primary one.\nAn alternative perspective is to consider, from a theoretical and research design perspective, what is part of the “family claim.” For example, there may be a set of 5 hypotheses that are all used to support the primary hypothesis and the study was designed to focus on these 5 hypotheses. There may also be ancillary hypotheses that are used for exploration; the study was not developed with these ancillary hypotheses in mind, but the researcher thinks that it is interesting to explore these ancillary hypotheses. In a situation like this, the researcher might identify the 5 hypotheses as confirmatory hypotheses that are a family of hypotheses, and thus make adjustments to the p-values of those hypotheses, say controlling the FWER. The ancillary hypotheses would be considered exploratory hypotheses and do not need adjustments or could use more lenient adjustments compared to the confirmatory hypotheses, say controlling the FDR — allowing some false discoveries. Policy or action may be taken according to the confirmatory hypotheses, while future research may be developed to target the exploratory hypotheses.\nThe advantage of a preanalysis plan is establishing beforehand which of the many hypotheses is the primary one, which hypotheses are part of the same family of hypotheses or confirmatory, and which hypotheses are exploratory.\nA second approach is to turn to replication. Replication is the best guard against drawing false conclusions from a noisy experiment. In particular, replication helps to establish whether heterogeneous effects findings are reliable. Researchers have a large degree of freedom in choosing how to search for heterogeneity — they can explore the entire covariate space searching for interesting interactions. Such a procedure is likely to lead to a large number of false positives. Multiple comparisons corrections such as the ones discussed above might help — but researchers also have discretion as to which correction to apply. Replication addresses this problem directly by measuring the same covariates and looking for differential effects according to the previous experiment’s analysis.\nA good example comes from Coppock, Guess, and Ternovski (2015), in which the same experiment was conducted twice. The experiments measured the effects of two treatments on two dependent variables among four subgroups. In principle, this leads to 60 possible comparisons per experiment.\n\n3 pairwise comparisons between treatment 1, treatment 2, and control.\n4 subgroups means 4 comparisons against zero plus 6 pairwise comparisons = 10.\n2 dependent variables\n3 * 10 * 2 = 60\n\nThe figure below shows the results of the experiment and replication. Study 1 finds that “organization” accounts have smaller treatment effects than females, males, and unknown accounts on the “signed” DV but not the “tweeted” DV. The uncorrected p-value of the difference between “Organization” and “Male” conditional average treatment effects was 0.00003 for the “follower” treatment and 0.00632 for the “organizer” treatment. The Bonferroni correction would multiply both p-values by 60, suggesting that the “organizer” treatment does not work significantly differently for organizations versus men.\nThe replication, however, shows the same pattern of treatment effects: smaller effects for Organization accounts than for others on the “Signed” DV, but similar treatment effects on the “Tweeted” DV. Any doubt that the different response on the two different dependent variables was due to sampling variability are assuaged by the replication.\n\n\n\n\n\n\nFootnotes\n\n\nOriginating author: Alex Coppock, 18 Feb 2015. The guide is a live document and subject to updating by EGAP members at any time. Coppock is not responsible for subsequent edits to this guide. Updated by Lula Chen, 16 Feb 2021.↩︎\nFormally \\(E[FP/R|R>0]P(R>0)\\) to avoid dividing by 0.↩︎\nSection 9 updated by Tara Lyn Slough, 4 February 2016↩︎"
  },
  {
    "objectID": "guides/getting-started/multiple-comparisons_en.html#a-multisite-trial-is-fundamentally-a-blocked-or-stratified-rct.",
    "href": "guides/getting-started/multiple-comparisons_en.html#a-multisite-trial-is-fundamentally-a-blocked-or-stratified-rct.",
    "title": "10 Things to Know About Multisite or Block-Randomized Trials",
    "section": "A multisite trial is fundamentally a blocked or stratified RCT.",
    "text": "A multisite trial is fundamentally a blocked or stratified RCT.\nA multisite trial is a blocked RCT with 2 levels: randomization occurs at the student level (level 1) within blocks defined by sites/schools (level 2). For example, in a study of a new online math tool for high school students, randomization occurs at the student level within blocks defined by sites/schools. Perhaps half of students at each school are assigned to the status quo / control treatment (no additional math practice), and half are assigned to the active treatment (an offer of additional math practice at home using an online tool).\nBecause of the direct correspondence between multisite trials and blocked experiments, statistical properties of blocked experiments also translate directly to multisite experiments. The main difference between a traditional blocked RCT and a multisite experiment is that in many blocked RCTs, the researcher is able to choose the blocks. For example, in a clinical trial, a researcher may decide to block based on gender or specific age categories. Blocking can help increase statistical power overall or ensure statistical power to assess effects within subgroups (such as those defined by time of entering the study, or defined by other important covariates that might predict the outcome) [@moore2012multivariate;@moore2013;@bowers2011mem]. @Pashley2021 makes the distinction between fixed blocks, where the number and covariate distribution of blocks is chosen by the researcher, and structural blocks, where natural groupings determine the number of blocks and their covariate distributions. Multisite experiments have structural blocks, such as districts, schools, or classrooms. The type of block can impact variance estimation, as shown in @Pashley2021 and @Pashley2022.\nThe EGAP Metaketa Projects are also multisite trials: the 5 to 7 countries that contain sites for each study are fixed and chosen in advance by the different research teams."
  },
  {
    "objectID": "guides/getting-started/multiple-comparisons_en.html#a-multisite-trial-is-not-a-cluster-randomized-trial",
    "href": "guides/getting-started/multiple-comparisons_en.html#a-multisite-trial-is-not-a-cluster-randomized-trial",
    "title": "10 Things to Know About Multisite or Block-Randomized Trials",
    "section": "A multisite trial is not a cluster-randomized trial",
    "text": "A multisite trial is not a cluster-randomized trial\nA different type of RCT is a cluster-randomized design, in which entire schools are assigned to either the active treatment or control treatment. This video explains the difference between cluster and block-randomized designs. In a multisite trial, treatment is assigned within a block to individual units. In a cluster-randomized trial, treatment is assigned to groups of units. Some designs combine cluster- and block-randomization.\nAnother design that is not a multisite or block-randomized trial is an experiment that takes place in only one school and assigns individual students to active treatment and control treatment. This type of study has only one site and thus differences between sites do not matter in this design."
  },
  {
    "objectID": "guides/getting-started/multiple-comparisons_en.html#why-choose-a-multisite-or-block-randomized-trial-design",
    "href": "guides/getting-started/multiple-comparisons_en.html#why-choose-a-multisite-or-block-randomized-trial-design",
    "title": "10 Things to Know About Multisite or Block-Randomized Trials",
    "section": "Why choose a multisite or block-randomized trial design?",
    "text": "Why choose a multisite or block-randomized trial design?\nIn most contexts, blocking reduces estimation error over an unblocked (completely randomized) experiment [@moore2012multivariate; @gerber2012field]. Thus, blocked experiments generally offer higher statistical power than unblocked experiments. Blocking is most helpful in increasing precision and statistical power in the setting where there is variation in the outcome, and where the blocks are related to this variation.\nIn multisite trials as compared to block-randomized trials, the researcher typically cannot purposely construct blocks to reduce variation, because they are defined by pre-existing sites. However, the researcher can hope, and often expect, that sites naturally explain some between-site variation. For example, if some schools tend to have higher outcomes than others, then blocked randomization using the school as a block improves efficiency over complete randomization.\nRandomizing with purposefully created blocks or pre-existing sites also helps analysts learn about how treatment effects may vary across the sites or groups of people categorized into the blocks. If a new treatment should help the lowest performing students most, but in any given study most students are not the lowest performing, then researchers may prefer to create blocks of students within schools with the students divided by their previous performance. This blocking within site would allow comparisons of the treatment effects on the relatively rare lowest performing students with the treatment effects on the relatively rare highest performing students."
  },
  {
    "objectID": "guides/getting-started/multiple-comparisons_en.html#why-not-block",
    "href": "guides/getting-started/multiple-comparisons_en.html#why-not-block",
    "title": "10 Things to Know About Multisite or Block-Randomized Trials",
    "section": "Why not block?",
    "text": "Why not block?\nOften, in a multisite trial with treatment administered by site administrators (like principals of schools), an analyst has no choice but to randomize within site. In other studies, the construction and choice of blocking criteria is a choice. @Pashley2022 shows that blocking is generally beneficial, but also explores settings in which it may be harmful. Blocking does result in fewer degrees of freedom, but in practice this reduction is rarely an issue, unless an experiment is very small [@Imai2008]. Any use of blocking requires that an analyst keep track of the blocks and also that an analyst reflect the blocks in subsequent analysis: in many circumstances estimating average treatment effects from a block-randomized experiment while ignoring the blocks will yield biased estimates of the underlying targeted estimands (see “The trouble with ‘controlling for blocks’” and “Estimating Average Treatment Effects in Block Randomized Experiments” for demonstrations of bias arising from different approaches to weighting by blocks)."
  },
  {
    "objectID": "guides/getting-started/multiple-comparisons_en.html#common-linear-regression-models",
    "href": "guides/getting-started/multiple-comparisons_en.html#common-linear-regression-models",
    "title": "10 Things to Know About Multisite or Block-Randomized Trials",
    "section": "Common linear regression models",
    "text": "Common linear regression models\nFixed effects with a constant treatment (FE)\nWith this model, the researcher assumes that there are site-specific fixed effects (intercepts), but a common overall ATE. The assumed model is [ Y_{ij} = {k = 1}^{J} k {k,ij} + T{ij} + e_{ij}, ] where \\(\\text{Site}_{k,ij}\\) is an indicator for unit \\(ij\\) being in site \\(k\\) (out of \\(J\\) sites), \\(T_{ij}\\) is a treatment indicator, and \\(e_{ij}\\) is an \\(iid\\) error term. For more discussion, see @Raudenbush2015.\nFixed effects with interactions (FE-inter)\nWith this model, the researcher assumes site-specific heterogeneous treatment effects, so in addition to fitting a separate fixed effect for the intercepts for each site, a separate treatment impact coefficient is found for each site. [ Y_{ij} = {k = 1}^{J} k {k,ij} + {k = 1}^{J} k {k,ij} T_{ij} + e_{ij} ] Given a series of site-specific treatment estimates \\(\\hat{\\beta}_j\\), these estimates are then averaged, with weights by either simple weighting (see @Clark2011) or by site size."
  },
  {
    "objectID": "guides/getting-started/multiple-comparisons_en.html#common-multilevel-models",
    "href": "guides/getting-started/multiple-comparisons_en.html#common-multilevel-models",
    "title": "10 Things to Know About Multisite or Block-Randomized Trials",
    "section": "Common multilevel models",
    "text": "Common multilevel models\nOnce an analyst selects multilevel modeling, for site intercepts and site impacts they must decide: what is considered random, and what is considered fixed?\nFixed intercept, random treatment coefficient (FIRC)\nThis model is similar to the fixed effects models above, but assumes that the site impact \\(\\beta_j\\) is drawn from a shared distribution. The FIRC model was more recently designed to handle bias issues that arise when the proportion of units treated varies across sites.\n\\[\\begin{align*}\n\\text{Level 1}\\qquad & Y_{ij} = \\sum_{k = 1}^{J} \\alpha_k\n\\text{Site}_{k,ij} + \\beta_j T_{ij} + e_{ij}\\\\\n\\text{Level 2}\\qquad & \\beta_j = \\beta + b_j\n\\end{align*}\\] See @Raudenbush2015 and @Bloom2017.\nRandom intercept, random treatment coefficient (RIRC)\nThis model is an older version of multilevel models, and assumes that both the site intercept and site impact are drawn from shared distributions. \\[\\begin{align*}\n\\text{Level 1}\\qquad & Y_{ij} = A_j + \\beta_j T_{ij} + e_{ij}\\\\\n\\text{Level 2}\\qquad & \\beta_j = \\beta + b_j\\\\\n& A_j = \\alpha + a_j\n\\end{align*}\\]\nRandom intercept, constant treatment coefficient (RICC)\nFinally, this model assumes that the site intercepts are drawn from a shared distribution, but the treatment impact is shared. \\[\\begin{align*}\n\\text{Level 1}\\qquad & Y_{ij} = A_j + \\beta T_{ij} + e_{ij}\\\\\n\\text{Level 2}\\qquad & A_j = \\alpha + a_j\\\\\n\\end{align*}\\] As noted previously, the multilevel framework generally naturally corresponds to the super population perspective. However, for RICC models, the site impacts are not assumed to be drawn from a super population; only the site intercepts are assumed to be random. Thus, when it comes to estimating treatment impacts, RICC models actually take a finite population perspective.\nThere are also weighted versions of both traditional regressions and multilevel models. For example, a fixed-effects model can weigh each person by their inverse chance of treatment to help increase precision. Weighted regression for traditional regression is discussed in @Miratrix2020, and weighted regression for multilevel models is discussed in @Raudenbush2020."
  },
  {
    "objectID": "guides/getting-started/multiple-comparisons_en.html#design-based-estimators",
    "href": "guides/getting-started/multiple-comparisons_en.html#design-based-estimators",
    "title": "10 Things to Know About Multisite or Block-Randomized Trials",
    "section": "Design-based estimators",
    "text": "Design-based estimators\nDesign-based estimators are the most straightforward, as they are composed of simple weighted combinations of means. First, the site-specific treatment impact estimates \\(\\hat{B_j}\\) are calculated by taking differences in means between the active treatment and control treatment groups for each site. Then, the overall estimate is a weighted combination of these estimates, weighted by either person or site weighting.\nThe design-based estimators are \\[\\begin{align*}\n\\hat{\\beta}_{DB-persons} &= \\sum_{j = 1}^{J} \\frac{N_j}{N} \\hat{B_j} \\\\\n\\hat{\\beta}_{DB-sites} &= \\sum_{j = 1}^{J} \\frac{1}{J} \\hat{B_j}.\n\\end{align*}\\] Design-based estimators are generally unbiased for their corresponding estimands (person-weighted or site-weighted). Unbiasedness does not hold for one super population model; see @Pashley2022 for more details."
  },
  {
    "objectID": "guides/getting-started/multiple-comparisons_en.html#linear-regression-estimators",
    "href": "guides/getting-started/multiple-comparisons_en.html#linear-regression-estimators",
    "title": "10 Things to Know About Multisite or Block-Randomized Trials",
    "section": "Linear regression estimators",
    "text": "Linear regression estimators\nConsider the FE model (fixed effects with a constant treatment). This regression model results in a precision-weighted estimate, in which each site impact is weighted by the estimated precision of estimating that site’s impact. The estimator is [ {FE} = {j = 1}^{J} , ] where \\(p_j\\) is the proportion treated at site \\(j\\). The quantity \\(Z\\) is a normalizing constant, so \\(Z\\) is defined as \\(\\sum_{j = 1}^{J} N_j p_j (1-p_j)\\) to ensure the weights sum to one. The weights are \\(N_j p_j (1 - p_j)\\), which is the inverse of \\(Var(\\hat{\\beta_j})\\), so the weights are related to the precision of the estimate for each site. This expression shows that sites with larger \\(N_j\\), or that have \\(p_j\\) closer to \\(0.5\\), have larger weights.\nThe FE estimator is not generally unbiased for either person-weighted or site-weighted estimands. If the impact size \\(B_j\\) is related to the weights (\\(N_j p_j (1 - p_j)\\)), then the estimator could be biased. For example, if sites that treat a higher proportion of treated units also experience a larger treatment impact, then \\(B_j\\) can be related to \\(p_j (1- p_j)\\). This setting is plausible for example if sites with more resources to intervene on more students also implement the intervention more effectively. If larger sites are more effective, then \\(B_j\\) can be related to \\(N_j p_j (1- p_j)\\).\nInstead, the FE estimator is unbiased for an estimand that weights the site impacts by \\(N_j p_j (1- p_j)\\). However, this estimand does not have a natural substantive interpretation. Although the FE estimator is generally biased for the estimands of interest, it may have increased precision and thus a lower mean squared error.\nIn contrast, the FE-inter model ends up with weights identical to the design-based estimators, depending on if the estimated site impacts are weighted equally or by size."
  },
  {
    "objectID": "guides/getting-started/multiple-comparisons_en.html#multilevel-model-estimators",
    "href": "guides/getting-started/multiple-comparisons_en.html#multilevel-model-estimators",
    "title": "10 Things to Know About Multisite or Block-Randomized Trials",
    "section": "Multilevel model estimators",
    "text": "Multilevel model estimators\nMultilevel models also result in precision weighting, but in these models the estimated precision also takes into account the assumed underlying variance in site impacts. For example, the FIRC model can be expressed roughly as: [ _{ML-FIRC*} = _{j = 1}^{J} ( + 2){-1} , ] where \\(Z\\) is again a normalizing constant, \\(Z = \\sum_{j = 1}^{J} \\left(\\frac{\\sigma^2}{N_j p_j ( 1 - p_j)} + \\tau^2\\right)^{-1}\\). This equation assumes that the \\(b_j\\) have known variance \\(\\tau^2\\), and the \\(e_{ij}\\) have known variance \\(\\sigma^2\\). In general, we do not know these quantities, and instead must estimate them. However, we can see that the implied precision weights incorporate the additional uncertainty assumed in the value of \\(b_j\\).\nThe RIRC model imposes the same structure on the site impacts, and thus the weights are similar to the FIRC model. The RICC model assumes a constant treatment impact, and thus is essentially equivalent to the precision-weighted fixed effects with constant treatment model (FE) when it comes to estimating the site impacts.\nWe summarize the weights in the table below. The following table includes additional estimators that are not discussed in this guide; for more information about these additional estimators, see @Miratrix2020.\n\n\n\n\n\n\n\n\nWeight name\nWeight\nEstimators\n\n\n\n\nUnbiased person-weighting\n\\(w_j \\propto N_j\\)\n\\(\\hat{\\beta}_{DB-FP-person}\\), \\(\\hat{\\beta}_{DB-SP-person}\\), \\(\\hat{\\beta}_{FE-weight-person}\\), \\(\\hat{\\beta}_{FE-inter-person}\\)\n\n\nFixed-effect precision-weighting\n\\(w_j \\propto N_j p_j (1 - p_j)\\)\n\\(\\hat{\\beta}_{FE}\\), \\(\\hat{\\beta}_{FE-HW}\\), \\(\\hat{\\beta}_{FE-CR}\\), \\(\\hat{\\beta}_{ML-RICC}\\) (approximately)\n\n\nRandom-effect precision-weighting\n\\(w_j \\propto \\left[\\hat{\\tau} + N_j p_j (1 - p_j)\\right]^{-1}\\)  (approximately)\n\\(\\hat{\\beta}_{ML-FIRC}\\), \\(\\hat{\\beta}_{ML-RIRC}\\)\n\n\nUnbiased site-weighting\n\\(w_j \\propto 1\\)\n\\(\\hat{\\beta}_{DB-FP-site}\\), \\(\\hat{\\beta}_{DB-SP-site}\\), \\(\\hat{\\beta}_{FE-weight-site}\\), \\(\\hat{\\beta}_{FE-inter-site}\\)"
  },
  {
    "objectID": "guides/getting-started/multiple-comparisons_en.html#point-estimates",
    "href": "guides/getting-started/multiple-comparisons_en.html#point-estimates",
    "title": "10 Things to Know About Multisite or Block-Randomized Trials",
    "section": "Point estimates",
    "text": "Point estimates\nFirst, they consider the impact of choices on point estimates. The authors ask, “to what extent can the choice of estimator of the overall average treatment effect result in a different impact estimate?” In general, the authors find that the choice of estimator can substantially impact the point estimates, although the degree of impact depends on the choice. The authors reach the following conclusions.\nPerson-weighted estimands can result in a different conclusion than site-weighted estimands.\nIn some trials, estimates resulting from person-weighted estimands differed substantially from estimates resulting from site-weighted estimands. These discrepancies could be due to a difference in the true underlying values of the estimands, but they could also be due to estimation error from the estimation procedure. Through empirical exploration, they found that the difference is likely due to the estimands themselves being different. They found that “the range of estimates across all estimators is rarely meaningfully larger than the range between the person- and site-weighted estimates alone.”\nFor person-weighted estimands, the choice of estimator generally does not matter.\nThe unbiased design-based estimator and the precision-weighted fixed effect estimate both target the person-weighted estimand. There was little difference in estimates between these estimators. Most likely, “this implies that the potential bias in the bias-precision trade off to the fixed effect estimators is negligible in practice.” Other authors have been able to create situations in which the bias-precision trade off is more severe.\nFor site-weighted estimands, the choice of estimator can matter.\nFIRC estimates did differ from the unbiased design-based site estimator. FIRC can be seen as an adaptive estimator: when there is little estimated variation in impacts between sites, it tends to be more similar to the person-weighted estimate instead of the site-weighted estimate.\nDifferent estimators have different bias-variance trade offs.\nFinally, the authors consider the empirical bias-variance trade off of different estimators, and find:\n\nFE estimators have little bias, but also do not improve precision much over design-based estimators.\nFIRC tends to have lower mean squared error than design-based estimators.\nLarger site impact heterogeneity results in more biased estimates for FIRC.\nEven with more site impact heterogeneity, the mean squared error for FIRC estimators is still generally lower.\nCoverage for design-based estimators is more reliable, especially when site size is variable and site size is correlated with impact."
  },
  {
    "objectID": "guides/getting-started/multiple-comparisons_en.html#standard-errors",
    "href": "guides/getting-started/multiple-comparisons_en.html#standard-errors",
    "title": "10 Things to Know About Multisite or Block-Randomized Trials",
    "section": "Standard errors",
    "text": "Standard errors\nThe second question concerns the choice of standard error estimators. The authors ask, “to what extent can the choice of estimator of the standard error of the overall average treatment effect result in a different estimated standard error?”\nThe choice of standard error estimator can substantially impact the estimated standard error. The authors reach the following conclusions.\nThe choice of estimand impacts the standard error.\nSuper population estimators generally have larger standard errors than finite population estimators. Site-weighted estimators generally have larger standard errors than person-weighted estimators.\nGiven a particular estimand, the choice of estimator matters in some contexts and not others.\nFor finite population estimands (including both person and site-weighted estimands) or super population person-weighted estimands, the choice of standard error estimator generally does not matter. In practice, @Miratrix2020 found that estimators that attempt to improve precision by trading bias may not actually result in gains in precision in practice. The use of robust standard errors also does not differ much from non-robust standard errors in practice.\nFor super population site-weighted estimands, the choice of standard error estimator can matter a lot. In most cases, standard error estimates differed substantially between the design-based super population estimator and FIRC. The authors further conclude that for super population site-weighted estimands, the wide-ranging standard error estimates stem from instability in estimation. Through a simulation study, they find that super population standard errors can underestimate the true error. The design-based super population standard error estimator is particularly prone to underestimate the standard error compared to multilevel models, and can be unstable, in that it estimates a wide range of different values across simulations."
  },
  {
    "objectID": "guides/getting-started/null_en.html",
    "href": "guides/getting-started/null_en.html",
    "title": "10 Things Your Null Result Might Mean",
    "section": "",
    "text": "Abstract\nAfter the excitement and hard work of running a field experiment is over, it’s not uncommon to hear policymakers and researchers express disappointment when they end up hearing that the intervention did not have a detectable impact. This guide explains that a null result rarely means “the intervention didn’t work,” even though that tends to be the shorthand many people use. Instead, a null result can reflect the myriad design choices that policy implementers and researchers make in the course of developing and testing an intervention. After all, people tend to label hypothesis tests with high p-values as “null results”, and hypothesis tests (as summaries of information about design and data) can produce large p-values for many reasons. Policymakers can make better decisions about what to do with a null result when they understand how and why they got that result.\nImagine you lead the department of education for a government and are wondering about how to boost student attendance. You decide to consider a text message intervention that offers individual students counseling. Counselors at each school can help students address challenges specifically related to school attendance. Your team runs a randomized trial of the intervention, and tells you there is a null result.\nHow should you understand the null result, and what should you do about it? It could be a result of unmet challenges at several stages of your work – in the way the intervention is designed, the way the intervention is implemented, or the way study is designed Below are 10 things to consider when interpreting your null result.\n\n\nIntervention Design\n\n1. Your intervention theory and approach are mismatched to the problem.\nYou delivered a counseling intervention because you thought that students needed support to address challenges in their home life. However, students who had the greatest needs never actually met with a counselor, in part because they did not trust adults at the school. The theory of change assumed that absenteeism was a function primarily of a student’s personal decisions or family circumstances and that the offer of counseling without changes to school climate would be sufficient; it did not account appropriately for low levels of trust in teacher-student relationships. Therefore, this null effect does not suggest that counseling per se cannot boost attendance, but that counseling in the absence of other structural or policy changes or in the context of low-trust schools may not be sufficient.\nHow can you tell if…you have a mismatch between your theory of change and the problem that needs to be solved? List all potential barriers and consider how they connect. Does the intervention as designed address only one of those barriers, and, if so, can it succeed without addressing others? Are there assumptions made about one source or one cause that may undermine the success of the intervention?\n\n\n2. Your intervention strength or dosage is too low for the problem or outcome of interest.\nAfter talking to experts, you learn that counseling interventions can build trust, but usually require meetings that are more frequent and regular than your intervention offered to have the potential for an effect. Maybe your “dose” of services is too small.\nHow can you tell if…you did not have a sufficient “dose”? Even if no existing services tackle your problem of interest, consider what is a minimum level, strength, or dose that is both feasible to implement and could yield an effect. When asking sites what they are willing to take on, beware of defaulting to the lowest dose. The more complex the problem or outcome is to move, the stronger or more comprehensive the intervention may need to be.\n\n\n3. Your intervention does not represent a large enough enhancement over usual services.\nIn your position at the state department of education, you learn that students at the target schools were already receiving some counseling and support services. Even though the existing services were not sufficient to boost attendance to the targeted levels, the new intervention did not add enough content or frequency of the counseling services to reach those levels either—the intervention yielded show-up rates that were about the same as existing services. So this null effect does not reflect that counseling has no effect, but rather that the version of counseling your intervention offered was not effective over and above existing counseling services.\nHow can you tell if…the relative strength of your intervention was not sufficient to yield an effect? Take stock of the structure and content of existing services, and consider if the extent or form in which clients respond to existing services indicates that the theory of change or approach needs to be revised. If the theory holds, use existing services as a benchmark and consider whether your proposed intervention needs to include something supplementary and/or something complementary.\n\n\n\nIntervention Implementation\nPrograms rarely rollout exactly as intended, but some variations are more problematic than others.\n\n4. Your implementation format was not reliable.\nIn the schools in your study, counseling interventions sometimes occurred in person, sometimes happened by text message, sometimes by phone. Anticipating and allowing for some variation and adaptation is important. Intervention dosage and strength is often not delivered as designed nor to as many people as expected.\nBut unplanned variations in format can reflect a host of selection bias issues, such that you cannot disentangle whether counseling as a concept does not work or whether certain formats of outreach did not work. This is especially important to guard against if you intend to test specific channels or mechanisms critical to your theory of change.\nHow can you tell if…an unreliable format is the reason for your null? Were you able to specify or standardize formats in a checklist? Could you leave enough discretion but still incentivize fidelity? Pre-specifying what the intervention should look like can help staff and researchers monitor along the way and correct inconsistencies or deviations that may affect the results. This could include a training protocol for those implementing the intervention. If nothing was specified or no one was trained, then the lack of consistency may be part of the explanation.\n\n\n5. Your intervention and outcome measure are mismatched to your randomization design.\nYou expected counseling to be more effective in schools with higher student-to-teacher ratios, but did not block randomize by class size (for more on block randomization, see our guide on 10 Things to Know About Randomization). then it may no longer have the potential to be more effective for students in high class size schools .\nHow can you tell if…you have a mismatch between your intervention and randomization design? Consider whether treatment effects could vary, or service delivery might occur in a cluster, or intervention concepts could spill over, and to what extent your randomization design accounted for that.\n\n\n\nStudy Design\n\n6. Your study sample includes people whose behavior could not be moved by the intervention.\nYou ask schools to randomize students into an intervention or control (business-as-usual) group. Some students in both your intervention and control groups will always attend school, while some students will rarely attend school, regardless of what interventions are or are not offered to them. Your intervention’s success depends on not just whether students actually receive the message and/or believe it, but also on whether it can shift behavior among such potential responders.\nIf the proportion of potential responders is too small, then it may be difficult to detect an effect. In addition, your intervention may need to be targeted and modified in some way to address the needs of potential responders.\nHow can you tell if…the proportion of potential responders may be too small? Take a look at the pre-intervention attendance rate. If it is extremely low, does that rate reflect low demand or structural barriers that may limit the potential for response? Is it so high that it tells us that most people who could respond have already done so (say, 85% or higher)? Even if there is a large proportion of hypothetical potential responders, is it lower when you consider existing barriers preventing students from using counseling services that your intervention is not addressing?\n\n\n7. Your measure is not validated or reliable: It varies too much and systematically across sites.\nAs a leader of the state’s department of education, you want to measure the effectiveness of your intervention using survey data on student attitudes related to attendance. You learn that only some schools administer a new survey measuring student attitudes, and those with surveys changed the survey items so that there is not the same wording across surveys or schools. If you observe no statistically significant difference on a survey measure that is newly developed or used by only select schools, it may be difficult to know whether the intervention “has no effect” or whether the outcome is measuring something different in each school because of different wording.\nHow can you tell if… outcome measurement is the problem? Check to see whether the outcome is (1) collected in the same way across your sites and (2) if it means the same thing to the participants as it means to you. In addition, check on any reporting bias and if your study participants or sites face any pressure from inside or outside of their organizations to report or answer in a particular way.\n\n\n8. Your outcome is not validated or reliable: It varies too little.\nGiven the problems with the survey measure, you then decide to use administrative data from student records to measure whether students show up on time to school. But it turns out that schools used a generic definition of “on time” such that almost every student looks like they arrive on time. An outcome that does not have enough variation in it to detect an effect between intervention and control groups can be especially limiting if your intervention potentially could have had different effects on different types of students, but the outcome measure used in the study lacks the precision to capture the effects on different subgroups.\nHow can you tell if…your null result arises from measures that are too coarse or subject to response biases? Pressures to report a certain kind of outcome faced by people at your sites could again yield this kind of problem with outcome measurement. So, it is again worth investigating the meaning of the outcomes as reported by the sites from the perspective of those doing the reporting. This problem differs from the kind of ceiling and floor effects discussed elsewhere in this guide; it arises more from the strategic calculations of those producing administrative data and less from the natural behavior of those students whose behavior you are trying to change.\n\n\n9. Your statistical power is insufficient to detect an effect for the intervention as implemented.\nThis may sound obvious to people with experience testing interventions at scale. But researchers and policymakers can fall into two traps:\n\nThinking about statistical significance rather than what represents a meaningful and feasible effect. Although a study with an incredibly large sample size can detect small effects with precision, one does not want to trade precision for meaning. Moreover, an intervention known to be weak during the intervention design is likely to be weaker when implemented, especially across multiple sites or months. So it may not be sufficient to simply enroll more subjects to study an intervention known to be weak (even though strong research design cannot compensate for a weak intervention in any easy or direct way);\nThinking that the only relevant test statistic for an experiment effect is a difference of means (even though we have long known that differences of means are valid but low-powered test statistics when outcomes do not neatly fit into a normal distribution).\n\nHow can you tell if…your null result arises mostly from low statistical power? Recall that statistical power depends on (a) effect size or intervention strength, (b) variability in outcomes, (c) the number of independent observations (often well measured with sample size), and (d) the test statistic you use. The previous discussions pointed out ways to learn whether an intervention you thought might be strong was weak, or whether an outcome that you thought might be clear could turn out to be very noisy.\nA formal power analysis could also tell you that, given the variability in your outcome and the size of your effect, you would have needed a larger sample size to detect this effect reliably. For example, if you had known about the variability in administration of the treatment or the variability in the outcome (let alone surprises with missing data) in advance, your pre-field power analysis would have told you to use a different sample size.\nA different test statistic can also change a null result into a positive result if, say, the effect is large but it is not an effect that shifts means as much as moves people who are extreme, or has the effect of making moderate students extreme. A classic example of this problem occurs with outcomes that have very long tails – such as those involving money, like annual earnings or auction spending. A t-test might produce a p-value of .20 but a rank-based test might produce a p-value of < .01. The t-test is using evidence of a shift in averages (means) to reflect on the null hypothesis of no effects. The rank-based test is merely asking whether the treatment group outcomes tend to be bigger than (or smaller than) the control group outcomes (whether or not they differ in means).\n\n\n\nNot all nulls are the result of a flaw in design or implementation!\n\n10. Your null needs to be published.\nIf you addressed all the issues above related to intervention design, sample size and research design, and have a precisely estimated, statistically significant null result, it is time to publish. Your colleagues and other researchers need to learn from this finding, so do not keep it to yourself.\nWhen you have a precise null, you do not have a gap in evidence–you are generating evidence.\nWhat can you do to convince editors and reviewers they should publish your null results? This guide should help you reason about your null results and thus explain their importance. If other studies on your topic exist, you can also contextualize your results; for example, follow some of the ideas from Abadie 2019.\nFor an example, see how Bhatti et al.–in their study of a Danish governmental voter turnout intervention–used previous work on face-to-face voter turnout (reported on as a meta-analysis here) to contextualize their own small effects.\nIf you are unable to find a publication willing to include a study with null results in their journal, you can still contribute to the evidence base on the policy area under examination by making your working paper, data, and/or analysis code publicly available. Many researchers choose to do so via their personal websites; in addition, there are repositories (such as the Open Science Framework) that provide a platform for researchers to share their in-progress and unpublished work."
  },
  {
    "objectID": "guides/getting-started/pap_en.html",
    "href": "guides/getting-started/pap_en.html",
    "title": "10 Things to Know About Pre-Analysis Plans",
    "section": "",
    "text": "Abstract\nThis guide introduces the idea of a pre-analysis plan (PAP), offers a model and guiding questions for writing pre-analysis plans for your studies, and explains the uses of a pre-analysis plan. Links to PAP registries with example plans are provided at the end of this document.\n\n\n1 What is a Pre-Analysis Plan (PAP)\nA PAP is a document that formalizes and declares the design and analysis plan for your study. It is written before the analysis is conducted and is generally registered on a third-party website.1\nThe objectives of the PAP are to improve research design choices, increase research transparency, and allow other scholars to replicate your analysis. As a result, we recommend focusing the PAP on analytic details that will help you analyze your study and allow other researchers to replicate your analysis. A brief section on theory should be included insofar as it helps articulate hypotheses, but a detailed theory and literature review need not be included. The PAP does not need to include the front-end of an academic paper if these sections do not help you think about your analysis or help readers replicate your analysis.\nIn the following sections, we provide guidelines for the details you should include in PAPs, including example text. We also recommend that you include as much code and analysis of simulated data as possible.2 Many PAPs will not be able to include everything on our list, but a PAP should, at a minimum, include the full list of hypotheses that you intend to test, how you will measure variables relevant to those hypotheses, and a verifiable time stamp.\n\n\n2 What is in a PAP? Study Design Overview\nThe first section of a PAP should provide a brief overview of your study design. If this study is an experiment, describe the randomization procedure and the intervention or experimental procedure. If the study is not an experiment, describe the data. These descriptions should include: (1) unit of analysis, population, and inclusion/exclusion criteria, (2) method (observational, experimental, quasi-experimental), (3) experimental intervention or explanatory variable, and (4) outcomes of interest.\n\nExample: Let us use a simplified version of an intervention in Malawi as a running example.  We use a block-randomized experiment to evaluate the effect of information and public service provision (explanatory variable) on tax compliance (outcome) in Malawi, where service delivery is low and tax noncompliance is high. Our unit of analysis is the owner-occupied household in a city in Malawi. We exclude renters because only homeowners pay the city taxes relevant to our study. We cluster households within 80 neighborhood-level units of approximately 20 households each. Each neighborhood is also a block such that 10 households within each neighborhood are assigned to treatment and 10 households are assigned to control. Our intervention is the provision of information and public services. We implement this intervention by providing two free waste pickups, a visit from a canvasser to discuss how tax payments fund city services like waste collection, and a pamphlet with more information about tax payments.  Our main outcome is tax compliance, which we study as city tax payments. We conduct a survey and collect administrative data on tax payment both before and after the intervention.\n\n\n\n3 What is in a PAP? Hypotheses\nThe PAP should specify your hypotheses – the relationship(s) you expect to observe between variables. The formulation of a hypothesis should make clear whether it involves one- or two-tailed tests (i.e. predict an increase, decrease, or change in the outcome variable).\nThere are two types of hypotheses to consider including in your PAP: confirmatory and exploratory. Confirmatory hypotheses are the main focus of most studies; these are the hypotheses your study is designed to test. Your analyses for these hypotheses will typically be well-powered and you will generally have a strong theory leading to these hypotheses a priori.\nExploratory hypotheses are hypotheses you may wish to test but are not the main focus of your study. They are often secondary hypotheses about mechanisms, subgroups, heterogeneous effects, or downstream outcomes. The analyses guided by these hypotheses may not be well-powered and your theory may not focus on these effects, but analysis of these hypotheses may lead to surprising discoveries.\nSome people prefer to list few hypotheses and others prefer to list many. As a rule, you should include as many hypotheses as relate to your theory or intervention.3 This may be a single outcome, but if your experimental intervention or theory makes predictions about 8 outcomes, list hypotheses for those 8 outcomes. If your experimental intervention or theory postulates specific mechanisms through which the explanatory variable affects an outcome or outcomes, those mechanisms should be clear in the hypothesis.\nNote that with more than one hypothesis you will need to specify a procedure for handling multiple hypotheses in the inference criteria section of your PAP, either by correcting for multiple tests or by aggregating all hypotheses into an index or an omnibus test.4 If using an omnibus test, you could list all outcomes under one hypothesis. See our section about inference criteria for more about correcting for multiple tests.\n\nExample: Hypotheses We specify our confirmatory hypothesis as:\n\n\nH: The treatment will increase tax compliance among treatment households vs. control households.\n\n\n In addition to overall improved attitudes toward government, we expect that residents may shift their attitudes about specific issues. We would like to explore which issues may be driving the overall attitudinal changes with the following exploratory hypotheses:\n\n\nH: The treatment will increase beliefs that the city deserves to collect taxes among treatment households vs. control households.\n\n\nH: The treatment will increase beliefs in city service capacity among treatment households vs. control households.\n\n\nH: The treatment will increase beliefs in city enforcement capacity among treatment households vs. control households.\n\n\n\n\n\n4 What is in a PAP? Measures and Index Construction\nThe PAP should specify the way you measure or operationalize variables of interest, including outcomes, covariates, and explanatory variables. These operationalizations can be included as its own section, or the operationalization of variables can be included after the hypothesis for which each variable is relevant.\nFor each variable, the PAP should list the way the variable is measured (such as survey or interview questions, administrative data, behavioral/observational measures, etc.) and to which hypothesis or hypotheses the variable relates. Details of these measures, such as precise wording for survey questions, should be included either in this section or in an appendix. If you are using indices or factors, or combining outcomes together in other ways, specify how the combined outcomes will be constructed. If you are manipulating or transforming the outcomes in some way (such as logging a variable), describe the manipulation or transformation process.\nWe recommend including code in your PAP to show how you plan to execute all data transformation.\n\nExample: Measures and Index Construction We measure our primary outcome, tax compliance, using administrative data on citizen tax payments. The tax compliance measure takes the value \\(0\\) if the household did not pay taxes and \\(1\\) if the household did pay taxes. Our explanatory variable is assignment to treatment, where individuals who are assigned to treatment are assigned \\(1\\) and individuals assigned to control are assigned \\(0\\). We also create a “government attitudes” index using inverse-covariance weights (ICW) of 6 survey questions where higher values mean more positive attitudes towards government. The ICW index weighs the baseline questions by the covariance of the responses in the control group at baseline and weighs the endline questions by the covariance of the responses in the control group at endline. We then standardize the ICW scale by standard deviation so that a 1 at baseline means 1 SD above the mean at baseline and a 1 at endline means a 1 SD above the mean at endline.\n\n\n\n5 What is in a PAP? Estimation Procedure\nNow that you have described your study design, hypotheses, and variables, you are ready to discuss your testing and estimation procedures.\nThis section should clearly specify what you are estimating (i.e. the estimand) and how you intend to estimate it (i.e. the estimator). For example, many studies estimate the average treatment effect of an experimental intervention using OLS linear regression as the estimator.5 Clearly specify your model specification, including your outcomes, explanatory variables, and covariates, and your test statistic.\nWe recommend including code for the statistical model or the functional form of the statistical model in the PAP.\n\nExample: Estimation Procedure We estimate the effect of the information campaign and waste collection service on the payment of city taxes among residents with an intent-to-treat analysis. Our estimand is the average treatment effect. If we have balance on baseline and endline outcomes, we will use the following estimator to estimate the average treatment effect: \\(Y_{i,j} = \\beta_0 + \\beta_1Z_{i,j} + X_{i,j}+ \\epsilon_{i,j}\\) where \\(i\\) is the individual in neighborhood \\(j\\), \\(Z\\) is the treatment indicator, and \\(Y\\) is the outcome. \\(X\\) is the baseline outcome for individual \\(i\\). We will use regression weights proportional to the size of the neighborhoods \\(j\\). If baseline and endline outcomes are not balanced, we will use the change score, \\(Y_i = Y_{i,endline} - Y_{i,baseline}\\) and we will not use \\(X\\).\n\n\n\n6 What is in a PAP? Inference Criteria\nInference criteria are decision rules for determining the detectability of effects (i.e. if an explanatory variable really affects an outcome variable). Establishing inference criteria requires making several choices about when to believe the estimated effect is “statistically significantly different” from the null hypothesis. We recommend clearly specifying and justifying answers to the following questions:\n\nWhat kind of standard errors will you use? Why are you using this kind of standard errors?6\nDo you plan to do a one-tailed or two-tailed test?\n\nAt what \\(\\alpha\\) level will you reject the null hypothesis from a \\(p\\)-value?\n\nDo you have multiple hypotheses? If so, what procedure will you use to adjust for multiple comparisons?\n\nYou may choose to use several procedures for inference criteria. For example, you may want to use both FWER and FDR adjustments for multiple comparisons and compare between the two. Or you may want to use \\(p\\)-values from randomization inference as a check on \\(p\\)-values from a null distribution assumed to be normal. If you choose to use several procedures, you should specify how you will interpret findings if different procedures come to different conclusions.\n\nExample: We use HC2 standard errors with our block-randomized experiment because it is equivalent to randomization-based Neyman variance estimator [@samii2012]. We expect the treatment group to pay more city taxes than the control group, and therefore use a one-tailed test where \\(H_1 > H_0\\). We set \\(\\alpha = 0.05\\) and will reject the null when the \\(p\\)-value is less than 0.05. Because we only have one confirmatory hypothesis, we do not adjust for multiple comparisons.  As a check on the HC2 standard errors, we also calculate \\(p\\)-values directly using randomization inference, with the difference-in-means as our test statistic.\n\n\n\n7 What is in a PAP? Procedures for Data Issues\nExperiments and data collection often do not go the way that one expects or hopes. The PAP gives you an opportunity to think through what those issues might be, and specify how you plan to address them.\nTwo common data issues are (1) extreme data points and (2) missing data. Extreme points may represent a true outlier – a unit with outcomes much larger or smaller than other units – or may occur because of data collection errors. Survey tablets, recording tools, web scrapers, and other data collection tools may record extreme points due to technical glitches. It can be difficult to know whether extreme points represent true data collected or if they are due to data entry errors, but it is important to specify in the PAP when you expect to see data collection errors and the procedures to deal with extreme points.\nMissing data can come in two forms: missing covariates and missing outcomes. It is also important to specify when you expect to see missing outcomes or covariate and the procedures to deal with them in your PAP. Extreme points/missingness that are random will be less problematic than extreme points/missingess that seem to have a pattern.\nCommon procedures to address missing data or extreme points are 1) bounds analysis; 2) imputation; 3) dropping observations. We recommend considering the following questions when determining which procedure you would like to use:\n\nWhat issues may cause these extreme data points/missing covariates/missing outcomes? What can you do ahead of time to mitigate these data issues?\nHow would you assess if the extreme/missing data are plausibly random (i.e. do the extreme data points/missingness correlate with treatment, specific covariates/subgroups, or outcomes)?\nWhat procedures will you use to address extreme points/missingness and how do you justify using your procedure?\n\nIf extreme/missing data are not random, we recommend including some kind of bounds analysis to determine the bounds of your estimate with extreme points/missing data. For example, extreme value bounds can help you determine the range of an average treatment effect by setting all missing outcomes in the treatment group with largest possible outcome and setting all missing outcomes in the control group with the smallest possible outcome [@gerber2012field].\n\nIf extreme/missing data are random, we recommend imputing the extreme points or missing data. You may also drop these data if the extreme/missing data are random, and you should specify conditions under which you choose to drop the data. For example, consider setting a threshold for a missing covariate such that if the percentage of data missing from the covariate exceeds the threshold, you drop the covariate.\n\n\nWe recommend including code to show your procedures to address data issues.\n\nExample: Missing Outcomes from Survey Questions Some respondents will not answer one or more questions that measure an outcome. If we notice that nonresponse rates for questions seem high (\\(\\geq 10\\%\\)) during the pilot session, we will ask for explanations from both respondents and interviewers so that we can change the questions.\nWhen respondents do not answer one or more questions that measure an outcome as we field our survey, our procedure is as follows:\n\n\nWe will assess the relationship between missing outcomes and treatment assignment using a hypothesis test and report these results.\n\n\nIf \\(p < .05\\) for the assessment of the relationship between treatment and missing outcomes, we will report an extreme value bounds analysis in which we set all of the missing outcomes for treatment to the block maximum and all missing outcomes for control to the block minimum.\n\n\nIf \\(p \\geq 0.5\\) for the assessment of the relationship between treatment and missing outcomes, we will impute the missing outcomes using the mean of the assignment-by-block subcategory.\n\n\nIf we still have outcome questions with especially high nonresponse rate of over 10 percent, we will:\n\n\nDescribe the relationship between non-response to this question and other data on the people via\n\n\n\nBivariate explorations of plots and/or tables\n\n\nVariable selection using adaptive elastic net models with tuning parameters chosen by 10-fold cross validation within design-subgroup.\n\n\n\nConsider dropping these survey outcomes and catalog the reason for our decision.\n\n\n\n\n\n8 What is in a PAP? Power Analysis\nA power analysis is commonly included in PAPs. Statistical power is the likelihood that your study will detect an effect, if there is an effect to be detected.\nThere are tools to help you calculate power, but you can also produce your own power analysis computationally. A benefit of computational power analysis is that the power analysis doubles as your final analysis code, or at minimum a template of the final analysis code.\nIn many ways, the computational power analysis implements all of the specifications you made in your PAP into code. In fact, you can combine code for a computational power analysis with the code written for other sections of the PAP, and create a computational PAP. Such a tool, which can be implemented with software like DeclareDesign, can then help you diagnose potential problems, teach you more about your design, and strengthen your PAP.\n\n\n9 Why make a PAP?\nYou may have heard arguments for and against PAPs. This discussion offers some thoughts that address the benefits and costs of PAPs.\n1. PAPs help counter the replication crisis.\nA lack of research transparency has led to several issues, one of which is the replication crisis.\nThe replication crisis is that many academic studies are difficult or impossible to replicate. PAPs reduce the number of studies that are not replicable due to bad data practices, such as data mining for spurious relationships and inadvertently hacking \\(p\\)-values. PAPs also increase the number of studies that elaborate the procedures necessary for replication, allowing attempts to replicate those studies.\n\n\n2. PAPs help counter publication bias.\nA lack of research transparency also contributes to publication bias.\nPublication bias occurs when journals publish studies based on the study’s results, rather than the quality of the research. This bias can lead to erroneous beliefs about a connection between variables \\(X\\) and \\(Y\\) because journals only publish studies that show \\(X\\) affecting \\(Y\\) and do not publish studies where \\(X\\) does not affect \\(Y\\), even if those studies are more numerous.\nPAP registries function as repositories of attempted studies, both published and unpublished. These registries allow scholars and practitioners to identify if published effects about a topic accurately represent the effects found in unpublished studies, or if published effects differ from unpublished studies.\nPre-registering studies as exploratory or confirmatory further allows researchers to know if future research should build off the study or if future research should corroborate the study. There is nothing wrong with exploratory research, and many important but unknown relationships can be uncovered through exploratory analyses. It is important to acknowledge when findings are exploratory and need to be confirmed in other studies. Details in PAP registries allow scholars to do so.\n3. PAPs encourage quality research.\nCreating a PAP forces the researcher to elaborate the many design decisions that need to be made while conducting a study. In the case of observational studies, changing these design decisions later is not a problem. But for experimental studies or other studies using original data collection, the researcher gets one chance to collect the data needed for the analysis. PAPs help ensure the researcher thinks through all decisions and collects the right data.\n4. PAPs encourage impactful research.\nPAPs increase research transparency, and transparent research should be more readily trusted and used than non-transparent research because the study’s decisions, and reasons for those decisions, are made before the study’s results are known. Transparency assures academic, policy, and other communities that the research findings can be used as the basis for more research, for policy programs, and for other real-world applications.\n5. PAPs can shorten the publication process.\nPAPs require more pre-research time-investment, but substantially shorten post-research analysis time because analytic decisions and code are written in advance. PAPs should also shorten the review process that leads to publication. Journals often require numerous robustness checks before accepting the results of a study. Reviewers may request fewer alternative analyses from pre-specified work because it is clear to reviewers that pre-specified analysis decisions were not influenced by the study’s results. This is especially useful when the researcher wants to use an unconventional but more powerful statistical test that may look suspicious without pre-specification, such as one-sided tests or test statistics other than the difference-in-means.\nWhy not make a PAP?\n1. Research is unpredictable and PAPs make research inflexible.\nSome people argue that a PAP locks the study into a particular design, intervention, and estimation strategy even though details of the design, intervention, and estimation strategy may change while conducting a study. In experimental studies, unforeseen difficulties often change aspects of the randomization or intervention, or a new outcome measure may fail validity tests. And in observational studies, future thought about how a theory applies to your data may reveal the need for new control, mediating, and/or moderating variables.\nResearchers should remember that any Pre-Analysis Plan can be revised! Your first PAP does not lock you into a specific research design, outcome variable, or model specification. The PAP makes the research process transparent, not inflexible. Revisions can be made either by submitting a new PAP or through an amendment describing changes from the previous PAP..  Exploratory analyses are okay! The point of a PAP is not to prevent these unanticipated analyses, but to formalize and explain the process that led to the analyses.\n\nMore discussion of the pros and cons of PAPs can be found in chapter 19 of @rosenbaum2010 and in @olken2015.\n\n\n10 When and where do you register a PAP?\nYour PAP is now complete and you are ready to register it! For experimental studies, the latest you should register the PAP is before final data are collected. For observational studies, the latest you should register the PAP is before any analyses are done, including looking at descriptive statistics. You can revise PAPs through an amendment at any time.\nThere are several third-party sites on which you can register your PAP. We list common sites for social science PAPs below. You can list your PAP on multiple sites, and certain journals require potential articles to register PAPs with a specific site.7\n\nEGAP Registry\nAEA Registry (for RCTs only)\nOSF Registry\n\n\nHappy Pre-Analysis Planning!\n\n\nReferences\n\n\n\n\n\nFootnotes\n\n\nPAPs are encouraged as part of the Transparency and Openness Promotion (TOP) Guidelines [@nosek2015], published in Science, with leading social science journals committing to implementing TOP Guidelines.↩︎\nResources like the DeclareDesign project can assist you with simulating and analyzing fake data that mimics the real data your project will gather. Power analysis, an important component of a PAP, requires simulated data.↩︎\nAs R.A. Fisher said and has often been requoted, “Make your theories elaborate…when constructing a causal hypothesis one should envisage as many different consequences of the truth as possible,” (Cochran, 1965; cited in @rosenbaum2010, pp. 327). Though this was said about determining causation in observational studies, the logic also applies to experimental studies.↩︎\nFor an example of an omnibus test, see @caughey2017npc.↩︎\nYou may also be interested in estimating other types of effects. See this guide on types of treatment effects for more information about effect types.↩︎\nFor example, you could calculate standard errors and \\(p\\)-values using permutation-based randomization inference. Or you could closely approximate standard errors and \\(p\\)-values using analytic methods [@samii2012]↩︎\nNote that some organizations do not use third party sites. For example, the U.S. General Services Administration Office of Evaluation Sciences process uses Github, which has timestamps that verify the PAP was created before the analysis was conducted.↩︎"
  },
  {
    "objectID": "guides/getting-started/pilots_en.html",
    "href": "guides/getting-started/pilots_en.html",
    "title": "10 Things to Know About Pilot Studies",
    "section": "",
    "text": "1. What is a pilot, and what is it good for?\nDuring the process of planning an experiment, researchers often face questions regarding their study’s theoretical and conceptual underpinnings, its measurement approach, and associated logistics. Pilot studies can help you to consider and improve these elements of your research whether you are running a survey, lab, or field experiment. In particular, a pilot study is a smaller scale preliminary test or trial run, used to assist with the preparation of a more comprehensive investigation. Pilots are typically administered before a research design is finalized in order to evaluate and improve the feasibility, reliability, and validity of the proposed study.\nWhile it may be tempting to think about a pilot as simply a miniature version of one’s final study, helpful for doing an initial test of one’s hypotheses, pilot studies are neither especially appropriate for hypothesis testing, nor are they limited to it. Given smaller sample sizes, pilots are typically underpowered for evaluating hypotheses. Besides, deciding whether to continue a study based on initial results contributes to the “file drawer” problem where important studies and results—including null results—are never published, leading to misrepresentative bodies of published research (Franco et al. 2014).\nFortunately, as depicted in the table below, pilots can be useful for a wide range of research purposes including theory development, research design, improving measurement, sampling considerations, evaluating logistics, pre-planning analysis, weighing ethical considerations, and communicating one’s research (van Teijlingen et al. 2001; Thabane et al. 2010). Each of these activities can help improve the quality of one’s main study and render it more compelling and ultimately successful.\nIn the sections below, we review these many benefits. First, we consider how pilots can assist with a study’s theory and measurement approach, evaluate its logistical feasibility, and provide information about the sample size needed to test hypotheses. In addition, we discuss how piloting may help you secure research funding and institutional support, gather feedback, and incorporate best practices in research ethics. Finally, we offer recommendations on how to use pilots to inform your main study design, reveal important unknowns, and contribute to your broader research agenda.\n\n\n\n\nPilots can be useful for:\n\n\n\n\n\n\nTheory Development\nResearch Design\n\n\n\n\n\nRefining your research questions and hypotheses\nDetermining initial plausibility of theorized mechanisms\nIdentifying additional research questions of interest\nExploring unknowns related to your research questions and hypotheses\n\n\nEvaluating suitability of study context for answering research questions\nDetermining construction and strength of treatments\nDetermining number, levels, and timing of treatments\nConsidering alternative and/or multiple measures of participant response to treatment\n\n\n\n\n\n\n\n\n\n\n\nMeasurement\n\nTesting alternative treatments and outcomes to improve clarity, validity, and reliability\nUncovering issues related to asymmetry in delivery and measurement of treatments and/or outcomes\nConsidering covariate measurement approach\nEnsuring successful data collection and data entry\nIdentifying additional information that may need to be collected\nConsidering the use of combined measures such as scales and indices\n\nSample | ================================+ * Determining power and sample | size needed for main study | * Evaluating recruitment | procedures and eligibility | criteria | * Testing participant understanding of research | tools and procedures | * Assessing participant compliance and treatment | uptake | * Assessing participant response rate, quality, and | attrition | | | | |\n\n\n\n\n\n\n\n\n\n\n\n\nLogistics\n\nDetermining time and resources needed to conduct main study\nEvaluating randomization procedure\nAssessing research team understanding of protocols and procedures\nDetermining partner capacity and willingness\nTraining research team members and partners\nAssessing inter-researcher reliability in data collection, procedures, and analysis\n\nAnalysis | ===============================+ * Considering feasibility of | software, statistical | techniques, or other analytic | tools given preliminary data | * Preparing analysis procedures for main study | * Considering feasibility of incorporating data from | partners or other sources | * Considering responses to | missingness in data | | | | | |\n\n\n\n\n\n\n\n\n\n\n\n\nEthics\nCommunicating Research\n\n\n\n\n\nEnsuring participant safety and well-being\nEvaluating consent procedures\nAssessing participant time and burdens\nEnsuring normative acceptability of study elements in given context\nAssessing privacy and confidentiality procedures\nAssessing security of data and other study materials\n\n\nCollecting preliminary data to share externally\nSoliciting feedback on research design\nLeveraging pilot results transparently to explain design choices for main study\nDemonstrating research team capacity and competence\nPersuading funders, ethics committees, and other stakeholders of study feasibility and value\nInforming interested scholars and other stakeholders\nEducating students about research practices\n\n\n\n\n\n\n\n\n2. Pilots are useful for improving your study’s measurement approach in relation to your theory\nFewer things are more frustrating for a researcher than investing significant resources and time into a study only to find that one’s outcome measures lack reliability to accurately assess the concepts of interest, or that participants did not receive treatments in the way that was anticipated. Unexpected results are common, even when one approaches measurement carefully, as operationalizing concepts into an effective measurement strategy in the social sciences is a complex endeavor.\nAs a remedy, pilots are great for testing different versions of treatments and outcomes to see which of them “work” or whether any changes may be needed to increase validity, reliability, and clarity. For example, you can include a larger set of outcome measures in a pilot than is feasible in the main study, and perform simple factor analysis to identify a preferred subset of measures. Pilot results can also inform whether it makes sense to create indices or scales in order to improve reliability and decrease variance. Subtle variation in the strength, nature, timing, or number of treatments can also significantly alter study findings. Pilots offer researchers the opportunity to evaluate multiple possibilities for one’s treatment design, and to assess how these options influence participant compliance, uptake of treatment, attrition, and more.\nWhen refining one’s approach to measuring treatments, outcomes, and covariates, it is especially important to keep in mind how these elements of one’s research design speak to the broader concepts and theory under study. Will the data you receive provide the necessary information regarding the theoretical elements and causal mechanisms under study? Are there other causal channels that may be in play, or heterogeneous effects within subgroups that you hadn’t thought about previously? These kinds of considerations can inform changes to your research design, such as alterations to your randomization strategy, the introduction of new dimensions in your treatments, and decisions about which aspects of your study are core and which can be saved for a later date.\nWhen you begin a pilot study, you may have an initial conception of your research questions, hypotheses, and measurement approach; but with a careful pilot, you have the opportunity to refine all of these aspects in a way that can increase your (and others’) confidence in the overall quality of the study.\n\n\n3. Pilots can also help you to prepare for the logistics of running your experiment\nPerhaps the most often emphasized purpose of pilots is to work out any logistical kinks that might impede the main study (Thabane et al. 2010). Logistical considerations include those implicating a project’s overall resources, the study team, the participants, and the administration of study instruments.\nIn terms of participant logistics, is important to establish whether your study participants understand the research tools and procedures, are able to receive treatment, and feel comfortable answering questions or performing tasks. Based on how successful the pilot is, you may find ways to improve your recruitment strategy, adjust your eligibility criteria, and improve the clarity of your research instruments. It is also important to ensure that basic elements like randomization and data collection are working as anticipated. Data simulations and pilots with very small samples can also be used to test certain study elements.\nSimilar considerations apply to your study team and partners. Do they understand the protocols or might they require additional training, for example, to promote reliability in procedures such as data collection? Are there any asymmetries in delivery or measurement of treatment or outcomes of which you were not aware? A pilot can also be very helpful for determining the resources needed to conduct the main study. For example, how much time does it take—for both members of the study team and participants—and what might this imply for the size of the sample and complexity of the research design that is ultimately feasible for the main study?\nWhile the specific logistical considerations will vary depending on whether your research design is centered around a field experiment, survey experiment, lab experiment, or something else, pilots will help you ensure that your experiment goes as planned. Thus, when constructing a pilot study, consider making a list of the logistical elements you want to evaluate and designing the pilot to facilitate answering associated questions. Asking your participants whether they were able to “hear the video” or “understood the instructions” can make your research easier down the road.\n\n\n4. You can use pilots for power analysis or for calculating minimum detectable effects\nAnother common purpose of pilot studies, in light of limited resources, is assessing statistical power, which helps to avoid the risk of false negatives (or false positives) from underpowered studies. As Coppock (2013) describes in the EGAP methods guide about power analysis, a researcher’s goal is to answer the following: “supposing there truly is a treatment effect and you were to run your experiment a huge number of times, how often will you get a statistically significant result?” To improve the likelihood that your main study will achieve a typical target power value of 80%, you can use a pilot study combined with careful simulations. These results are helpful for determining appropriate sample sizes, the extent to which you can subset your sample for various analyses, and whether adjustments may be necessary for increasing power.\nTraditionally, a pilot study is used to obtain an estimate of the effect size, which becomes the presumed estimate for simulations used to determine power and sample size in one’s main study. However, DeclareDesign (2019) cautions that effect size estimates are very noisy in small pilots, especially when true effect sizes are small (for example, under 0.2 sd). As an alternative, they recommend using pilot studies to estimate the standard deviation of the outcome variable. Using this estimate, one can easily obtain an unbiased estimate of a main study’s minimum detectable effect (MDE) for a given outcome and with 80% power as 2.8 times the estimated standard error of the associated outcome variable (Gelman and Hill 2006). The goal is to ensure that the MDE is small enough that the study would capture any substantively meaningful effect.\nUsing the recommendations from DeclareDesign (2019), we provide sample code based on a hypothetical pilot study. In the code below, we assume we have already conducted a pilot study and have calculated the standard deviation of a key outcome measure for both the control and treatment groups. Next, we use these estimates to calculate MDEs for different possible sample sizes, in order to inform our target sample size for a future main study.\n\nrequire(tidyverse)\n#Standard deviations of outcome measure for treatment & control groups calculated from pilot study results\n#The ones provided are for purposes of demonstration\n#We assume one treatment and control group--you will need to adjust to study specifics\nsd_control <- 1.5\nsd_treat <- 1.2\n#MDE calculation for various possible sample sizes\nN <- seq(from=500, to=3000, by=100)\nMDE <- vector()\nfor (i in 1:length(N)){\n  #We assume an equal number of participants in treatment and control--you will need to adjust to study specifics\n  MDE[i] <- 2.8 * sqrt((sd_control^2/(N[i]/2)) + (sd_treat^2/(N[i]/2))) #The true effect size must be at least 2.8 standard errors from zero to detect it with 80% probability using 95% confidence intervals (Gelman and Hill 2006). To estimate the standard error of the ATE, we use equation 3.6 in Gerber and Green (2012). Thus, simply multiply 2.8 by the standard error of the ATE to calculate the MDE. \n}\n#Visualizing results to identify target sample size for main study\nmde_data <- as.data.frame(cbind(N, MDE))\nmde_plot <- ggplot(mde_data, aes(x=N, y=MDE)) + geom_point() +\n  xlab(\"Sample Size\") + ylab(\"MDE\") + ggtitle(\"Minimum Detectable Effect (MDE) for Main Study by Sample Size\") + \n  theme_bw() +\n  geom_hline(yintercept = .2, lty = \"dashed\")\nmde_plot\n\n\n\n\nBased on the hypothetical standard deviations in the control and treatment groups from the pilot study, the main study would need a sample size of approximately 1,500 to ensure that effect sizes as small as 0.2 sd are detectable. While calculating the MDE based on pilot results is straightforward, determining how small an MDE should be is more subjective, and should be informed by theory and prior work.\nMDE calculations are based on the design of the pilot and the specific outcome measures. Thus, you may need to perform MDE calculations for each estimand of interest to determine what sample sizes are needed and which hypotheses can be addressed with sufficient power given your experimental design. Keep in mind that as you use pilot results to refine your study design, including treatments and outcomes, the relevant standard deviations of the outcome measures and the resultant MDE calculations may change. Another quick pilot is an option, though it is important to take resource constraints into account.\n\n\n5. Piloting may help you secure funding and support for your research\nPilots are not only helpful for improving the quality of your main study, they may also help to ensure you have the support and funding to enable your study to go forward. Given a general trend of tightening of per-researcher funding, particularly for smaller projects (Bloch and Sørensen 2015), and a movement towards evidence-based decision-making, you may wish to draw on pilots to provide initial evidence that your study is worthwhile. For example, the National Science Foundation (NSF) recognizes the need for more early-stage exploratory studies that can provide a basis for future larger-scale studies, and Time-sharing Experiments for the Social Sciences (TESS) notes that “Proposals that report trial runs of novel and focal ideas will be viewed as more credible.”\nThis does not entail that one needs to show that effect sizes are large enough nor that hypotheses are likely to be confirmed. Instead, a pilot can demonstrate that your research project is feasible in terms of time and resources, that your study design is adequate for answering the research questions proposed, and that your research team has the expertise and capacity to administer the study, perform analyses, and even present results in a compelling fashion (van Teijlingen et al. 2001). In a similar fashion, piloting can help you to recruit study team members and organizational partners, or solicit institutional support.\n\n\n6. You can use a pilot to get feedback on your study design\nSharing initial findings, successes, and challenges is a great way to help you prepare for your main study. In light of the growth of the open science movement (Christensen et al. 2020), conferences and workshops are increasingly open to accepting submissions based on pre-analysis plans and pilot results. Whether through these more formal venues, or by reaching out to colleagues or experts, you can use pilot results to receive feedback about your study design, such as strategies to address possible challenges and unexplored theoretical or empirical directions that you can incorporate in your main study.\nFurther, it can take a long time to complete an experimental study and publish results. Sharing intermediate findings allows you to coordinate with other researchers in the field, helping you to align your work and incorporate recent theoretical and empirical innovations relevant to your study.\nUltimately, the design and piloting stage is the best time to receive feedback, as you still have time to make improvements. In contrast, most key research design decisions will already have been finalized by the time your study undergoes formal peer review for publication.\n\n\n7. Keep an eye out for ethical considerations when piloting\nWhen you design your study initially, all of the relevant ethical considerations and risks may not be immediately apparent. The piloting stage is thus a good opportunity to review whether any risks or harms you anticipated may come into play and whether still other ethical considerations should be incorporated into your main study.\nYou can use your pilot to evaluate whether your procedures around informed consent are adequate and to assess the extent of burdens such as time required of participants. You may find, for example, that certain topics—such as mental health and personal identity—are more sensitive than anticipated, or that survey questions (even those based on validated and popular measures) use outdated and offensive language. The best way to find out is to ask. Consider including open-ended survey questions or talking to participants directly to determine what participants think of the study in terms of its normative and cultural acceptability in a given context.\nIn addition, the piloting process is a good time to practice your procedures around privacy, confidentiality, and security of data and other materials. You may find that other procedures for obtaining consent, ensuring participant safety and well-being, and promoting privacy and anonymity are necessary to improve the ethical dimensions of your main study. This can include decreasing risks as well as increasing benefits to participants, such as by providing helpful resources and information that may help to mitigate possible harms.\nNote that this doesn’t imply any less ethical consideration should be given to your pilot itself. All appropriate safeguards, including IRB review, apply to human subjects research for a pilot study as well.\n\n\n8. Be transparent about how your pilot informs the design of your main study\nAs noted, it’s helpful to pre-identify a set of questions about logistics, measurement, or other features of your study that you believe a pilot can help to answer. Putting these questions into writing, designing your pilot to facilitate answering them, and reporting on how the answers shape any modifications to your main study is a way in which you can promote transparency in research. This includes transparency within one’s study team about the purposes of a pilot, as well as for external audiences such as funders or peer reviewers. Transparency helps to alleviate concerns such as the file drawer problem, for example by demonstrating that a pilot study does not function as a method for cherry-picking statistically significant results. It also facilitates understanding and receipt of feedback.\nThe table below is a simple illustrative example of how one could transparently present lessons learned from a hypothetical pilot, for example, in a pre-analysis plan or research proposal. The first column indicates the question the pilot is intended to help answer, in this case questions related to logistical adequacy, manipulation checks, delivery of treatments, and measurement of outcomes. The second column presents the associated findings from the pilot, and the third column discusses how the lessons learned will inform design choices for the main study.\n\n\n\n\n\n\n\n\n\n\nQuestion\nPilot Results\nDesign Decision\n\n\n\n\nCan participants hear the video treatments?\n10% reported difficulty.\nWe will add subtitles to the video treatments.\n\n\nCan participants identify the politician party, indicating successful treatment?\n75% correctly identified the politician party.\nWe will mention the politician party additional times to make this treatment component more memorable to participants.\n\n\nWhich video treatments from the available options are best to use?\nParticipants were more familiar with some politicians in the videos than others.\nWe will randomize subjects to a more familiar or less familiar politician and may explore heterogeneous effects by politician familiarity.\n\n\nWhat is the best way to measure uncertainty as an outcome?\nRespondents appear to have been confused by bidirectional scales and questions with reversed scales.\nWe will use unidirectional scales and also consider the distribution (variance) of other key outcome measures.\n\n\n\n\n\n\n\n9. Explore unknowns\nWhile you may begin your study with a set of preestablished questions—or “known unknowns”— that your pilot can help to address, keep in mind that there is a whole universe of “unknown unknowns” left to be explored. Of course, not all of these will be relevant to your study, but some are likely to be. For example, you may find that the participants have vastly different interpretations of an informational treatment, understand survey scales differently, or are reluctant to share responses given a perceived political bias.\nThere are a few ways to explore these unknowns in your pilot study. You might wish to include additional exploratory outcome questions, collect extra covariate data, or use a variety of treatments drawing on innovative or untested ideas. Another great way to identify unknowns is through open-ended questions of study participants. Regardless of your study design, you might consider surveying or interviewing participants to ask “what they think about topic X,” or “what comes to mind when they hear the term Y.” The world is often more complex than researchers model in their study designs, and study participants often have more diverse perspectives and relationships with the issues at hand than researchers expect.\nThrough this process, you may identify novel research questions, potential theoretical dimensions or causal mechanisms, and hypotheses that you had not originally formulated when you began studying the topic. Exploring unknowns can therefore lead to refining the ideas you had originally conceived of, as you are unlikely to have determined the best version of your study from the beginning. It can also lead to entirely novel considerations and ideas altogether, some of which you may be able to incorporate into the current study or future studies.\nOverall, pilots afford a wonderful opportunity for open-ended exploration and idea generation.\n\n\n10. A pilot is part of a broader sequence of research activities\nWhile we’ve talked about research in terms of “pilots” and “main studies,” this is an oversimplification of the research process. Indeed one can (and often should) employ multiple pilot studies, perhaps with different sample sizes, to evaluate different questions and to continue refining one’s research design as new questions and possibilities emerge. Pilot studies certainly do set the stage for main studies as well as subsequent “follow-up” studies, but there may not be a sharp demarcation between these kinds of studies. As depicted in the graphic, pilot studies do not merely lead to main studies. They can also help one develop new ideas and they may serve as a venue through which one can contribute to or coordinate with the broader research community around topics of shared interest.\n\n\n\n\nThe Role of Pilots in Experimental Research\n\n\n\n\nAs pilots are part of this broader sequence of research activities, an important consideration is what portion of one’s funding and resources should be allocated to a pilot study versus one’s main study. Researchers may be discouraged from devoting research resources to pilots due to a perception that pilots only provide preliminary data that cannot be used for final research products. While there is no simple “rule of thumb” about the share of the budget that researchers should apply to pilots, we believe that pilots can pay off when they empower researchers to improve their study designs and make more grounded decisions about their research.\nAdministering a second pilot study is especially prudent when pilot results or procedures deviate significantly from your expectations, or if you make substantial alterations to your design. Piloting one or more times is particularly beneficial for field experiments, as researchers often have just one opportunity to successfully implement their full study. However, when resources are constrained, you may opt instead to use simulations to evaluate alternative research designs based on results from your single pilot study. The DeclareDesign package in R is a helpful resource.\nIn short, pilots are neither pre-tests of hypotheses nor merely checks on basic study logistics that deplete one’s research funds. Instead, pilots are living and breathing elements of the broader research process that provide value in their own right.\n\n\nBibliography\nBloch, Carter, and Mads P. Sørensen. 2015. “The Size of Research Funding: Trends and Implications.” Science and Public Policy 42 (1): 30–43. https://doi.org/10.1093/scipol/scu019\nChristensen, Garret, Zenan Wang, Elizabeth Levy Paluck, Nicholas Swanson, David Birke, Edward Miguel, and Rebecca Littman. 2020. “Open Science Practices Are on the Rise: The State of Social Science (3S) Survey.” 106. Working Paper Series. Center for Effective Global Action, University of California. https://escholarship.org/uc/item/0hx0207r\nDeclareDesign. 2019. “Should a Pilot Study Change Your Study Design Decisions?” DeclareDesign. https://declaredesign.org/blog/2019-01-23-pilot-studies.html\nFranco, Annie, Neil Malhotra, and Gabor Simonovits. 2014. “Publication Bias in the Social Sciences: Unlocking the File Drawer.” Science 345 (6203): 1502–5. https://doi.org/10.1126/science.1255484.\nGelman, Andrew, and Jennifer Hill. 2006. Data Analysis Using Regression and Multilevel/Hierarchical Models. Cambridge, United Kingdom: Cambridge University Press.\nGerber, Alan S., and Donald P. Green. 2012. Field Experiments: Design, Analysis, and Interpretation. 1st ed. New York, New York: W. W. Norton.\nThabane, Lehana, Jinhui Ma, Rong Chu, Ji Cheng, Afisi Ismaila, Lorena P. Rios, Reid Robson, Marroon Thabane, Lora Giangregorio, and Charles H. Goldsmith. 2010. “A Tutorial on Pilot Studies: The What, Why and How.” BMC Medical Research Methodology 10 (1): 1-10. https://doi.org/10.1186/1471-2288-10-1\nvan Teijlingen, Edwin R., Anne-Marie Rennie, Vanora Hundley, and Wendy Graham. 2001. “The Importance of Conducting and Reporting Pilot Studies: The Example of the Scottish Births Survey.” Journal of Advanced Nursing 34 (3): 289–95. https://doi.org/10.1046/j.1365-2648.2001.01757.x."
  },
  {
    "objectID": "guides/getting-started/power_en.html",
    "href": "guides/getting-started/power_en.html",
    "title": "10 Things You Need to Know About Statistical Power",
    "section": "",
    "text": "Abstract\nThis guide1 will help you assess and improve the power of your experiments. We focus on the big ideas and provide examples and tools that you can use in R and Google Spreadsheets.\n\n\n1 What Power Is\nPower is the ability to distinguish signal from noise.\nThe signal that we are interested in is the impact of a treatment on some outcome. Does education increase incomes? Do public health campaigns decrease the incidence of disease? Can international monitoring decrease government corruption?\nThe noise that we are concerned about comes from the complexity of the world. Outcomes vary across people and places for myriad reasons. In statistical terms, you can think of this variation as the standard deviation of the outcome variable. For example, suppose an experiment uses rates of a rare disease as an outcome. The total number of affected people isn’t likely to fluctuate wildly day to day, meaning that the background noise in this environment will be low. When noise is low, experiments can detect even small changes in average outcomes. A treatment that decreased the incidence of the disease by 1% percentage points would be easily detected, because the baseline rates are so constant.\nNow suppose an experiment instead used subjects’ income as an outcome variable. Incomes can vary pretty widely – in some places, it is not uncommon for people to have neighbors that earn two, ten, or one hundred times their daily wages. When noise is high, experiments have more trouble. A treatment that increased workers’ incomes by 1% would be difficult to detect, because incomes differ by so much in the first place.\nA major concern before embarking on an experiment is the danger of a false negative. Suppose the treatment really does have a causal impact on outcomes. It would be a shame to go to all the trouble and expense of randomizing the treatment, collecting data on both treatment and control groups, and analyzing the results, just to have the effect be overwhelmed by background noise.\nIf our experiments are highly-powered, we can be confident that if there truly is a treatment effect, we’ll be able to see it.\n\n\n2 Why You Need It\nExperimenters often guard against false positives with statistical significance tests. After an experiment has been run, we are concerned about falsely concluding that there is an effect when there really isn’t.\nPower analysis asks the opposite question: supposing there truly is a treatment effect and you were to run your experiment a huge number of times, how often will you get a statistically significant result?\nAnswering this question requires informed guesswork. You’ll have to supply guesses as to how big your treatment effect can reasonably be, how many subjects will answer your survey, how many subjects your organization can realistically afford to treat.\nWhere do these guesses come from? Before an experiment is run, there is often a wealth of baseline data that are available. How old/rich/educated are subjects like yours going to be? How big was the biggest treatment effect ever established for your dependent variable? With power analysis, you can see how sensitive the probability of getting significant results is to changes in your assumptions.\nMany disciplines have settled on a target power value of 0.80. Researchers will tweak their designs and assumptions until they can be confident that their experiments will return statistically significant results 80% of the time. While this convention is a useful benchmark, be sure that you are comfortable with the risks associated with an 80% expected success rate.\nA note of caution: power matters a lot. Negative results from underpowered studies can be hard to interpret: Is there really no effect? Or is the study just not able to figure it out? Positive results from an underpowered study can also be misleading: conditional upon being statistically significant, an estimate from an underpowered study probably overestimates treatment effects. Under powered studies are sometimes based on overly optimistic assumptions; a convincing power analysis makes these assumptions explicit and should protect you from implementing designs that realistically have no chance of answering the questions you want to answer.\n\n\n3 The Three Ingredients of Statistical Power\nThere are three big categories of things that determine how highly powered your experiment will be. The first two (the strength of the treatment and background noise) are things that you can’t really control – these are the realities of your experimental environment. The last, the experimental design, is the only thing that you have power over – use it!\n\nStrength of the treatment. As the strength of your treatment increases, the power of your experiment increases. This makes sense: if your treatment were giving every subject $1,000,000, there is little doubt that we could discern differences in behavior between the treatment and control groups. Many times, however, we are not in control of the strength of our treatments. For example, researchers involved in program evaluation don’t get to decide what the treatment should be, they are supposed to evaluate the program as it is.\nBackground noise. As the background noise of your outcome variables increases, the power of your experiment decreases. To the extent that it is possible, try to select outcome variables that have low variability. In practical terms, this means comparing the standard deviation of the outcome variable to the expected treatment effect size — there is no magic ratio that you should be shooting for, but the closer the two are, the better off your experiment will be. By and large, researchers are not in control of background noise, and picking lower-noise outcome variables is easier said than done. Furthermore, many outcomes we would like to study are inherently quite variable. From this perspective, background noise is something you just have to deal with as best you can.\nExperimental Design. Traditional power analysis focuses on one (albeit very important) element of experimental design: the number of subjects in each experimental group. Put simply, a larger number of subjects increases power. However, there are other elements of the experimental design that can increase power: how is the randomization conducted? Will other factors be statistically controlled for? How many treatment groups will there be, and can they be combined in some analyses?\n\n\n\n4 Key Formulas for Calculating Power\nStatisticians have derived formulas for calculating the power of many experimental designs. They can be useful as a back of the envelope calculation of how large a sample you’ll need. Be careful, though, because the assumptions behind the formulas can sometimes be obscure, and worse, they can be wrong.\nHere is a common formula used to calculate power2\n\\[\\beta = \\Phi \\left(\\frac{|\\mu_t-\\mu_c|\\sqrt{N}}{2\\sigma}-\\Phi^{-1} \\left(1-\\frac{\\alpha}{2}\\right) \\right)\\]\n\n\\(\\beta\\) is our measure of power. Because it’s the probability of getting a statistically significant result, β will be a number between 0 and 1.\n\\(\\Phi\\) is the CDF of the normal distribution, and \\(\\Phi^{-1}\\) is its inverse. Everything else in this formula, we have to plug in:\n\\(\\mu_t\\) is the average outcome in the treatment group. Suppose it’s 65.\n\\(\\mu_c\\) is the average outcome in the control group. Suppose it’s 60.\nTogether, assumptions about μt and μc define our assumption about the size of the treatment effect: 65-60= 5.\n\\(\\sigma\\) is the standard deviation of outcomes. This is how we make assumptions about how noisy our experiment will be — one of the assumptions we’re making is that sigma is the same for both the treatment and control groups. Suppose \\(\\sigma=20\\)\n\\(\\alpha\\) is our significance level – the convention in many disciplines is that α should be equal to 0.05. \\(N\\) is the total number of subjects. This is the only variable that is under the direct control of the researcher. This formula assumes that every subject had a 50/50 chance of being in control. Suppose that \\(N=500\\).\n\nWorking through the formula, we find that under this set of assumptions, \\(β = 0.80\\), meaning that we have an 80% chance of recovering a statistically significant result with this design. Click here for a google spreadsheet that includes this formula. You can copy these formulas directly into Excel. If you’re comfortable in R, here is code that will accomplish the same calculation.\n\npower_calculator <- function(mu_t, mu_c, sigma, alpha=0.05, N){ \n  lowertail <- (abs(mu_t - mu_c)*sqrt(N))/(2*sigma) \n  uppertail <- -1*lowertail \n  beta <- pnorm(lowertail- qnorm(1-alpha/2), lower.tail=TRUE) + 1- pnorm(uppertail- qnorm(1-alpha/2), lower.tail=FALSE) \n  return(beta) \n  } \n\n\n\n5 When to Believe Your Power Analysis\nFrom some perspectives the whole idea of power analysis makes no sense. You want to figure out the size of some treatment effect but first you need to do a power analysis which requires that you already know your treatment effect and a lot more besides.\nSo in most power analyses you are in fact seeing what happens with numbers that are to some extent made up. The good news is that it is easy to find out how much your conclusions depend on your assumptions: simply vary your assumptions and see how the conclusions on power vary.\nThis is most easily seen by thinking about how power varies with the number of subjects. A power analysis that looks at power for different study sizes simply plugs in a range of values in for N and seeing how β changes.\nUsing the formula in section 4, you can see how sensitive power is to all of the assumptions: Power will be higher if you assume the treatment effect will be larger, or if you’re willing to accept a higher alpha level, or if you have more or less confidence in the noisiness of your measures.3\n\n\n\n\n6 How to Use Simulation to Estimate Power\nPower is a measure of how often, given assumptions, we would obtain statistically significant results, if we were to conduct our experiment thousands of times. The power calculation formula takes assumptions and return an analytic solution. However, due to advances in modern computing, we don’t have to rely on analytic solutions for power analysis. We can tell our computers to literally run the experiment thousands of times and simply count how frequently our experiment comes up significant.\nThe code block below shows how to conduct this simulation in R.\n\npossible.ns <- seq(from=100, to=2000, by=40) # The sample sizes we'll be considering\nstopifnot(all( (possible.ns %% 2)==0 )) ## require even number of experimental pool\npowers <- rep(NA, length(possible.ns)) # Empty object to collect simulation estimates \nalpha <- 0.05 # Standard significance level \nsims <- 500 # Number of simulations to conduct for each N \n#### Outer loop to vary the number of subjects #### \nfor (j in 1:length(possible.ns)){ N <- possible.ns[j] # Pick the jth value for N \n  Y0 <- rnorm(n=N, mean=60, sd=20) # control potential outcome \n  tau <- 5 # Hypothesize treatment effect \n  Y1 <- Y0 + tau # treatment potential outcome                                   \n  significant.experiments <- rep(NA, sims) # Empty object to count significant experiments \n                                  \n  #### Inner loop to conduct experiments \"sims\" times over for each N #### \n        Y0 <- rnorm(n=N, mean=60, sd=20) # control potential outcome \n        tau <- 5 # Hypothesize treatment effect \n        Y1 <- Y0 + tau # treatment potential outcome \n  for (i in 1:sims){ \n        ## Z.sim <- rbinom(n=N, size=1, prob=.5) # Do a random assignment  by coin flip\n        Z.sim <- sample(rep(c(0,1),N/2)) ## Do a random assignment ensuring equal sized groups\n        Y.sim <- Y1*Z.sim + Y0*(1-Z.sim) # Reveal outcomes according to assignment \n        fit.sim <- lm(Y.sim ~ Z.sim) # Do analysis (Simple regression) \n        p.value <- summary(fit.sim)$coefficients[2,4] # Extract p-values \n        significant.experiments[i] <- (p.value <= alpha) # Determine significance according to p <= 0.05\n        }\n  powers[j] <- mean(significant.experiments) # store average success rate (power) for each N \n  } \npowers \n\n [1] 0.252 0.364 0.404 0.370 0.522 0.550 0.646 0.660 0.696 0.766 0.820 0.840\n[13] 0.820 0.894 0.888 0.914 0.916 0.936 0.928 0.958 0.964 0.960 0.976 0.968\n[25] 0.980 0.978 0.990 0.994 0.982 0.988 0.992 0.994 1.000 0.994 0.996 0.998\n[37] 0.996 1.000 1.000 0.998 1.000 1.000 1.000 1.000 1.000 1.000 1.000 1.000\n\n\nThe code for this simulation and others is available here. Simulation is a far more flexible, and far more intuitive way to think about power analysis. Even the smallest tweaks to an experimental design are difficult to capture in a formula (adding a second treatment group, for example), but are relatively straightforward to include in a simulation.\nIn addition to counting up how often your experiments come up statistically significant, you can directly observe the distribution of p-values you’re likely to get. The graph below shows that under these assumptions, you can get expect to get quite a few p-values in the 0.01 range, but that 80% will be below 0.05.\n\n\n\n7 How to Change your Design to Improve Your Power\nWhen it comes to statistical power, the only thing that that’s under your control is the design of the experiment. As we’ve seen above, an obvious design choice is the number of subjects to include in the experiment. The more subjects, the higher the power.\nHowever, the number of subjects is not the only design choice that has consequences for power. There are two broad classes of design choices that are especially important in this regard.\n\nChoice of estimator. Are you using difference-in-means? Will you be doing some transformation, such as a logit or a probit? Will you be controlling for covariates? Will you be using some kind of robust standard error estimator? All of these choices will make a difference for the statistical significance of your results, and therefore for the power of your experiment. One easy way to think about this is to imagine what command you’ll be running in R or Stata after the experiment has come back; that’s your estimator!\nRandomization Protocol. What kind of randomization will you be employing? Simple randomization gives all subjects an equal probability of being in the treatment group, and then performs a (possibly weighted) coin flip for each. Complete randomization is similar, but it ensures that exactly a certain number will be assigned to treatment. Block randomization is even more powerful — it ensures that a certain number within a subgroup will be assigned to treatment. A restricted random assignment rejects some random assignments based on some set of criteria — lack of balance perhaps. These various types of random assignment can dramatically increase the power of an experiment at no extra cost. Read up on randomization protocols here.\n\nThere are too many choices to cover in this short article, but check out the Simulation for Power Analysis code page for some ways to get started. But to give a flavor of the simulation approach, consider how you would conduct a power analysis if you wanted to include covariates in your analysis.\nIf the covariates you include as control variables are strongly related to the outcome, then you’ve dramatically increased the power of your experiment.Unfortunately, the extra power that comes with including control variables is very hard to capture in a compact formula. Almost none of the power formulas found in textbooks or floating around on the internet can provide guidance on what the inclusion of covariates will do for your power.\nThe answer is simulation.\n\nSuppose we’re studying the effect of an educational intervention on income\nSuppose we have good data on the relationship between two covariates and income: age and gender. In this economy, men earn more than women, and older people earn more than younger people.\nRun a regression of income on age and gender and record the coefficients, using pre-existing survey data (better yet: use baseline data from future participants in your experiment!) *Generate fake covariate data — N total subjects, but broken up by age and gender in a way that reflects your experimental subject pool.\nGenerate fake control data — where the outcome is a function of age and gender according to your regression estimates\nHypothesize a treatment effect to generate fake treatment data\nRun the experiment 10,000 times, and record how often, using a regression with controls, your experiment turns up significant.\n\nHere’s a graph that compares the power of an experiment that does control for background attributes to one that does not. The R-square of the regression relating income to age and gender is pretty high — around .66 — meaning that the covariates that we have gathered (generated) are highly predictive. For a rough comparison, sigma, the level of background noise that the unadjusted model is dealing with, is around 33. This graph shows that at any N, the covariate-adjusted model has more power — so much so that the unadjusted model would need 1500 subjects to achieve what the covariate-adjusted model can do with 500.\n\nThis approach doesn’t rely on a formula to come up with the probability of getting a statistically significant result: it relies on brute force! And because simulation lets you specify every step of the experimental design, you do a far more nuanced power analysis than simply considering the number of subjects.\n\n\n8 Power Analysis for Multiple Treatments\nMany experiments employ multiple treatments which are compared both to each other and to a control group. This added complication changes what we mean when we say the “power” of an experiment. In the single treatment group case, power is just the probability of getting a statistically significant result. In the multiple treatment case, it can mean a variety of things: A) the probability of at least one of the treatments turning up significant, B) the probability of all the treatments turning up significant (versus control) or C) the probability that the treatments will be ranked in the hypothesized order, and that those ranks will be statistically significant.\nThis question of multiple treatment arms is related to the problem of multiple comparisons. (See our guide on this topic for more details.) Standard significance testing is based on the premise that you’re conducting a single test for statistical significance, and the p-values derived from these tests reflect the probability under the null of seeing such a larger (or larger) treatment effect. If, however, you are conducting multiple tests, this probability is no longer correct. Within a suite of tests, the probability that at least one of the tests will turn up significant even when the true effect is zero is higher, essentially because you have more attempts. A commonly cited (if not commonly used) solution is to use the Bonferroni correction: specify the number of comparisons you will be making in advance, then divide your significance level (alpha) by that number.\nIf you are going to be using a Bonferroni correction, then standard power calculators will be more complicated to use: you’ll have to specify your Bonferroni-corrected alpha levels and calculate the power of each separate comparison. To calculate the probability that all the tests are significant, multiply all the separate powers together. To calculate the probability that at least one of the tests is significant, calculate the probability that none are, then subtract from one.\nOr you can use simulation. An example of a power calculation done in R is available on the simulations page.\n\n\n9 How to Think About Power for Clustered Designs\nWhen an experiment has to assign whole groups of people to treatment rather than individually, we say that the experiment is clustered. This is common in educational experiments, where whole classrooms of children are assigned to treatment or control, or in development economics, where whole villages of individuals are assigned to treatment or control. (See our guide on cluster randomization for more details.)\nAs a general rule, clustering decreases your power. If you can avoid clustering your treatments, that is preferable for power. Unless you face concerns related to spillover, logistics, or ethics, take the variation down to the lowest level that you can.\nThe best case scenario for a cluster-level design is when which cluster a subject is in provides very little information about their outcomes. Suppose subjects were randomly assigned to clusters — the cluster wouldn’t help to predict outcomes at all. If the cluster is not predictive of the outcome, then we haven’t lost too much power to clustering.\nWhere clustering really causes trouble is when there is a strong relationship between the cluster and the outcome. To take the villages example, suppose that some villages are, as a whole, much richer than others. Then the clusters might be quite predictive of educational attainment. Clustering can reduce your effective sample size from the total number of individuals to the total number of clusters.\nThere are formulas that can help you understand the consequences of clustering — see Gelman/Hill page 447-449 for an extended discussion. While these formulas can be useful, they can also be quite cumbersome to work with. The core insight however is a simple one: you generally get more power from increasing the number of clusters than you do from increasing the number of subjects within clusters. Better to have 100 clusters with 10 subjects in each than 10 clusters with 100 subjects in each.\nAgain, a more flexible approach to power analysis when dealing with clusters is simulation. See the (Declare Design library for block and cluster randomized experiments)[https://declaredesign.org/r/designlibrary/reference/block_cluster_two_arm_designer.html] for some starter code. The (DeclareDesign)[https://declaredesign.org] software aims to make simulations for power analysis (among many other tasks) easier. See also Gelman/Hill page 450-453 for another simulation approach.\n\n\n10 Good Power Analysis Makes Preregistration Easy\nWhen you deal with power you focus on what you cannot control (noise) and what you can control (design). If you use the simulation approach to power analysis then you will be forced to imagine how your data will look and how you will handle it when it comes in. You will get a chance to specify all of your hunches and best guesses in advance, so that you can launch your experiments with clear expectations of what they can and cannot show. That’s some work but the good news is that if you really do it you are most of the way to putting together a comprehensive and registerable pre-analysis plan.\n\n\n\n\n\nFootnotes\n\n\nOriginating author: Alex Coppock, 20 Nov 2013. The guide is a live document and subject to updating by EGAP members at any time. Coppock is not responsible for subsequent edits to this guide↩︎\nReproduced from Gerber and Green 2012, page 93↩︎\nFor an additional online power visualization tool, see Kristoffer Magnusson’s R Psychologist blog.↩︎"
  }
]